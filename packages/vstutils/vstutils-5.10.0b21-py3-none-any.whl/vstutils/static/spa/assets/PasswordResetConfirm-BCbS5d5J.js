import{e as _,u as v,q as y,r as n,o as g,w as h,n as b}from"./index-DVXzwQwb.js";import{F as C}from"./FormGroup-BjRHUSUZ.js";import{c as P,b as k}from"./index-RVM98MnM.js";const R=_({__name:"PasswordResetConfirm",setup(f){const s=v(),r=y(),e=P(),{i18n:a}=k(),t=n(!1),o=n(""),c=n(""),p=n(),d=n(""),m=n([]);g(()=>{h(()=>{var u,i;o.value!==c.value?(u=p.value)==null||u.setCustomValidity(`${a.t("Passwords do not match.")}`):(i=p.value)==null||i.setCustomValidity("")})});async function w(){t.value=!0;try{const u=new URL("oauth2/password_reset_confirm/",e.api.url);u.search=new URLSearchParams({lang:a.locale}).toString();const i=await fetch(u,{method:"POST",body:JSON.stringify({uid:r.params.uid,token:r.params.token,password:o.value}),headers:{"Content-Type":"application/json"}});if(!i.ok){const l=await i.json();if(l.password)m.value=l.password;else if(l.uid||l.token)d.value="Invalid link. Please request a new one.";else throw new Error("Invalid response");return}s.push({name:"login",replace:!0})}catch{d.value="An error occurred. Please try again later."}finally{t.value=!1}}return{__sfc:!0,router:s,route:r,config:e,i18n:a,isLoading:t,password:o,password2:c,password2El:p,error:d,passwordErrors:m,submit:w,FormGroup:C}}});var $=function(){var s=this,r=s._self._c,e=s._self._setupProxy;return r("form",{on:{submit:function(a){return a.preventDefault(),e.submit.apply(null,arguments)}}},[r("p",[s._v(" "+s._s(s.$t("Please enter your new password twice so we can verify you typed it in correctly."))+" ")]),r(e.FormGroup,{attrs:{label:`${s.$t("New password")}`,errors:e.passwordErrors},scopedSlots:s._u([{key:"default",fn:function({classes:a,id:t}){return[r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],class:a,attrs:{id:t,type:"password",name:"password"},domProps:{value:e.password},on:{input:function(o){o.target.composing||(e.password=o.target.value)}}})]}}])}),r(e.FormGroup,{attrs:{label:`${s.$t("Confirm password")}`},scopedSlots:s._u([{key:"default",fn:function({classes:a,id:t}){return[r("input",{directives:[{name:"model",rawName:"v-model",value:e.password2,expression:"password2"}],ref:"password2El",class:a,attrs:{id:t,type:"password",name:"password2"},domProps:{value:e.password2},on:{input:function(o){o.target.composing||(e.password2=o.target.value)}}})]}}])}),e.error?r("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[s._v(" "+s._s(s.$t(e.error))+" ")]):s._e(),r("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.isLoading}},[s._v(" "+s._s(s.$t("Change my Password"))+" ")])],1)},E=[],S=b(R,$,E,!1,null,null,null,null);const N=S.exports;export{N as default};
