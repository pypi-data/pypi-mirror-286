"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[268],{47176:function(e,n,t){var s=t(26068),r=t.n(s),a=t(48305),l=t.n(a),o=t(84353),i=t(6434),c=t(32382),u=t(18953),d=t(64518),m=t(66551),p=t(99013),f=t.n(p),h=t(50959),x=t(11527);n.Z=function(e){var n=e.text,t=e.disabled,s=e.type,a=void 0===s?"text":s,p=e.shape,g=void 0===p?"circle":p,v=e.fontSize,j=void 0===v?"14px":v,y=e.style,b=e.size,Z=void 0===b?"middle":b,S=(0,c.useIntl)(),w=(0,h.useState)(!1),k=l()(w,2),N=k[0],C=k[1],M=(0,h.useRef)(null),T=(0,h.useRef)(null);return(0,h.useEffect)((function(){return M.current&&(T.current=new(f())(M.current),T.current.on("success",(function(){C(!0),setTimeout((function(){C(!1)}),3e3)})),T.current.on("error",(function(e){u.ZP.success(S.formatMessage({id:"common.copy.fail"})),e.clearSelection()}))),function(){var e;null===(e=T.current)||void 0===e||e.destroy()}}),[M]),(0,x.jsx)(d.Z,{title:S.formatMessage({id:"common.button.copy"}),children:(0,x.jsx)(m.ZP,{className:"copy-button",ref:M,type:a,shape:g,size:Z,disabled:!!t,"data-clipboard-text":n,icon:N?(0,x.jsx)(o.Z,{style:{color:"var(--ant-color-success)",fontSize:j}}):(0,x.jsx)(i.Z,{style:r()({fontSize:j},y)})})})}},73907:function(e,n,t){var s=(0,t(79107).Z)({scriptUrl:"//at.alicdn.com/t/c/font_4613488_68kh94h3e2r.js"});n.Z=s},94886:function(e,n,t){var s=t(26068),r=t.n(s),a=t(48305),l=t.n(a),o=t(67825),i=t.n(o),c=t(34088),u=t(79698),d=t(19392),m=t(50959),p=t(37975),f=t(11527),h=["label","placeholder","children","required","description","isInFormItems"];n.Z=function(e){var n=e.label,t=e.placeholder,s=e.children,a=e.required,o=e.description,x=e.isInFormItems,g=void 0===x||x,v=i()(e,h),j=(0,m.useState)(!1),y=l()(j,2),b=y[0],Z=y[1],S=(0,m.useRef)(null),w="";if(g){var k,N,C=null===u.Z||void 0===u.Z||null===(k=u.Z.Item)||void 0===k||null===(N=k.useStatus)||void 0===N?void 0:N.call(k);w=(null==C?void 0:C.status)||""}(0,m.useEffect)((function(){(0,c.JL)(e.value)&&Z(!0)}),[e.value]);return(0,f.jsx)(p.Z,{status:w,label:n||t,isFocus:b,required:a,description:o,disabled:e.disabled,onClick:function(){var n,t;e.disabled||b||(null===(n=S.current)||void 0===n||null===(t=n.focus)||void 0===t||t.call(n),Z(!0))},children:(0,f.jsx)(d.default,r()(r()({},v),{},{ref:S,onFocus:function(n){var t;Z(!0),null===(t=e.onFocus)||void 0===t||t.call(e,n)},onBlur:function(n){var t;e.value||Z(!1),null===(t=e.onBlur)||void 0===t||t.call(e,n)},onChange:function(n,t){var s;(0,c.JL)(n)?Z(!0):Z(!1),null===(s=e.onChange)||void 0===s||s.call(e,n,t)},notFoundContent:null,children:s}))})}},73083:function(e,n,t){t.d(n,{d:function(){return s}});var s={default:500,large:600,small:400,mini:300}},28434:function(e,n,t){t.d(n,{Z:function(){return l}});var s=t(32699),r=t.n(s),a=t(50959);function l(e,n){var t=(0,a.useRef)(!1),s=(0,a.useRef)(e),l=(0,a.useRef)(n),o=(0,a.useRef)(null==n?void 0:n.toBottom),i=r().debounce((function(){t.current=!1}),5e3),c=function e(){var n,r,a,i=(null===(n=s.current)||void 0===n?void 0:n.current)||{},c=i.scrollHeight,u=i.clientHeight,d=i.scrollTop;null!==(r=l.current)&&void 0!==r&&r.toBottom&&o.current&&c>u+d?(s.current.current.scrollTop=c,t.current=!1):!t.current&&c>u+d&&null!==(a=s.current)&&void 0!==a&&a.current&&(s.current.current.scrollTop+=10,window.requestAnimationFrame(e))};return{handleContentWheel:function(e){t.current=!0,i()},updateScrollerPosition:function(){t.current||window.requestAnimationFrame(c)},scroller:s}}},31397:function(e,n,t){t.r(n),t.d(n,{default:function(){return Ze}});var s=t(48305),r=t.n(s),a=t(43359),l=t(24931),o=t(67399),i=t(32382),c=t(66551),u=t(35623),d=t(82187),m=t.n(d),p=t(50959),f=t(90228),h=t.n(f),x=t(87999),g=t.n(x),v=t(26068),j=t.n(v),y=t(15558),b=t.n(y),Z=t(11527),S=(0,p.forwardRef)((function(e,n){var t=e.minHeight,s=void 0===t?50:t,a=e.header,l=e.variant,o=void 0===l?"bordered":l,i=e.children,c=e.setCollapsed,u=(0,p.useState)(!0),d=r()(u,2),f=d[0],h=d[1],x=(0,p.useState)(0),g=r()(x,2),v=g[0],j=g[1],y=(0,p.useRef)(null);(0,p.useEffect)((function(){var e;f?j((null==y||null===(e=y.current)||void 0===e?void 0:e.scrollHeight)||0):j(0)}),[f]);var b=function(){var e;j((null==y||null===(e=y.current)||void 0===e?void 0:e.scrollHeight)||0)};return(0,p.useImperativeHandle)(n,(function(){return{setHeightByContent:b}})),(0,Z.jsxs)("div",{className:m()("transition-wrapper",{bordered:"bordered"===o,filled:"filled"===o}),children:[(0,Z.jsx)("div",{onClick:function(){h(!f),null==c||c(!f)},className:"header",style:{height:s},children:a}),(0,Z.jsx)("div",{className:"transition-content-wrapper",style:{minHeight:f?v:0,height:f?"auto":0,padding:f?"8px":"0 8px"},ref:y,children:(0,Z.jsx)("div",{className:"transition-content",children:i})})]})})),w={CREATE:["ctrl+shift+n","meta+shift+n"],SAVE:["ctrl+s","meta+s"],SUBMIT:["ctrl+enter","meta+enter"],SAVEAS:["ctrl+shift+s","meta+shift+s"],OPEN:["ctrl+o","meta+o"],CANCEL:["ctrl+w","meta+w"],DELETE:["delete"],COPY:["ctrl+c","meta+c"],REFRESH:["ctrl+r","meta+r"],EDIT:["ctrl+e","meta+e"],SEARCH:["ctrl+f","meta+f"],RESET:["ctrl+shift+r","meta+shift+r"]},k=t(28434),N=t(28791),C=function(e){var n,t=/data:\s*({.*?})(?=\n|$)/g,s=[];if(!e)return s;for(;null!==(n=t.exec(e));)try{s.push(JSON.parse(n[1]))}catch(e){continue}return s},M=function(){var e=g()(h()().mark((function e(n){var t,s,r,a,l,o;return h()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.method||"POST",r=n.url,n.params&&(r="".concat(r,"?").concat(N.Z.stringify(n.params))),e.next=5,fetch(r,{method:s,body:"POST"===s?JSON.stringify(n.data):null,signal:n.signal,headers:{"Content-Type":"application/json"}});case 5:if((a=e.sent).ok){e.next=9;break}throw new Error("Network response was not ok");case 9:return l=null==a||null===(t=a.body)||void 0===t?void 0:t.getReader(),o=new TextDecoder("utf-8"),e.abrupt("return",{reader:l,decoder:o});case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),T=function(){var e=g()(h()().mark((function e(n,t,s){var r,a,l,o;return h()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.read();case 2:if(r=e.sent,a=r.done,l=r.value,!a){e.next=8;break}return e.abrupt("return");case 8:return o=t.decode(l,{stream:!0}),C(o).forEach((function(e){null==s||s(e)})),e.next=13,T(n,t,s);case 13:case"end":return e.stop()}}),e)})));return function(n,t,s){return e.apply(this,arguments)}}(),_=t(25633),I=t(8274),P=t(64518),F=t(99158),A=t(4542),R=t(32699),E=t.n(R),O=t(94299),z="/v1-openai/chat/completions";var V=function(){var e=g()(h()().mark((function e(){return h()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("".concat("/v1-openai/models")));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U={User:"user",Assistant:"assistant",System:"system"},B=(U.User,U.Assistant,t(73907)),q=t(34088),H=t(10822),L=t(26657),D=t(34828),J=t(65863),K=t(80613),Y=t(81126),W=function(e){var n=(0,q.oc)(),t=(0,i.useIntl)(),s=e.onSubmit,r=e.onClear,a=e.onStop,l=e.onNewMessage,o=e.onView,u=e.feedback,d=e.disabled,m=e.hasTokenResult,p=e.selectedModel;(0,O.y1)(w.SUBMIT.join(","),(function(){s()}),{enabled:!d});U.User,t.formatMessage({id:"playground.user"}),U.Assistant,t.formatMessage({id:"playground.assistant"});return(0,Z.jsx)("div",{className:"chat-footer",children:(0,Z.jsxs)(J.Z,{style:{width:"100%"},children:[(0,Z.jsx)(K.Z,{lg:m?8:12,xs:24,sm:24,md:24,children:(0,Z.jsxs)(Y.Z,{size:20,children:[(0,Z.jsx)(c.ZP,{disabled:d,icon:(0,Z.jsx)(H.Z,{}),onClick:l,children:t.formatMessage({id:"playground.newMessage"})}),(0,Z.jsx)(c.ZP,{icon:(0,Z.jsx)(L.Z,{}),onClick:r,disabled:d,children:t.formatMessage({id:"common.button.clear"})})]})}),(0,Z.jsx)(K.Z,{lg:m?8:0,xs:m?24:0,sm:m?24:0,md:m?24:0,children:u}),(0,Z.jsx)(K.Z,{lg:m?8:12,xs:24,sm:24,md:24,style:{textAlign:"right"},children:(0,Z.jsxs)(Y.Z,{size:20,children:[(0,Z.jsx)(c.ZP,{icon:(0,Z.jsx)(B.Z,{type:"icon-code",className:"font-size-16"}),onClick:o,disabled:d,children:t.formatMessage({id:"playground.viewcode"})}),d?(0,Z.jsx)(c.ZP,{type:"primary",onClick:a,icon:(0,Z.jsx)(B.Z,{type:"icon-stop1"}),children:(0,Z.jsx)("span",{children:t.formatMessage({id:"common.button.stop"})})}):(0,Z.jsxs)(c.ZP,{type:"primary",disabled:d||!p,onClick:s,children:[t.formatMessage({id:"common.button.submit"}),(0,Z.jsx)("span",{className:"m-l-5 opct-7",children:n.isMac?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(B.Z,{type:"icon-command"})," +"," ",(0,Z.jsx)(D.Z,{})]}):(0,Z.jsxs)(Z.Fragment,{children:["CTRL + ",(0,Z.jsx)(D.Z,{})]})})]})]})})]})})},G=t(47176),$=t(92420),Q=function(e){var n=e.message,t=e.isFocus,s=e.onDelete,a=e.updateMessage,l=e.onSubmit,o=e.loading,u=(0,i.useIntl)(),d=(0,p.useState)(!1),m=r()(d,2),f=(m[0],m[1],(0,p.useState)(!1)),h=r()(f,2),x=(h[0],h[1],(0,p.useState)(t)),g=r()(x,2),v=g[0],j=g[1],y=(0,p.useRef)(null);(0,p.useEffect)((function(){y.current&&t&&y.current.focus()}),[t]);var b=function(e){a({role:e.role,content:e.message,uid:n.uid})};return(0,O.y1)(w.SUBMIT,(function(){y.current.blur(),l()}),{enabled:v,enableOnFormTags:v,preventDefault:!0}),(0,Z.jsxs)("div",{className:"message-item",children:[(0,Z.jsx)("div",{className:"role-type",children:(0,Z.jsx)(c.ZP,{onClick:function(){var e=n.role===U.User?U.Assistant:U.User;b({role:e,message:n.content})},type:"text",children:u.formatMessage({id:"playground.".concat(n.role)})})}),(0,Z.jsx)("div",{className:"message-content-input",children:(0,Z.jsx)(F.Z.TextArea,{ref:y,style:{paddingBlock:"12px"},value:n.content,autoSize:!0,variant:"filled",readOnly:o,onChange:function(e){b({role:n.role,message:e.target.value})},onFocus:function(){j(!0)},onBlur:function(){j(!1)}})}),(0,Z.jsx)("div",{className:"delete-btn",children:(0,Z.jsxs)(Y.Z,{size:5,children:[n.content&&(0,Z.jsx)(G.Z,{text:n.content,size:"small",shape:"default",type:"default",fontSize:"12px"}),(0,Z.jsx)(P.Z,{title:u.formatMessage({id:"common.button.delete"}),children:(0,Z.jsx)(c.ZP,{size:"small",onClick:function(){s()},icon:(0,Z.jsx)($.Z,{})})})]})})]})},X=function(e){var n=(0,i.useIntl)(),t=e.usage;return t?(0,Z.jsxs)("div",{className:"reference-params",children:[(0,Z.jsx)("span",{className:"usage",children:(0,Z.jsx)(P.Z,{title:(0,Z.jsxs)(Y.Z,{children:[(0,Z.jsxs)("span",{children:[n.formatMessage({id:"playground.completion"}),":"," ",t.completion_tokens]}),(0,Z.jsxs)("span",{children:[n.formatMessage({id:"playground.prompt"}),":"," ",t.prompt_tokens]})]}),children:(0,Z.jsxs)("span",{children:[n.formatMessage({id:"playground.tokenusage"}),":"," ",t.total_tokens]})})}),(0,Z.jsx)("span",{className:"usage",children:(0,Z.jsx)(P.Z,{title:(0,Z.jsxs)(Y.Z,{children:[(0,Z.jsxs)("span",{children:["TPOT: ",E().round(t.time_per_output_token_ms,2)," ms"]}),(0,Z.jsxs)("span",{children:["TTFT: ",E().round(t.time_to_first_token_ms,2)," ms"]})]}),children:(0,Z.jsxs)("span",{children:[n.formatMessage({id:"playground.tokenoutput"}),":"," ",E().round(t.tokens_per_second,2)," Tokens/s"]})})})]}):null},ee=t(19392),ne=function(e){var n=e.header,t=e.children,s=e.copyText,r=e.langOptions,a=e.onChangeLang,l=e.defaultValue,o=e.showHeader,i=void 0===o||o,c=function(e){null==a||a(e)};return(0,Z.jsxs)("div",{className:"editor-wrap",children:[n?(0,Z.jsx)("div",{className:"editor-header",children:n}):i?(0,Z.jsxs)("div",{className:"editor-header",children:[(0,Z.jsx)(ee.default,{defaultValue:l,style:{width:120},size:"middle",variant:"filled",options:r,onChange:c}),(0,Z.jsx)(G.Z,{text:s,size:"small",style:{color:"rgba(255,255,255,.7)"}})]}):null,(0,Z.jsx)("div",{className:"editor-content",children:t})]})},te=p.memo(ne),se=t(24770),re=t(59874),ae=t(48157),le=function(e){var n=e||{},t=n.title,s=n.open,a=n.onCancel,l=n.systemMessage,o=n.messageList,u=n.parameters,d=void 0===u?{}:u,m=(0,i.useIntl)(),f=(0,p.useRef)(null),h=(0,p.useState)(!1),x=r()(h,2),g=x[0],v=x[1],y=(0,p.useState)(""),S=r()(y,2),w=S[0],k=S[1],N=(0,p.useState)("shell"),C=r()(N,2),M=C[0],T=C[1],_="".concat(window.location.origin,"/v1-openai"),I=function(){if("shell"===M){var e=l?[{role:"system",content:l}]:[],n="curl ".concat(window.location.origin,'/v1-openai/chat/completions \\\n-H "Content-Type: application/json" \\\n-H "Authorization: Bearer ${YOUR_GPUSTACK_API_KEY}" \\\n-d \'').concat(JSON.stringify(j()(j()({},d),{},{messages:[].concat(e,b()(E().map(o,(function(e){return{role:e.role,content:e.content}}))))}),null,2),"'");k(n)}else if("javascript"===M){var t=l?[{role:"system",content:l}]:[],s='const OpenAI = require("openai");\n\nconst openai = new OpenAI({\n  "apiKey": "YOUR_GPUSTACK_API_KEY",\n  "baseURL": "'.concat(_,'"\n});\n\nasync function main(){\n  const params = ').concat(JSON.stringify(j()(j()({},d),{},{messages:[].concat(t,b()(E().map(o,(function(e){return{role:e.role,content:e.content}}))))}),null,4),";\nconst chatCompletion = await openai.chat.completions.create(params);\n  console.log(chatCompletion.choices[0].message.content);\n}\nmain();");k(s)}else if("python"===M){var r=E().keys(d).reduce((function(e,n){if(null===d[n])return e;var t="string"==typeof d[n]?'"'.concat(d[n],'"'):d[n];return e+"  ".concat(n,"=").concat(t,",\n")}),""),a=l?[{role:"system",content:l}]:[],i='from openai import OpenAI\n\nclient = OpenAI(\n  base_url="'.concat(_,'", \n  api_key="YOUR_GPUSTACK_API_KEY"\n)\n\ncompletion = client.chat.completions.create(\n').concat(r,"  messages=").concat(JSON.stringify([].concat(a,b()(E().map(o,(function(e){return{role:e.role,content:e.content}})))),null,2),")\nprint(completion.choices[0].message.content)");k(i)}f.current&&setTimeout((function(){var e,n;null===(e=f.current)||void 0===e||null===(n=e.getAction)||void 0===n||null===(n=n.call(e,"editor.action.formatDocument"))||void 0===n||n.run().then((function(){}))}),100)};return(0,p.useEffect)((function(){I()}),[M,l,o,d]),(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsxs)(ae.Z,{title:t,open:s,centered:!0,onCancel:function(){T("shell"),a()},destroyOnClose:!0,closeIcon:!0,maskClosable:!1,keyboard:!1,width:600,footer:null,children:[(0,Z.jsx)("div",{style:{marginBottom:"10px"},children:m.formatMessage({id:"playground.viewcode.info"})}),(0,Z.jsxs)("div",{children:[(0,Z.jsx)(te,{copyText:w,langOptions:[{label:"Curl",value:"shell"},{label:"Python",value:"python"},{label:"Nodejs",value:"javascript"}],defaultValue:"shell",showHeader:g,onChangeLang:function(e){T(e)},children:(0,Z.jsx)(re.ZP,{height:380,theme:"vs-dark",className:"monaco-editor",defaultLanguage:"shell",language:M,value:w,options:{minimap:{enabled:!1},hover:{enabled:!1},readOnly:!0,formatOnType:!0,formatOnPaste:!0,fontWeight:"bold",scrollbar:{verticalSliderSize:8}},beforeMount:function(e){e.languages.typescript.javascriptDefaults.setDiagnosticsOptions({noSemanticValidation:!1,noSyntaxValidation:!1,diagnosticCodesToIgnore:[80001]})},onMount:function(e,n){f.current=e,v(!0)}})}),(0,Z.jsxs)("div",{style:{marginTop:10,display:"flex",alignItems:"baseline"},children:[(0,Z.jsx)(se.Z,{className:"m-r-8"}),(0,Z.jsx)("span",{children:m.formatMessage({id:"playground.viewcode.tips"},{here:(0,Z.jsx)(c.ZP,{type:"link",size:"small",href:"#/api-keys",target:"_blank",style:{paddingInline:2},children:(0,Z.jsxs)("span",{children:[" ",m.formatMessage({id:"playground.viewcode.here"})]})})})})]})]})]})})},oe=function(e){var n=e.parameters,t=(0,p.useRef)(0),s=(0,p.useState)([{role:"user",content:"",uid:t.current}]),a=r()(s,2),l=a[0],o=a[1],u=(0,i.useIntl)(),d=(0,p.useState)(""),m=r()(d,2),f=m[0],x=m[1],v=(0,p.useState)(!0),y=r()(v,2),N=y[0],C=y[1],R=(0,p.useState)(!1),V=r()(R,2),B=V[0],q=V[1],H=(0,p.useState)(!1),L=r()(H,2),D=L[0],J=L[1],K=(0,p.useState)(-1),Y=r()(K,2),G=Y[0],$=Y[1],ee=(0,p.useState)(null),ne=r()(ee,2),te=ne[0],se=ne[1],re=(0,p.useState)(!1),ae=r()(re,2),oe=ae[0],ie=ae[1],ce=(0,p.useRef)(null),ue=(0,p.useRef)(""),de=(0,p.useRef)(null),me=(0,p.useRef)(null),pe=(0,k.Z)(me,{toBottom:!0}),fe=pe.updateScrollerPosition,he=pe.handleContentWheel;(0,p.useEffect)((function(){fe()}),[l]);var xe=function(){t.current=t.current+1},ge=function(e){e&&(E().get(e,"choices.0.finish_reason")?se(j()({},null==e?void 0:e.usage)):(ue.current=ue.current+E().get(e,"choices.0.delta.content",""),o([].concat(b()(l),[{role:U.Assistant,content:ue.current,uid:t.current}]))))},ve=function(){var e=g()(h()().mark((function e(){var t,s,r,a,o,i,c;return h()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,J(!0),xe(),se(null),null===(t=de.current)||void 0===t||null===(s=t.abort)||void 0===s||s.call(t),de.current=new AbortController,r=de.current.signal,ue.current="",a=j()(j()({messages:f?[{role:U.System,content:f}].concat(b()(l)):b()(l)},n),{},{stream:!0}),e.next=11,M({data:a,url:z,signal:r});case 11:if(o=e.sent){e.next=14;break}return e.abrupt("return");case 14:return i=o.reader,c=o.decoder,e.next=17,T(i,c,(function(e){ge(e)}));case 17:J(!1),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(0),J(!1);case 24:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(){return e.apply(this,arguments)}}(),je=function(){ve()};return(0,O.y1)(w.SUBMIT,(function(){je()}),{enabled:oe&&!D,enableOnFormTags:oe&&!D,preventDefault:!0}),(0,Z.jsxs)("div",{className:"ground-left",children:[(0,Z.jsxs)("div",{className:"message-list-wrap",ref:me,onWheel:he,children:[(0,Z.jsx)("div",{style:{marginBottom:40},children:(0,Z.jsx)(S,{header:(0,Z.jsxs)("div",{className:"system-message-wrap ",children:[(0,Z.jsx)("span",{className:"title",children:u.formatMessage({id:"playground.system"})}),(0,Z.jsx)(P.Z,{title:N?u.formatMessage({id:"common.button.collapse"}):u.formatMessage({id:"common.button.expand"}),children:(0,Z.jsx)(c.ZP,{size:"small",children:N?(0,Z.jsx)(_.Z,{}):(0,Z.jsx)(I.Z,{})})})]}),variant:"filled",setCollapsed:C,ref:ce,children:(0,Z.jsx)(F.Z.TextArea,{value:f,variant:"filled",autoSize:!0,onFocus:function(){ie(!0)},onBlur:function(){ie(!1)},style:{minHeight:40},placeholder:u.formatMessage({id:"playground.system.tips"}),onChange:function(e){x(e.target.value)}})})}),(0,Z.jsxs)("div",{children:[l.map((function(e,n){return(0,Z.jsx)(Q,{isFocus:n===G,islast:n===l.length-1,loading:D,onDelete:function(){return function(e){l.splice(e,1),o(b()(l))}(n)},updateMessage:function(e){return function(e,n){l[e]=n,o(b()(l))}(n,e)},onSubmit:je,message:e},e.uid)})),D&&(0,Z.jsx)(A.Z,{children:(0,Z.jsx)("div",{style:{height:"46px"}})})]})]}),(0,Z.jsx)("div",{className:"ground-left-footer",children:(0,Z.jsx)(W,{onClear:function(){l.length&&(xe(),o([{role:U.User,content:"",uid:t.current}]))},onNewMessage:function(e){var n;l.push({role:(null===(n=E().last(l))||void 0===n?void 0:n.role)===U.User?U.Assistant:U.User,content:"",uid:t.current+1}),xe(),o(b()(l)),$(l.length-1)},onSubmit:je,onView:function(){q(!0)},onStop:function(){var e,n;null===(e=de.current)||void 0===e||null===(n=e.abort)||void 0===n||n.call(e),J(!1)},disabled:D,selectedModel:n.model,hasTokenResult:!!te,feedback:(0,Z.jsx)(X,{usage:te})})}),(0,Z.jsx)(le,{open:B,systemMessage:f,messageList:l,parameters:n,onCancel:function(){q(!1)},title:u.formatMessage({id:"playground.viewcode"})})]})},ie=t(82092),ce=t.n(ie),ue=t(6451),de=t(63109),me=function(e){var n=e.children,t=e.label,s=e.status,r=e.className,a=e.disabled,l=e.required,o=e.variant,i=e.style,c=e.description;return(0,Z.jsxs)("div",{style:j()({},i),className:m()(de.Z.wrapper,de.Z["validate-status-".concat(s)],a?de.Z["seal-input-wrapper-disabled"]:"","filled"===o?de.Z.filled:"","borderless"===o?de.Z.borderless:"",r?de.Z[r]:""),children:[(0,Z.jsx)("label",{className:m()(de.Z.label,de.Z["isfoucs-has-value"]),children:(0,Z.jsx)(ue.Z,{label:t,required:l,description:c})}),(0,Z.jsx)("div",{style:{padding:"0 calc(var(--ant-padding-sm) - 5px)",width:"100%"},children:n})]})},pe=t(99494),fe=t(94886),he=t(73083),xe=t(56280),ge=t(79698),ve=t(30629),je=t(55915),ye="label___Im6e1",be=function(e){var n=e.selectedModel,t=e.setParams,s=(0,i.useIntl)(),a=(0,p.useState)([]),l=r()(a,2),o=l[0],c=l[1],u={seed:null,stop:null,temperature:1,top_p:1,max_tokens:1024},d=ge.Z.useForm(),m=r()(d,1)[0];(0,p.useEffect)((function(){var e=function(){var e=g()(h()().mark((function e(){var s,r;return h()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,V();case 3:s=e.sent,r=E().map(s.data||[],(function(e){return{value:e.id,label:e.id}})),c(r),m.setFieldsValue(j()({model:n||E().get(r,"[0].value")},u)),t(j()({model:n||E().get(r,"[0].value")},u)),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),c([]),m.setFieldsValue(j()({model:n||""},u)),t(j()({model:n||""},u));case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var f=function(e,n){var s=m.getFieldsValue();m.setFieldsValue(j()(j()({},s),{},ce()({},n,e))),t(j()(j()({},s),{},ce()({},n,e)))},x=function(e){return(0,Z.jsxs)("span",{className:ye,style:{width:he.d.mini},children:[(0,Z.jsx)("span",{className:"text",children:e.description?(0,Z.jsxs)(P.Z,{title:e.description,children:[(0,Z.jsxs)("span",{children:[" ",e.label]}),(0,Z.jsx)("span",{className:"m-l-5",children:(0,Z.jsx)(xe.Z,{})})]}):(0,Z.jsx)("span",{children:e.label})}),(0,Z.jsx)(ve.Z,{className:"label-val",variant:"outlined",size:"small",value:m.getFieldValue(e.field),controls:!1,onChange:function(n){return f(n,e.field)}})]})};return(0,Z.jsx)(ge.Z,{name:"modelparams",form:m,onValuesChange:function(e,n){null==t||t(n)},onFinish:function(e){},onFinishFailed:function(e){},children:(0,Z.jsxs)("div",{children:[(0,Z.jsx)("h3",{className:"m-b-20 m-l-10 font-size-14",children:s.formatMessage({id:"playground.model"})}),(0,Z.jsx)(ge.Z.Item,{name:"model",rules:[{required:!0,message:s.formatMessage({id:"common.form.rule.select"},{name:s.formatMessage({id:"playground.model"})})}],children:(0,Z.jsx)(fe.Z,{showSearch:!0,options:o,label:s.formatMessage({id:"playground.model"})})}),(0,Z.jsx)("h3",{className:"m-b-20 m-l-10 flex-between flex-center font-size-14",children:(0,Z.jsx)("span",{children:s.formatMessage({id:"playground.parameters"})})}),(0,Z.jsx)(ge.Z.Item,{name:"temperature",rules:[{required:!1}],children:(0,Z.jsx)(me,{label:x({field:"temperature",label:"Temperature",description:s.formatMessage({id:"playground.params.temperature.tips"})}),style:{paddingInline:0},variant:"borderless",children:(0,Z.jsx)(je.Z,{defaultValue:1,max:2,step:.1,style:{marginBottom:0,marginTop:16},tooltip:{open:!1},value:m.getFieldValue("temperature")||void 0,onChange:function(e){return f(e,"temperature")}})})}),(0,Z.jsx)(ge.Z.Item,{name:"max_tokens",rules:[{required:!1}],children:(0,Z.jsx)(me,{label:x({field:"max_tokens",label:"Max Tokens",description:s.formatMessage({id:"playground.params.maxtokens.tips"})}),style:{paddingInline:0},variant:"borderless",children:(0,Z.jsx)(je.Z,{defaultValue:1024,max:2048,step:1,style:{marginBottom:0,marginTop:16},tooltip:{open:!1},value:m.getFieldValue("max_tokens")||void 0,onChange:function(e){return f(e,"max_tokens")}})})}),(0,Z.jsx)(ge.Z.Item,{name:"top_p",rules:[{required:!1}],children:(0,Z.jsx)(me,{label:x({field:"top_p",label:"Top P",description:s.formatMessage({id:"playground.params.topp.tips"})}),style:{paddingInline:0},variant:"borderless",children:(0,Z.jsx)(je.Z,{defaultValue:1,max:1,step:.1,style:{marginBottom:0,marginTop:16},tooltip:{open:!1},value:m.getFieldValue("top_p")||void 0,onChange:function(e){return f(e,"top_p")}})})}),(0,Z.jsx)(ge.Z.Item,{name:"seed",rules:[{required:!1}],children:(0,Z.jsx)(pe.Z.Number,{label:"Seed",min:0,description:s.formatMessage({id:"playground.params.seed.tips"}),style:{width:he.d.mini}})}),(0,Z.jsx)(ge.Z.Item,{name:"stop",rules:[{required:!1}],children:(0,Z.jsx)(pe.Z.Input,{label:"Stop Sequence",description:s.formatMessage({id:"playground.params.stop.tips"}),style:{width:he.d.mini}})})]})})},Ze=function(){var e=(0,i.useSearchParams)(),n=r()(e,1)[0].get("model")||"",t=(0,p.useState)({}),s=r()(t,2),d=s[0],f=s[1],h=(0,p.useState)(!1),x=r()(h,2),g=x[0],v=x[1];return(0,Z.jsx)(o._z,{ghost:!0,extra:[],className:"playground-container",children:(0,Z.jsxs)("div",{className:"play-ground",children:[(0,Z.jsx)("div",{className:"chat",children:(0,Z.jsx)(oe,{parameters:d})}),(0,Z.jsxs)("div",{className:m()("left",{collapse:g}),children:[(0,Z.jsx)(c.ZP,{onClick:function(){return v(!g)},icon:g?(0,Z.jsx)(a.Z,{}):(0,Z.jsx)(l.Z,{}),style:{color:"var(--ant-color-text-tertiary)"},size:"small",type:"text",className:"collapse-btn"}),(0,Z.jsx)("div",{className:m()("divider-line",{collapse:g}),children:(0,Z.jsx)(u.Z,{type:"vertical"})}),(0,Z.jsx)("div",{className:m()("params"),children:(0,Z.jsx)("div",{className:m()("params-box",{collapse:g}),children:(0,Z.jsx)(be,{setParams:f,selectedModel:n})})})]})]})})}}}]);