import{d as k,i as F,b as g,c as _,o as E,l as G,S as me,e as x,f as i,t as $,U as fe,r as M,V as I,I as j,W as T,Q as J,_ as N,X as ge,J as _e,w as X,v as Y,z as Q,A as he,h as ye,Y as Ce,F as be,s as Ie,n as Z,p as ee,j as te,u as q,m as Pe,q as Se,R as Ee}from"./index-MwIxNlRc.js";const we=10,Te=k({__name:"ChildlessPlaceholder",props:{componentId:{type:String,required:!0}},setup(c){const o=F(g.core),m=c,r=(y,a)=>{const b=y.map(e=>o.getComponentDefinition(e)).map(e=>e==null?void 0:e.name);return`${b.slice(0,-1).join(", ")} ${b.length>1?a:""} ${b.at(-1)}`},s=_(()=>{const y=o.getContainableTypes(m.componentId);let a;return y.length<=we&&(a=`You can add ${r(y,"and")} components`),a});return(y,a)=>(E(),G(me,{class:"ChildlessPlaceholder","component-id":c.componentId,message:s.value},null,8,["component-id","message"]))}}),$e={class:"RenderError"},Me={class:"title"},Be={class:"message"},De=k({__name:"RenderError",props:{componentType:{},message:{}},setup(c){const o=c;return(m,r)=>(E(),x("div",$e,[i("div",Me,[i("h2",null,"Error rendering "+$(o.componentType),1)]),i("div",Be,$(o.message),1)]))}}),xe={props:["componentId","instancePath","instanceData"],setup(c){const o=F(g.core),m=F(g.builderManager),r=c.componentId,s=_(()=>o.getComponentById(r)),y=fe(s.value.type),a=c.instancePath,P=c.instanceData,{getEvaluatedFields:b,isComponentVisible:S}=J(o),e=b(a),p=_(()=>o.getComponents(r,{sortedByPosition:!0})),u=_(()=>!!m&&m.getMode()!="preview"),V=_(()=>u.value&&!s.value.isCodeManaged&&s.value.type!=="root"),B=(t,n)=>(t?o.getContainableTypes(t):["root"]).includes(n),w=M(!1),ne=_(()=>o.getUserFunctions()),oe=()=>{if(!(p.value.length>0))return T(Te,{componentId:s.value.id})},L=(t,n=0,d={})=>T(se,{componentId:t,key:`${t}:${n}`,instancePath:[...a,{componentId:t,instanceNumber:n}],instanceData:[...P,M(null)],...d}),ae=t=>n=>{if(!B(r,n.type)&&t==="default")return!0;const l=o.getComponentDefinition(n.type).slot??"default";return l==="*"||l===t},K=(t=0,n="default",d=()=>!0,l=!1)=>{const v=f=>!u.value||l?[]:[T("div",{"data-writer-slot-of-id":r,"data-writer-position":f})],h=p.value.filter(ae(n)).filter(d),C=h.filter(f=>!f.isCodeManaged).map(f=>L(f.id,t,{contextSlot:n})),D=h.filter(f=>f.isCodeManaged).map(f=>L(f.id,t,{contextSlot:n}));return[...v(0),...C.map((f,A)=>[f,v(A+1)]).flat(),...D]},z=(t=>t.map(n=>`${n.componentId}:${n.instanceNumber}`).join(","))(a);I(g.evaluatedFields,e),I(g.componentId,r),I(g.isBeingEdited,u),I(g.isDisabled,w),I(g.instancePath,a),I(g.instanceData,P),I(g.renderProxiedComponent,L),I(g.getChildrenVNodes,K),I(g.flattenedInstancePath,z);const re={"data-writer-id":r,"data-writer-instance-path":z},W=M(!1);j(()=>(m==null?void 0:m.getSelectedId())==r,t=>{W.value=t}),j(()=>e,()=>{W.value=!1},{deep:!0});const H=_(()=>p.value.length==0),le=_(()=>S(r,a)),ie=(t,n)=>{if(!t.startsWith("$")&&!n)return l=>{let v=!1;ne.value.some(h=>h.name==t&&h.args.includes("payload"))&&(v=!0),o.forwardEvent(l,a,v)};if(t.startsWith("$goToPage_")){const l=t.substring(10);return v=>o.setActivePageFromKey(l)}return null},ce=_(()=>{const t={},n=Object.keys(s.value.handlers??{}),d=s.value.binding?[s.value.binding.eventType]:[];return Array.from(new Set([...n,...d])).forEach(v=>{var D;const h=`on${v.charAt(0).toUpperCase()}${v.slice(1)}`,C=v===((D=s.value.binding)==null?void 0:D.eventType);t[h]=f=>{var O,U;C&&o.forwardEvent(f,a,!0);const A=(O=s.value.handlers)==null?void 0:O[v];A&&((U=ie(A,C))==null||U(f))}}),t}),de=_(()=>{var d;const t=(d=o.getComponentDefinition(s.value.type))==null?void 0:d.fields;if(!t)return;const n={};return Object.keys(t).forEach(l=>{t[l].applyStyleVariable&&e[l]&&(n[`--${l}`]=e[l].value)}),n}),ue=_(()=>{var h;const t="cssClasses",n=(h=o.getComponentDefinition(s.value.type))==null?void 0:h.fields;if(!n||!n[t]||!e[t])return;const d=e[t].value,l=d==null?void 0:d.split(" ").map(C=>C.trim()),v={};return l.forEach(C=>{v[C]=!0}),v}),pe=function(){return{class:{[`wf-type-${s.value.type}`]:!0,component:!0,childless:H.value,selected:W.value,disabled:w.value,beingEdited:u.value,...ue.value},style:{...de.value,...le.value?{}:{display:"none"}},...re,...w.value?[]:ce.value,draggable:V.value}},ve=(t,n)=>u.value?T(De,{...t,componentType:s.value.type,message:n}):T("div");return()=>{const t=u.value?oe():void 0,n=({instanceNumber:l=0,slotName:v="default",componentFilter:h=()=>!0,positionlessSlot:C=!1})=>H.value?C?void 0:t:K(l,v,h,C),d={...pe()};return B(s.value.parentId,s.value.type)?T(y,d,{default:n}):ve(d,"Parent is not suitable for this component")}}},se=N(xe,[["__scopeId","data-v-3743025e"]]),R=c=>(ee("data-v-b2157300"),c=c(),te(),c),Fe=R(()=>i("i",{class:"icon material-symbols-outlined"}," notifications ",-1)),Ve={class:"counter"},Ae=R(()=>i("div",{class:"balloonFlash"},null,-1)),ke={class:"main"},Re={class:"clearContainer"},Le=R(()=>i("i",{class:"material-symbols-outlined"}," clear_all ",-1)),We=R(()=>i("i",{class:"material-symbols-outlined"}," exclamation ",-1)),je=[We],Ne={class:"content"},Ke={class:"title"},ze={class:"time"},He={class:"message"},Oe=100,Ue=k({__name:"RendererNotifications",setup(c){const o=F(g.core),m=M(!1),r=M(null),s=ge([]),y=b=>{const{type:S,title:e,message:p,code:u}=b;s.unshift({type:S,title:e,message:p,code:u,timestampReceived:new Date}),s.splice(Oe),r.value.classList.remove("alert"),r.value.offsetWidth,r.value.classList.add("alert")};_e(()=>{o.addMailSubscription("notification",y)});const a=()=>{s.length!=0&&(m.value=!m.value)},P=()=>{s.splice(0),m.value=!1};return(b,S)=>X((E(),x("div",{class:"RendererNotifications colorTransformer",onClick:a},[i("div",{ref_key:"balloon",ref:r,class:"balloon",title:"Toggle notifications"},[Fe,i("div",Ve,$(s.length),1)],512),Ae,X(i("div",ke,[i("div",Re,[Q(Ce,{onClick:P},{default:he(()=>[Le,ye(" Clear all ")]),_:1})]),(E(!0),x(be,null,Ie(s,(e,p)=>(E(),x("div",{key:p,class:"notification"},[i("div",{class:Z(["icon",e.type])},je,2),i("div",Ne,[i("header",null,[i("strong",Ke,$(e.title),1),i("span",ze,$(e.timestampReceived.toLocaleTimeString()),1)]),i("div",He,$(e.message),1)])]))),128))],512),[[Y,m.value]])],512)),[[Y,s.length>0]])}}),Xe=N(Ue,[["__scopeId","data-v-b2157300"]]),Ye=c=>(ee("data-v-4b3a783f"),c=c(),te(),c),qe=Ye(()=>i("div",{class:"loadingBar"},null,-1)),Ge={class:"rootComponentArea"},Je=k({__name:"ComponentRenderer",setup(c){const o=F(g.core),m=J(o),r=o.getComponentById("root");r||console.error("No root component found.");const s=[{componentId:"root",instanceNumber:0}],y=[M(null)],a=m.getEvaluatedFields(s),P=_(()=>{var e,p,u,V,B,w;return{"--accentColor":(e=a.accentColor)==null?void 0:e.value,"--emptinessColor":(p=a.emptinessColor)==null?void 0:p.value,"--containerBackgroundColor":(u=a.parentIdBackgroundColor)==null?void 0:u.value,"--primaryTextColor":(V=a.primaryTextColor)==null?void 0:V.value,"--secondaryTextColor":(B=a.secondaryTextColor)==null?void 0:B.value,"--separatorColor":(w=a.separatorColor)==null?void 0:w.value}}),b=_(()=>o.getFrontendMessageMap().size>0);j(()=>{var e;return(e=a.appName)==null?void 0:e.value},e=>{S(e)},{immediate:!0});function S(e){const p=o.getMode();let u;e&&p=="edit"?u=`${e} | Writer Framework | Builder`:!e&&p=="edit"?u="Writer Framework | Builder":e&&p=="run"?u=`${e}`:!e&&p=="run"&&(u="Writer Framework App"),document.title=u}return(e,p)=>(E(),x("main",{class:Z(["ComponentRenderer",{loadingActive:b.value}]),tabindex:"-1",style:Ee(P.value)},[Q(Xe,{class:"notifications"}),qe,i("div",Ge,[q(r)?(E(),G(se,{key:0,"component-id":q(r).id,"instance-path":s,"instance-data":y},null,8,["component-id"])):Pe("",!0),Se(e.$slots,"default",{},void 0,!0)])],6))}}),et=N(Je,[["__scopeId","data-v-4b3a783f"]]);export{et as default};
