import{t,v as M,x as N,y as $,_ as T,j as k,z as y,A as v,f as o,h as l,B as g,q as c,p as d,C as P,D as _,E as B,F as A,G as x,n as f,Q as C,s as a,H as b,I as h,J as F,k as Q,l as L,K as w,m as E,L as D}from"./index-BcYb4QxB.js";import{Q as S}from"./QPageSticky-DP_3tGhw.js";import{Q as z}from"./QPage-iV6f14Q3.js";import{Q as G}from"./QCircularProgress-BeXMSaKj.js";import"./format-CJebrXOQ.js";const R=[t("circle",{cx:"12.5",cy:"12.5",r:"12.5"},[t("animate",{attributeName:"fill-opacity",begin:"0s",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})]),t("circle",{cx:"12.5",cy:"52.5",r:"12.5","fill-opacity":".5"},[t("animate",{attributeName:"fill-opacity",begin:"100ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})]),t("circle",{cx:"52.5",cy:"12.5",r:"12.5"},[t("animate",{attributeName:"fill-opacity",begin:"300ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})]),t("circle",{cx:"52.5",cy:"52.5",r:"12.5"},[t("animate",{attributeName:"fill-opacity",begin:"600ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})]),t("circle",{cx:"92.5",cy:"12.5",r:"12.5"},[t("animate",{attributeName:"fill-opacity",begin:"800ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})]),t("circle",{cx:"92.5",cy:"52.5",r:"12.5"},[t("animate",{attributeName:"fill-opacity",begin:"400ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})]),t("circle",{cx:"12.5",cy:"92.5",r:"12.5"},[t("animate",{attributeName:"fill-opacity",begin:"700ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})]),t("circle",{cx:"52.5",cy:"92.5",r:"12.5"},[t("animate",{attributeName:"fill-opacity",begin:"500ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})]),t("circle",{cx:"92.5",cy:"92.5",r:"12.5"},[t("animate",{attributeName:"fill-opacity",begin:"200ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})])],j=M({name:"QSpinnerGrid",props:N,setup(e){const{cSize:n,classes:i}=$(e);return()=>t("svg",{class:i.value,fill:"currentColor",width:n.value,height:n.value,viewBox:"0 0 105 105",xmlns:"http://www.w3.org/2000/svg"},R)}}),q=[t("g",{fill:"none","fill-rule":"evenodd","stroke-width":"2"},[t("circle",{cx:"22",cy:"22",r:"1"},[t("animate",{attributeName:"r",begin:"0s",dur:"1.8s",values:"1; 20",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.165, 0.84, 0.44, 1",repeatCount:"indefinite"}),t("animate",{attributeName:"stroke-opacity",begin:"0s",dur:"1.8s",values:"1; 0",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.3, 0.61, 0.355, 1",repeatCount:"indefinite"})]),t("circle",{cx:"22",cy:"22",r:"1"},[t("animate",{attributeName:"r",begin:"-0.9s",dur:"1.8s",values:"1; 20",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.165, 0.84, 0.44, 1",repeatCount:"indefinite"}),t("animate",{attributeName:"stroke-opacity",begin:"-0.9s",dur:"1.8s",values:"1; 0",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.3, 0.61, 0.355, 1",repeatCount:"indefinite"})])])],V=M({name:"QSpinnerPuff",props:N,setup(e){const{cSize:n,classes:i}=$(e);return()=>t("svg",{class:i.value,stroke:"currentColor",width:n.value,height:n.value,viewBox:"0 0 44 44",xmlns:"http://www.w3.org/2000/svg"},q)}}),H=k({name:"CountdownTimer",props:{duration:{type:Number,required:!0},messageDuration:{type:Number,default:.5},messageText:{type:String,default:"ðŸ˜ƒ"}},data(){return{intervalTimerId:null,remainingSeconds:0,startDuration:0}},computed:{showBox(){return this.remainingSeconds>0},showCountdown(){return this.remainingSeconds>0},showMessage(){return+this.remainingSeconds<=this.messageDuration}},mounted(){this.startTimer()},beforeUnmount(){clearInterval(this.intervalTimerId)},methods:{abortTimer(){clearInterval(this.intervalTimerId),this.remainingSeconds=0},startTimer(){this.startDuration=this.duration,this.remainingSeconds=this.startDuration,console.log(`starting timer, duration=${this.startDuration}`),this.intervalTimerId=setInterval(()=>{this.remainingSeconds-=.05,this.remainingSeconds<=0&&clearInterval(this.intervalTimerId)},50)}}}),O={id:"countdown-timer-container",class:"flex flex-center",style:{width:"70vw",height:"70vh"}},K=["innerHTML"],X={style:{height:"100%"}};function J(e,n,i,r,u,m){return y((o(),l("div",O,[y(g("div",{id:"countdown-timer-message",style:{position:"absolute","font-size":"150px"},innerHTML:e.messageText},null,8,K),[[v,e.showMessage]]),g("div",X,[y(c(G,{"show-value":!e.showMessage,style:{width:"100%",height:"100%"},value:e.remainingSeconds,min:0,max:e.startDuration,reverse:"","animation-speed":"100","font-size":"0.5em",size:"70vh",color:"primary",class:"text-secondary"},{default:d(()=>[P(_(parseFloat(e.remainingSeconds.toFixed(0))),1)]),_:1},8,["show-value","value","max"]),[[v,e.showCountdown]])])],512)),[[v,e.showBox]])}const U=T(H,[["render",J],["__file","CountdownTimer.vue"]]),Y=k({__name:"FrontpageTriggerButtons",props:{triggers:{}},emits:["triggerAction"],setup(e,{expose:n,emit:i}){n();const r=i;function u(s,p){r("triggerAction",s,p)}const m={emit:r,triggerButtonClick:u,get isEmpty(){return B.isEmpty}};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}}),W={class:"row q-gutter-md action-buttons"},Z={style:{"white-space":"nowrap"},class:"gt-sm"};function ee(e,n,i,r,u,m){return o(),l("div",W,[(o(!0),l(A,null,x(i.triggers,(s,p)=>(o(),l("div",{key:p},[s.show_button&&!(r.isEmpty(s.title)&&r.isEmpty(s.icon))?(o(),f(h,{key:0,stack:"",color:"primary","no-caps":"",rounded:"",class:b(["action-button col-auto",["action-button-"+p]]),onClick:I=>r.triggerButtonClick(s.action,s.config_index)},{default:d(()=>[r.isEmpty(s.icon)?a("",!0):(o(),f(C,{key:0,name:`sym_o_${s.icon}`},null,8,["name"])),g("div",Z,_(s.title),1)]),_:2},1032,["class","onClick"])):a("",!0)]))),128))])}const te=T(Y,[["render",ee],["__file","FrontpageTriggerButtons.vue"]]),ne=k({components:{CountdownTimer:U,FrontpageTriggerButtons:te},setup(){const e=F(),n=Q(),i=L();return{store:e,stateStore:n,configurationStore:i,remoteProcedureCall:w}},computed:{triggerButtons:{get(){const e=[];return["actions.image","actions.collage","actions.animation","actions.video","printer.print"].forEach(i=>{this.configurationStore.getConfigElement(i,[]).forEach((u,m)=>{const s=B.get(u,"trigger.ui_trigger");e.push({action:i.replace(".","/"),config_index:m,...s})})}),console.log(e),e}},showProcessing:{get(){const e=this.stateStore.state=="capture";return this.stateStore.state=="captures_completed"||e&&!this.showCountdownCounting}},showRecording:{get(){return this.stateStore.state=="record"}},livestreamMirror:{get(){return this.configurationStore.getConfigElement("uisettings.livestream_mirror_effect")}},showCountdownCounting:{get(){const e=this.stateStore.state=="counting",n=this.stateStore.state=="capture";return this.stateStore.duration>0&&e||n}},showPreview:{get(){const n=!this.stateStore.state||this.stateStore.state=="finished",i=this.stateStore.state=="record",r=this.stateStore.state=="counting",u=this.stateStore.state=="capture";return n||r||i||u}},showFrontpage:{get(){return!this.stateStore.state||this.stateStore.state=="finished"}}},watch:{},methods:{invokeAction(e,n){w(`/api/${e}/${n}`)},stopRecordingVideo(){w("/api/actions/stop")}}}),ie={key:0,class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},oe={key:1,id:"frontpage-countdown",class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},se=["innerHTML"],re={key:0},ae={key:0},ce={class:"q-gutter-md"},le={class:"gt-sm"},ue={class:"gt-sm"},de=g("br",null,null,-1);function ge(e,n,i,r,u,m){const s=E("countdown-timer"),p=E("FrontpageTriggerButtons");return o(),f(z,{id:"index-page",class:"q-pa-none column full-height"},{default:d(()=>[g("div",{id:"preview-stream-wrapper",class:b({mirroreffect:e.livestreamMirror})},[e.showPreview?(o(),l("div",{key:0,id:"preview-stream",style:{"background-image":"url('/api/aquisition/stream.mjpg')"},class:b(["full-width column justify-center content-center",{countdowncounting:e.showCountdownCounting}])},null,2)):a("",!0)],2),e.showProcessing?(o(),l("div",ie,[c(j,{size:"20em"})])):a("",!0),e.showCountdownCounting?(o(),l("div",oe,[c(s,{ref:"countdowntimer",duration:e.stateStore.duration,"message-duration":e.configurationStore.getConfigElement("uisettings.TAKEPIC_MSG_TIME"),"message-text":e.configurationStore.getConfigElement("uisettings.TAKEPIC_MSG_TEXT")},null,8,["duration","message-duration","message-text"])])):a("",!0),e.showFrontpage?(o(),l("div",{key:2,id:"frontpage_text",innerHTML:e.configurationStore.getConfigElement("uisettings.FRONTPAGE_TEXT")},null,8,se)):a("",!0),c(S,{position:"bottom",offset:[0,25]},{default:d(()=>[e.showFrontpage?(o(),l("div",re,[c(p,{triggers:e.triggerButtons,onTriggerAction:e.invokeAction},null,8,["triggers","onTriggerAction"])])):a("",!0)]),_:1}),c(S,{position:"top-left",offset:[25,25]},{default:d(()=>[e.showFrontpage?(o(),l("div",ae,[g("div",ce,[e.configurationStore.getConfigElement("uisettings.show_gallery_on_frontpage")?(o(),f(h,{key:0,id:"frontpage-button-to-gallery",color:"primary","no-caps":"",rounded:"",to:"/gallery",class:"action-button",style:D(e.configurationStore.getConfigElement("uisettings.gallery_button_style"))},{default:d(()=>[c(C,{left:"",name:"sym_o_photo_library"}),g("div",le,_(e.$t("BTN_LABEL_MAINPAGE_TO_GALLERY")),1)]),_:1},8,["style"])):a("",!0),e.configurationStore.getConfigElement("uisettings.show_admin_on_frontpage")?(o(),f(h,{key:1,id:"frontpage-button-to-admin",rounded:"",color:"secondary","no-caps":"",to:"/admin",class:"action-button"},{default:d(()=>[c(C,{left:"",name:"sym_o_admin_panel_settings"}),g("div",ue,_(e.$t("BTN_LABEL_MAINPAGE_TO_ADMIN")),1)]),_:1})):a("",!0)])])):a("",!0)]),_:1}),e.showRecording?(o(),f(S,{key:3,id:"frontpage-indicator-recording",position:"top",offset:[0,25],align:"center"},{default:d(()=>[c(V,{color:"red",size:"10em"}),de,c(h,{flat:"",color:"red",label:"Stop recording",onClick:n[0]||(n[0]=I=>e.stopRecordingVideo())})]),_:1})):a("",!0)]),_:1})}const ye=T(ne,[["render",ge],["__file","IndexPage.vue"]]);export{ye as default};
