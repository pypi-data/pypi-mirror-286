import{C as V,D as re,r as ye,Q,R as _e,t as y,E as w,m as h,J as x,U as be,N as L,V as J,u as K,w as $,I as c,W as ge,H as p,K as ae,F as oe,G as S,y as we,c as H,X as Z}from"./index-5a44a053.js";import{_ as xe,P as ke}from"./PowerFlowCard-8cb876ae.js";import{V as Me}from"./VSelect-3b5c15f5.js";import{f as C,a as Ce}from"./utils-6f3c77d7.js";import{V as ie,a as Y,b as q}from"./VCard-2565a0b7.js";import{m as R,t as $e,r as v,d as Pe,a as Se,v as Ie,c as ne,i as B,A as se,P as Te,B as Ae,e as Be,b as Ee,C as De,p as Re,f as Ve,g as We,D as Ne}from"./index-b30ab237.js";import{n as N}from"./transition-1df78eef.js";import{V as je,a as ze}from"./VToolbar-b6309aac.js";import{V as Oe}from"./VProgressCircular-e11c7d5f.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./VTextField-f153c512.js";import"./index-cc451665.js";import"./forwardRefs-a329760c.js";import"./VImg-1aa5363e.js";import"./VOverlay-168871f7.js";import"./lazy-64d1df8a.js";import"./VSlideGroup-e14de701.js";import"./resizeObserver-115493a9.js";const Fe={key:0,class:"bg-subgroup mt-2 w-full items-center rounded-md px-2 pt-1"},Le=V({__name:"PowerModeSelection",props:{deviceId:{},supportedPowerModes:{},powerMode:{}},setup(e){const{t:r}=re();function a(i){return{title:r("power_mode."+i),mode:i}}let t=ye("device_controlled");const o=e;return Q(t,()=>{t.value!=""&&J.setPowerMode(o.deviceId,t.value)}),Q(()=>o.powerMode,(i,n)=>{console.log("watch power mode: "+t.value),t.value=o.powerMode}),_e(()=>{t.value=o.powerMode}),(i,n)=>i.supportedPowerModes&&i.supportedPowerModes.length>1&&i.powerMode?(y(),w("div",Fe,[h(Me,{modelValue:x(t),"onUpdate:modelValue":n[0]||(n[0]=s=>be(t)?t.value=s:t=s),class:"my-4",items:i.supportedPowerModes.map(s=>a(s)),"item-title":"title","item-value":"mode","single-line":""},null,8,["modelValue","items"])])):L("",!0)}}),He={class:""},Ue={class:"grid w-full grid-cols-1"},Ge={key:0,class:"bg-subgroup mt-2 items-center rounded-md p-2"},Xe={class:"float-right"},Je={key:1,class:"bg-error mt-2 rounded-md p-2 text-center"},Ke={class:"bg-subgroup mt-2 items-center rounded-md p-2"},Ye={key:0,class:"text-left"},qe={class:"float-right"},Qe=V({__name:"DeviceCard",props:{device:{},available:{type:Boolean},power:{},today:{},attributes:{}},setup(e){const{t:r}=re();function a(t,o){switch(t){case"session_time":return Ce(o);case"session_energy":case"session_solar_energy":return C(parseFloat(o),"kWh")}return o}return(t,o)=>(y(),K(q,{class:"elevation-2 m-4 w-80 rounded-md p-4 sm:w-96"},{default:$(()=>[h(ie,null,{default:$(()=>[c("span",{class:ge(["mdi pr-2",t.device.icon])},null,2),c("span",He,p(t.device.name),1)]),_:1}),h(Y,null,{default:$(()=>[c("div",Ue,[t.available&&t.attributes&&Object.entries(t.attributes).length>0?(y(),w("div",Ge,[(y(!0),w(ae,null,oe(Object.entries(t.attributes),(i,n)=>(y(),w("div",{key:n,class:"text-left"},[S(p(x(r)("device_attribute."+i[0]))+" ",1),c("span",Xe,p(a(i[0],i[1])),1)]))),128))])):L("",!0),t.available?L("",!0):(y(),w("div",Je,p(t.$t("unavailable")),1)),c("div",Ke,[t.available?(y(),w("div",Ye,[S(p(x(r)("consumption"))+" ",1),c("span",qe,p(x(C)(t.power,"W")),1)])):L("",!0),h(xe,{"self-sufficiency":t.today.self_sufficiency,"consumed-energy":t.today.consumed_energy,"consumed-solar-energy":t.today.consumed_solar_energy},null,8,["self-sufficiency","consumed-energy","consumed-solar-energy"])])]),h(Le,{"device-id":t.device.id,"supported-power-modes":t.device.supported_power_modes,"power-mode":t.device.power_mode},null,8,["device-id","supported-power-modes","power-mode"])]),_:1})]),_:1}))}});/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var ee=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var e=window.screen;if(e)return(e.deviceXDPI||1)/(e.logicalXDPI||1)}return 1}(),E={toTextLines:function(e){var r=[],a;for(e=[].concat(e);e.length;)a=e.pop(),typeof a=="string"?r.unshift.apply(r,a.split(`
`)):Array.isArray(a)?e.push.apply(e,a):B(e)||r.unshift(""+a);return r},textSize:function(e,r,a){var t=[].concat(r),o=t.length,i=e.font,n=0,s;for(e.font=a.string,s=0;s<o;++s)n=Math.max(e.measureText(t[s]).width,n);return e.font=i,{height:o*a.lineHeight,width:n}},bound:function(e,r,a){return Math.max(e,Math.min(r,a))},arrayDiff:function(e,r){var a=e.slice(),t=[],o,i,n,s;for(o=0,n=r.length;o<n;++o)s=r[o],i=a.indexOf(s),i===-1?t.push([s,1]):a.splice(i,1);for(o=0,n=a.length;o<n;++o)t.push([a[o],-1]);return t},rasterize:function(e){return Math.round(e*ee)/ee}};function G(e,r){var a=r.x,t=r.y;if(a===null)return{x:0,y:-1};if(t===null)return{x:1,y:0};var o=e.x-a,i=e.y-t,n=Math.sqrt(o*o+i*i);return{x:n?o/n:0,y:n?i/n:-1}}function Ze(e,r,a,t,o){switch(o){case"center":a=t=0;break;case"bottom":a=0,t=1;break;case"right":a=1,t=0;break;case"left":a=-1,t=0;break;case"top":a=0,t=-1;break;case"start":a=-a,t=-t;break;case"end":break;default:o*=Math.PI/180,a=Math.cos(o),t=Math.sin(o);break}return{x:e,y:r,vx:a,vy:t}}var et=0,le=1,de=2,ue=4,fe=8;function j(e,r,a){var t=et;return e<a.left?t|=le:e>a.right&&(t|=de),r<a.top?t|=fe:r>a.bottom&&(t|=ue),t}function tt(e,r){for(var a=e.x0,t=e.y0,o=e.x1,i=e.y1,n=j(a,t,r),s=j(o,i,r),d,l,u;!(!(n|s)||n&s);)d=n||s,d&fe?(l=a+(o-a)*(r.top-t)/(i-t),u=r.top):d&ue?(l=a+(o-a)*(r.bottom-t)/(i-t),u=r.bottom):d&de?(u=t+(i-t)*(r.right-a)/(o-a),l=r.right):d&le&&(u=t+(i-t)*(r.left-a)/(o-a),l=r.left),d===n?(a=l,t=u,n=j(a,t,r)):(o=l,i=u,s=j(o,i,r));return{x0:a,x1:o,y0:t,y1:i}}function z(e,r){var a=r.anchor,t=e,o,i;return r.clamp&&(t=tt(t,r.area)),a==="start"?(o=t.x0,i=t.y0):a==="end"?(o=t.x1,i=t.y1):(o=(t.x0+t.x1)/2,i=(t.y0+t.y1)/2),Ze(o,i,e.vx,e.vy,r.align)}var O={arc:function(e,r){var a=(e.startAngle+e.endAngle)/2,t=Math.cos(a),o=Math.sin(a),i=e.innerRadius,n=e.outerRadius;return z({x0:e.x+t*i,y0:e.y+o*i,x1:e.x+t*n,y1:e.y+o*n,vx:t,vy:o},r)},point:function(e,r){var a=G(e,r.origin),t=a.x*e.options.radius,o=a.y*e.options.radius;return z({x0:e.x-t,y0:e.y-o,x1:e.x+t,y1:e.y+o,vx:a.x,vy:a.y},r)},bar:function(e,r){var a=G(e,r.origin),t=e.x,o=e.y,i=0,n=0;return e.horizontal?(t=Math.min(e.x,e.base),i=Math.abs(e.base-e.x)):(o=Math.min(e.y,e.base),n=Math.abs(e.base-e.y)),z({x0:t,y0:o+n,x1:t+i,y1:o,vx:a.x,vy:a.y},r)},fallback:function(e,r){var a=G(e,r.origin);return z({x0:e.x,y0:e.y,x1:e.x+(e.width||0),y1:e.y+(e.height||0),vx:a.x,vy:a.y},r)}},M=E.rasterize;function rt(e){var r=e.borderWidth||0,a=e.padding,t=e.size.height,o=e.size.width,i=-o/2,n=-t/2;return{frame:{x:i-a.left-r,y:n-a.top-r,w:o+a.width+r*2,h:t+a.height+r*2},text:{x:i,y:n,w:o,h:t}}}function at(e,r){var a=r.chart.getDatasetMeta(r.datasetIndex).vScale;if(!a)return null;if(a.xCenter!==void 0&&a.yCenter!==void 0)return{x:a.xCenter,y:a.yCenter};var t=a.getBasePixel();return e.horizontal?{x:t,y:null}:{x:null,y:t}}function ot(e){return e instanceof se?O.arc:e instanceof Te?O.point:e instanceof Ae?O.bar:O.fallback}function it(e,r,a,t,o,i){var n=Math.PI/2;if(i){var s=Math.min(i,o/2,t/2),d=r+s,l=a+s,u=r+t-s,f=a+o-s;e.moveTo(r,l),d<u&&l<f?(e.arc(d,l,s,-Math.PI,-n),e.arc(u,l,s,-n,0),e.arc(u,f,s,0,n),e.arc(d,f,s,n,Math.PI)):d<u?(e.moveTo(d,a),e.arc(u,l,s,-n,n),e.arc(d,l,s,n,Math.PI+n)):l<f?(e.arc(d,l,s,-Math.PI,0),e.arc(d,f,s,0,Math.PI)):e.arc(d,l,s,-Math.PI,Math.PI),e.closePath(),e.moveTo(r,a)}else e.rect(r,a,t,o)}function nt(e,r,a){var t=a.backgroundColor,o=a.borderColor,i=a.borderWidth;!t&&(!o||!i)||(e.beginPath(),it(e,M(r.x)+i/2,M(r.y)+i/2,M(r.w)-i,M(r.h)-i,a.borderRadius),e.closePath(),t&&(e.fillStyle=t,e.fill()),o&&i&&(e.strokeStyle=o,e.lineWidth=i,e.lineJoin="miter",e.stroke()))}function st(e,r,a){var t=a.lineHeight,o=e.w,i=e.x,n=e.y+t/2;return r==="center"?i+=o/2:(r==="end"||r==="right")&&(i+=o),{h:t,w:o,x:i,y:n}}function lt(e,r,a){var t=e.shadowBlur,o=a.stroked,i=M(a.x),n=M(a.y),s=M(a.w);o&&e.strokeText(r,i,n,s),a.filled&&(t&&o&&(e.shadowBlur=0),e.fillText(r,i,n,s),t&&o&&(e.shadowBlur=t))}function dt(e,r,a,t){var o=t.textAlign,i=t.color,n=!!i,s=t.font,d=r.length,l=t.textStrokeColor,u=t.textStrokeWidth,f=l&&u,_;if(!(!d||!n&&!f))for(a=st(a,o,s),e.font=s.string,e.textAlign=o,e.textBaseline="middle",e.shadowBlur=t.textShadowBlur,e.shadowColor=t.textShadowColor,n&&(e.fillStyle=i),f&&(e.lineJoin="round",e.lineWidth=u,e.strokeStyle=l),_=0,d=r.length;_<d;++_)lt(e,r[_],{stroked:f,filled:n,w:a.w,x:a.x,y:a.y+a.h*_})}var ce=function(e,r,a,t){var o=this;o._config=e,o._index=t,o._model=null,o._rects=null,o._ctx=r,o._el=a};R(ce.prototype,{_modelize:function(e,r,a,t){var o=this,i=o._index,n=$e(v([a.font,{}],t,i)),s=v([a.color,Pe.color],t,i);return{align:v([a.align,"center"],t,i),anchor:v([a.anchor,"center"],t,i),area:t.chart.chartArea,backgroundColor:v([a.backgroundColor,null],t,i),borderColor:v([a.borderColor,null],t,i),borderRadius:v([a.borderRadius,0],t,i),borderWidth:v([a.borderWidth,0],t,i),clamp:v([a.clamp,!1],t,i),clip:v([a.clip,!1],t,i),color:s,display:e,font:n,lines:r,offset:v([a.offset,4],t,i),opacity:v([a.opacity,1],t,i),origin:at(o._el,t),padding:Se(v([a.padding,4],t,i)),positioner:ot(o._el),rotation:v([a.rotation,0],t,i)*(Math.PI/180),size:E.textSize(o._ctx,r,n),textAlign:v([a.textAlign,"start"],t,i),textShadowBlur:v([a.textShadowBlur,0],t,i),textShadowColor:v([a.textShadowColor,s],t,i),textStrokeColor:v([a.textStrokeColor,s],t,i),textStrokeWidth:v([a.textStrokeWidth,0],t,i)}},update:function(e){var r=this,a=null,t=null,o=r._index,i=r._config,n,s,d,l=v([i.display,!0],e,o);l&&(n=e.dataset.data[o],s=Ie(ne(i.formatter,[n,e]),n),d=B(s)?[]:E.toTextLines(s),d.length&&(a=r._modelize(l,d,i,e),t=rt(a))),r._model=a,r._rects=t},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(e,r){var a=this,t=e.ctx,o=a._model,i=a._rects,n;this.visible()&&(t.save(),o.clip&&(n=o.area,t.beginPath(),t.rect(n.left,n.top,n.right-n.left,n.bottom-n.top),t.clip()),t.globalAlpha=E.bound(0,o.opacity,1),t.translate(M(r.x),M(r.y)),t.rotate(o.rotation),nt(t,i.frame,o),dt(t,o.lines,i.text,o),t.restore())}});var ut=Number.MIN_SAFE_INTEGER||-9007199254740991,ft=Number.MAX_SAFE_INTEGER||9007199254740991;function A(e,r,a){var t=Math.cos(a),o=Math.sin(a),i=r.x,n=r.y;return{x:i+t*(e.x-i)-o*(e.y-n),y:n+o*(e.x-i)+t*(e.y-n)}}function te(e,r){var a=ft,t=ut,o=r.origin,i,n,s,d,l;for(i=0;i<e.length;++i)n=e[i],s=n.x-o.x,d=n.y-o.y,l=r.vx*s+r.vy*d,a=Math.min(a,l),t=Math.max(t,l);return{min:a,max:t}}function F(e,r){var a=r.x-e.x,t=r.y-e.y,o=Math.sqrt(a*a+t*t);return{vx:(r.x-e.x)/o,vy:(r.y-e.y)/o,origin:e,ln:o}}var ve=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};R(ve.prototype,{center:function(){var e=this._rect;return{x:e.x+e.w/2,y:e.y+e.h/2}},update:function(e,r,a){this._rotation=a,this._rect={x:r.x+e.x,y:r.y+e.y,w:r.w,h:r.h}},contains:function(e){var r=this,a=1,t=r._rect;return e=A(e,r.center(),-r._rotation),!(e.x<t.x-a||e.y<t.y-a||e.x>t.x+t.w+a*2||e.y>t.y+t.h+a*2)},intersects:function(e){var r=this._points(),a=e._points(),t=[F(r[0],r[1]),F(r[0],r[3])],o,i,n;for(this._rotation!==e._rotation&&t.push(F(a[0],a[1]),F(a[0],a[3])),o=0;o<t.length;++o)if(i=te(r,t[o]),n=te(a,t[o]),i.max<n.min||n.max<i.min)return!1;return!0},_points:function(){var e=this,r=e._rect,a=e._rotation,t=e.center();return[A({x:r.x,y:r.y},t,a),A({x:r.x+r.w,y:r.y},t,a),A({x:r.x+r.w,y:r.y+r.h},t,a),A({x:r.x,y:r.y+r.h},t,a)]}});function he(e,r,a){var t=r.positioner(e,r),o=t.vx,i=t.vy;if(!o&&!i)return{x:t.x,y:t.y};var n=a.w,s=a.h,d=r.rotation,l=Math.abs(n/2*Math.cos(d))+Math.abs(s/2*Math.sin(d)),u=Math.abs(n/2*Math.sin(d))+Math.abs(s/2*Math.cos(d)),f=1/Math.max(Math.abs(o),Math.abs(i));return l*=o*f,u*=i*f,l+=r.offset*o,u+=r.offset*i,{x:t.x+l,y:t.y+u}}function ct(e,r){var a,t,o,i;for(a=e.length-1;a>=0;--a)for(o=e[a].$layout,t=a-1;t>=0&&o._visible;--t)i=e[t].$layout,i._visible&&o._box.intersects(i._box)&&r(o,i);return e}function vt(e){var r,a,t,o,i,n,s;for(r=0,a=e.length;r<a;++r)t=e[r],o=t.$layout,o._visible&&(s=new Proxy(t._el,{get:(d,l)=>d.getProps([l],!0)[l]}),i=t.geometry(),n=he(s,t.model(),i),o._box.update(n,i,t.rotation()));return ct(e,function(d,l){var u=d._hidable,f=l._hidable;u&&f||f?l._visible=!1:u&&(d._visible=!1)})}var D={prepare:function(e){var r=[],a,t,o,i,n;for(a=0,o=e.length;a<o;++a)for(t=0,i=e[a].length;t<i;++t)n=e[a][t],r.push(n),n.$layout={_box:new ve,_hidable:!1,_visible:!0,_set:a,_idx:n._index};return r.sort(function(s,d){var l=s.$layout,u=d.$layout;return l._idx===u._idx?u._set-l._set:u._idx-l._idx}),this.update(r),r},update:function(e){var r=!1,a,t,o,i,n;for(a=0,t=e.length;a<t;++a)o=e[a],i=o.model(),n=o.$layout,n._hidable=i&&i.display==="auto",n._visible=o.visible(),r|=n._hidable;r&&vt(e)},lookup:function(e,r){var a,t;for(a=e.length-1;a>=0;--a)if(t=e[a].$layout,t&&t._visible&&t._box.contains(r))return e[a];return null},draw:function(e,r){var a,t,o,i,n,s;for(a=0,t=r.length;a<t;++a)o=r[a],i=o.$layout,i._visible&&(n=o.geometry(),s=he(o._el,o.model(),n),i._box.update(s,n,o.rotation()),o.draw(e,s))}},ht=function(e){if(B(e))return null;var r=e,a,t,o;if(Ee(e))if(!B(e.label))r=e.label;else if(!B(e.r))r=e.r;else for(r="",a=Object.keys(e),o=0,t=a.length;o<t;++o)r+=(o!==0?", ":"")+a[o]+": "+e[a[o]];return""+r},pt={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:ht,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},m="$datalabels",pe="$default";function mt(e,r){var a=e.datalabels,t={},o=[],i,n;return a===!1?null:(a===!0&&(a={}),r=R({},[r,a]),i=r.labels||{},n=Object.keys(i),delete r.labels,n.length?n.forEach(function(s){i[s]&&o.push(R({},[r,i[s],{_key:s}]))}):o.push(r),t=o.reduce(function(s,d){return Be(d.listeners||{},function(l,u){s[u]=s[u]||{},s[u][d._key||pe]=l}),delete d.listeners,s},{}),{labels:o,listeners:t})}function X(e,r,a,t){if(r){var o=a.$context,i=a.$groups,n;r[i._set]&&(n=r[i._set][i._key],n&&ne(n,[o,t])===!0&&(e[m]._dirty=!0,a.update(o)))}}function yt(e,r,a,t,o){var i,n;!a&&!t||(a?t?a!==t&&(n=i=!0):n=!0:i=!0,n&&X(e,r.leave,a,o),i&&X(e,r.enter,t,o))}function _t(e,r){var a=e[m],t=a._listeners,o,i;if(!(!t.enter&&!t.leave)){if(r.type==="mousemove")i=D.lookup(a._labels,r);else if(r.type!=="mouseout")return;o=a._hovered,a._hovered=i,yt(e,t,o,i,r)}}function bt(e,r){var a=e[m],t=a._listeners.click,o=t&&D.lookup(a._labels,r);o&&X(e,t,o,r)}var gt={id:"datalabels",defaults:pt,beforeInit:function(e){e[m]={_actives:[]}},beforeUpdate:function(e){var r=e[m];r._listened=!1,r._listeners={},r._datasets=[],r._labels=[]},afterDatasetUpdate:function(e,r,a){var t=r.index,o=e[m],i=o._datasets[t]=[],n=e.isDatasetVisible(t),s=e.data.datasets[t],d=mt(s,a),l=r.meta.data||[],u=e.ctx,f,_,I,T,g,P,b,k;for(u.save(),f=0,I=l.length;f<I;++f)if(b=l[f],b[m]=[],n&&b&&e.getDataVisibility(f)&&!b.skip)for(_=0,T=d.labels.length;_<T;++_)g=d.labels[_],P=g._key,k=new ce(g,u,b,f),k.$groups={_set:t,_key:P||pe},k.$context={active:!1,chart:e,dataIndex:f,dataset:s,datasetIndex:t},k.update(k.$context),b[m].push(k),i.push(k);u.restore(),R(o._listeners,d.listeners,{merger:function(W,U,me){U[W]=U[W]||{},U[W][r.index]=me[W],o._listened=!0}})},afterUpdate:function(e){e[m]._labels=D.prepare(e[m]._datasets)},afterDatasetsDraw:function(e){D.draw(e,e[m]._labels)},beforeEvent:function(e,r){if(e[m]._listened){var a=r.event;switch(a.type){case"mousemove":case"mouseout":_t(e,a);break;case"click":bt(e,a);break}}},afterEvent:function(e){var r=e[m],a=r._actives,t=r._actives=e.getActiveElements(),o=E.arrayDiff(a,t),i,n,s,d,l,u,f;for(i=0,n=o.length;i<n;++i)if(l=o[i],l[1])for(f=l[0].element[m]||[],s=0,d=f.length;s<d;++s)u=f[s],u.$context.active=l[1]===1,u.update(u.$context);(r._dirty||o.length)&&(D.update(r._labels),e.render()),delete r._dirty}};const wt="bold",xt=V({__name:"DevicePowerDistributionCard",props:{devices:{},power:{},selfSufficiency:{}},setup(e){const r=we(),a={id:"doughnutlabel",beforeDraw:(n,s,d)=>{const{ctx:l}=n;l.save(),l.globalCompositeOperation="destination-over";var u=n.chartArea.width,f=n.chartArea.height;l.font="1.2em sans-serif",l.fillStyle=d.color;const _=2;l.textBaseline="top";let I=0;for(let g=0;g<d.text.length;g++){const P=d.text[g],b=l.measureText(P);I+=(b.actualBoundingBoxAscent+b.actualBoundingBoxDescent)*_}let T=n.chartArea.top+(f-I)/2;for(let g=0;g<d.text.length;g++){const P=d.text[g],b=l.measureText(P),k=n.chartArea.left+Math.round((u-b.width)/2);l.fillText(P,k,T),T+=(b.actualBoundingBoxAscent+b.actualBoundingBoxDescent)*_}l.restore()},defaults:{text:[],color:"black"}},t=H(()=>{const n=i.devices.filter(s=>s.power>0);return{labels:n.map(s=>J.getDeviceInfo(s.device_id).name),datasets:[{data:n.map(s=>s.power)}]}}),o=H(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{color:r.current.value.colors["on-surface"]}},tooltip:{callbacks:{label:n=>`${C(n.parsed,"W")}`}},doughnutlabel:{color:r.current.value.colors["on-surface"],text:[C(i.power,"W"),i.selfSufficiency.toFixed(0)+"%"]},datalabels:{backgroundColor:function(n){return n.dataset.backgroundColor},borderColor:"white",borderRadius:25,borderWidth:2,color:"white",display:function(n){var s=n.dataset;const d=s.data.reduce((u,f)=>u+f,0);var l=s.data[n.dataIndex];return l>d/10},font:{weight:wt},padding:6,formatter:Math.round}}}));De.register(se,Re,Ve,We,a,gt);const i=e;return(n,s)=>(y(),K(q,{class:"elevation-2 m-4 w-80 rounded-md p-4 sm:w-96"},{default:$(()=>[h(Y,null,{default:$(()=>[h(x(Ne),{data:t.value,options:o.value},null,8,["data","options"])]),_:1})]),_:1}))}}),kt={class:"bg-subgroup mt-2 items-center rounded-md p-2"},Mt={class:"text-left"},Ct={class:"float-right"},$t={class:"bg-subgroup mt-2 items-center rounded-md p-2"},Pt={class:"text-left"},St={class:"float-right"},It={class:"bg-subgroup mt-2 items-center rounded-md p-2"},Tt={class:"text-left"},At={class:"float-right"},Bt={class:"bg-subgroup mt-2 items-center rounded-md p-2"},Et={class:"text-left"},Dt={class:"float-right"},Rt=V({__name:"ConsumptionCard",props:{selfSufficiency:{},selfConsumption:{},selfSufficiencyToday:{},selfConsumptionToday:{}},setup(e){return(r,a)=>(y(),K(q,{class:"elevation-2 m-4 w-80 rounded-md p-4 sm:w-96"},{default:$(()=>[h(ie,null,{default:$(()=>[S(p(r.$t("consumption")),1)]),_:1}),h(Y,null,{default:$(()=>[c("div",kt,[c("div",Mt,[S(p(r.$t("self_sufficiency"))+" ",1),c("span",Ct,p(x(C)(r.selfSufficiency,"%")),1)]),h(N,{color:"sun",height:"15",rounded:"","model-value":r.selfSufficiency},null,8,["model-value"])]),c("div",$t,[c("div",Pt,[S(p(r.$t("self_consumption"))+" ",1),c("span",St,p(x(C)(r.selfConsumption,"%")),1)]),h(N,{color:"grid",height:"15",rounded:"","model-value":r.selfConsumption},null,8,["model-value"])]),c("div",null,p(r.$t("period.today"))+":",1),c("div",It,[c("div",Tt,[S(p(r.$t("self_sufficiency"))+" ",1),c("span",At,p(x(C)(r.selfSufficiencyToday,"%")),1)]),h(N,{color:"sun",height:"15",rounded:"","model-value":r.selfSufficiencyToday},null,8,["model-value"])]),c("div",Bt,[c("div",Et,[S(p(r.$t("self_consumption"))+" ",1),c("span",Dt,p(x(C)(r.selfConsumptionToday,"%")),1)]),h(N,{color:"grid",height:"15",rounded:"","model-value":r.selfConsumptionToday},null,8,["model-value"])])]),_:1})]),_:1}))}}),Vt={class:"flex min-h-screen w-full justify-center"},Wt={key:0,class:"flex w-full justify-items-center p-4"},Nt={key:1},jt={class:"bg-background grid grid-cols-1 p-4 lg:grid-cols-2"},or=V({__name:"Home",setup(e){const r=H(()=>Z.home),a=H(()=>Z.state.connected);return(t,o)=>(y(),w("div",null,[h(je,{color:"transparent",title:r.value.name},null,8,["title"]),h(ze),c("div",Vt,[a.value?(y(),w("div",Nt,[c("div",jt,[h(ke,{"home-consumption-power":r.value.power.home_consumption,"solar-power":r.value.power.solar_production,unit:"W"},null,8,["home-consumption-power","solar-power"]),h(xt,{devices:r.value.devices,power:r.value.power.home_consumption,"self-sufficiency":r.value.power.self_sufficiency},null,8,["devices","power","self-sufficiency"]),h(Rt,{"self-sufficiency":r.value.power.self_sufficiency,"self-consumption":r.value.power.self_consumption,"self-sufficiency-today":r.value.today.self_sufficiency,"self-consumption-today":r.value.today.self_consumption},null,8,["self-sufficiency","self-consumption","self-sufficiency-today","self-consumption-today"]),(y(!0),w(ae,null,oe(r.value.devices,(i,n)=>(y(),w("div",{key:n},[h(Qe,{device:x(J).getDeviceInfo(i.device_id),available:i.available,power:i.power,today:i.today,attributes:i.attributes},null,8,["device","available","power","today","attributes"])]))),128))])])):(y(),w("div",Wt,[h(Oe,{indeterminate:"",color:"primary"})]))])]))}});export{or as default};
