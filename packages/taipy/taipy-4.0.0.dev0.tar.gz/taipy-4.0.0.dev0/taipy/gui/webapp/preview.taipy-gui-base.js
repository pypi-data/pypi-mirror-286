!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.TaipyGuiBase=e():t.TaipyGuiBase=e()}(this,(()=>(()=>{"use strict";var t,e={8007:(t,e,n)=>{n.r(e),n.d(e,{TaipyApp:()=>u,createApp:()=>p,default:()=>g});var s=n(3829);const a="TaipyClientId",i=new Worker(new URL(n.p+n.u(677),n.b));var o=n(7115),r=n(5364),d=n.n(r);class c{constructor(t){this._data={},this._init_data={},this.init(t)}init(t){const e={};for(const n in this._init_data)if(n in t)for(const s in this._init_data[n])s in t[n]||(n in e||(e[n]={}),e[n][s]=this._init_data[n][s]);else e[n]=this._init_data[n];0!==Object.keys(e).length&&console.error("Unmatched data tree! Removed changes: ",e),this._init_data=t,this._data={};for(const t in this._init_data)for(const e in this._init_data[t]){const n=this._init_data[t][e];this._data[n.encoded_name]=n.value}return e}getEncodedName(t,e){if(e in this._init_data&&t in this._init_data[e])return this._init_data[e][t].encoded_name}getName(t){for(const e in this._init_data)for(const n in this._init_data[e])if(this._init_data[e][n].encoded_name===t)return[n,e]}get(t){if(!(t in this._data))throw new Error(`${t} is not available in Taipy Gui`);return this._data[t]}getInfo(t){for(const e in this._init_data)for(const n in this._init_data[e]){const s=this._init_data[e][n];if(s.encoded_name===t)return Object.assign(Object.assign({},s),{value:this._data[t]})}}getDataTree(){return this._init_data}getAllData(){return this._data}update(t,e){if(!(t in this._data))throw new Error(`${t} is not available in Taipy Gui`);this._data[t]=e}}class h{}class l extends h{constructor(){super(),this.supportedMessageTypes=["MU","ID","GMC","GDT","AID","GR","AL","ACK"],this.initWsMessageTypes=["ID","AID","GMC"]}handleWsMessage(t,e){var n;if(t.type){if("MU"===t.type&&Array.isArray(t.payload))for(const s of t.payload){const t=s.name,{value:a}=s.payload;null===(n=e.variableData)||void 0===n||n.update(t,a),e.onChangeEvent(t,a)}else if("ID"===t.type){const{id:n}=t;(t=>{localStorage&&localStorage.setItem(a,t)})(n),e.clientId=n,e.updateContext(e.path)}else if("GMC"===t.type){const n=t.payload;if(e.context=n.context,null==n?void 0:n.metadata)try{e.metadata=JSON.parse(n.metadata||"{}")}catch(t){console.error("Error parsing metadata from Taipy Designer",t)}}else if("GDT"===t.type){const n=t.payload,s=n.variable,a=n.function;if(e.variableData&&e.functionData){const t=e.variableData.init(s),n=e.functionData.init(a),i=d()(t,n);(t||n)&&e.onReloadEvent(i)}else e.variableData=new c(s),e.functionData=new c(a),e.onInitEvent()}else if("AID"===t.type){const n=t.payload;if("reconnect"===n.name)return e.init(),!0;e.appId=n.id}else if("GR"===t.type){const n=t.payload;e.routes=n}else if("AL"===t.type){const n=t;e.onNotifyEvent(n.atype,n.message)}else if("ACK"===t.type){const{id:n}=t;e._ackList=e._ackList.filter((t=>t!==n)),e.onWsStatusUpdateEvent(e._ackList)}return this.postWsMessageProcessing(t,e),!0}return!1}postWsMessageProcessing(t,e){this.initWsMessageTypes.includes(t.type)&&""!==e.clientId&&""!==e.appId&&""!==e.context&&void 0!==e.routes&&e.sendWsMessage("GDT","get_data_tree",{})}}class u{constructor(t=void 0,e=void 0,n=void 0,s=void 0){s=s||(0,o.io)("/",{autoConnect:!1}),this.onInit=t,this.onChange=e,this.variableData=void 0,this.functionData=void 0,this.clientId="",this.context="",this.metadata={},this.appId="",this.routes=void 0,this.path=n,this.socket=s,this.wsAdapters=[new l],this._ackList=[],((t,e)=>{t.on("connect",(()=>{e.onWsMessageEvent("connect",null),""!==e.clientId&&""!==e.appId||e.init()})),t.io.on("reconnect",(()=>{e.onWsMessageEvent("reconnect",null),console.log("WebSocket reconnected"),e.sendWsMessage("AID","reconnect",e.appId)})),t.on("connect_error",(n=>{e.onWsMessageEvent("connect_error",{err:n}),console.log("Error connecting WebSocket: ",n),setTimeout((()=>{t&&t.connect()}),500)})),t.on("disconnect",((n,s)=>{e.onWsMessageEvent("disconnect",{reason:n,details:s}),console.log("WebSocket disconnected due to: ",n,s),"io server disconnect"===n&&t&&t.connect()})),t.on("message",(t=>{e.onWsMessageEvent("message",t);for(const n of e.wsAdapters)if(n.supportedMessageTypes.includes(t.type)&&n.handleWsMessage(t,e))return})),t.connected||t.connect()})(s,this)}get onInit(){return this._onInit}set onInit(t){if(void 0!==t&&1!==t.length)throw new Error("onInit() requires one parameter");this._onInit=t}onInitEvent(){this.onInit&&this.onInit(this)}get onChange(){return this._onChange}set onChange(t){if(void 0!==t&&3!==t.length)throw new Error("onChange() requires three parameters");this._onChange=t}onChangeEvent(t,e){this.onChange&&this.onChange(this,t,e)}get onNotify(){return this._onNotify}set onNotify(t){if(void 0!==t&&3!==t.length)throw new Error("onNotify() requires three parameters");this._onNotify=t}onNotifyEvent(t,e){this.onNotify&&this.onNotify(this,t,e)}get onReload(){return this._onReload}set onReload(t){if(void 0!==t&&2!==(null==t?void 0:t.length))throw new Error("onReload() requires two parameters");this._onReload=t}onReloadEvent(t){this.onReload&&this.onReload(this,t)}get onWsMessage(){return this._onWsMessage}set onWsMessage(t){if(void 0!==t&&3!==(null==t?void 0:t.length))throw new Error("onWsMessage() requires three parameters");this._onWsMessage=t}onWsMessageEvent(t,e){this.onWsMessage&&this.onWsMessage(this,t,e)}get onWsStatusUpdate(){return this._onWsStatusUpdate}set onWsStatusUpdate(t){if(void 0!==t&&2!==(null==t?void 0:t.length))throw new Error("onWsStatusUpdate() requires two parameters");this._onWsStatusUpdate=t}onWsStatusUpdateEvent(t){this.onWsStatusUpdate&&this.onWsStatusUpdate(this,t)}init(){this.clientId="",this.context="",this.appId="",this.routes=void 0;const t=(t=>{const e=localStorage&&localStorage.getItem(t);return e||""})(a);this.sendWsMessage("ID",a,t),this.sendWsMessage("AID","connect",""),this.sendWsMessage("GR","",""),""!==t&&(this.clientId=t,this.updateContext(this.path))}sendWsMessage(t,e,n,a=void 0){void 0===a&&(a=this.context);const i=((t,e,n,a,i,o="",r=!0,d)=>{const c=(0,s.A)(),h={type:e,name:n,payload:a,propagate:r,client_id:i,ack_id:c,module_context:o};return null==t||t.emit("message",(t=>Object.keys(t||{}).reduce(((e,n)=>(void 0!==t[n]&&(e[n]=t[n]),e)),{}))(h),d),c})(this.socket,t,e,n,this.clientId,a);i&&(this._ackList.push(i),this.onWsStatusUpdateEvent(this._ackList))}registerWsAdapter(t){this.wsAdapters.unshift(t)}getEncodedName(t,e){var n;return null===(n=this.variableData)||void 0===n?void 0:n.getEncodedName(t,e)}getName(t){var e;return null===(e=this.variableData)||void 0===e?void 0:e.getName(t)}get(t){var e;return null===(e=this.variableData)||void 0===e?void 0:e.get(t)}getInfo(t){var e;return null===(e=this.variableData)||void 0===e?void 0:e.getInfo(t)}getDataTree(){var t;return null===(t=this.variableData)||void 0===t?void 0:t.getDataTree()}getAllData(){var t;return null===(t=this.variableData)||void 0===t?void 0:t.getAllData()}getFunctionList(){var t;const e=null===(t=this.functionData)||void 0===t?void 0:t.getDataTree()[this.context];return Object.keys(e||{})}getRoutes(){return this.routes}update(t,e){this.sendWsMessage("U",t,{value:e})}getContext(){return this.context}updateContext(t=""){t&&""!==t||(t=window.location.pathname.slice(1)),this.sendWsMessage("GMC","get_module_context",{path:t||"/"})}trigger(t,e,n={}){n.action=t,this.sendWsMessage("A",e,n)}upload(t,e,n){return((t,e,n,s,a="/taipy-uploads")=>new Promise(((o,r)=>{i.onmessage=t=>{t.data.error?r(t.data.message):t.data.done?o(t.data.message):n(t.data.progress)},i.onerror=t=>r(t),i.postMessage({files:e,uploadUrl:a,varName:t,id:s})})))(t,e,n,this.clientId)}getPageMetadata(){return this.metadata}getWsStatus(){return this._ackList}}const p=(t,e,n,s)=>new u(t,e,n,s),g=u}},n={};function s(t){var a=n[t];if(void 0!==a)return a.exports;var i=n[t]={id:t,loaded:!1,exports:{}};return e[t](i,i.exports,s),i.loaded=!0,i.exports}s.m=e,t=[],s.O=(e,n,a,i)=>{if(!n){var o=1/0;for(h=0;h<t.length;h++){for(var[n,a,i]=t[h],r=!0,d=0;d<n.length;d++)(!1&i||o>=i)&&Object.keys(s.O).every((t=>s.O[t](n[d])))?n.splice(d--,1):(r=!1,i<o&&(o=i));if(r){t.splice(h--,1);var c=a();void 0!==c&&(e=c)}}return e}i=i||0;for(var h=t.length;h>0&&t[h-1][2]>i;h--)t[h]=t[h-1];t[h]=[n,a,i]},s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},s.u=t=>t+".taipy-gui-base.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var a=n.length-1;a>-1&&(!t||!/^http(s?):/.test(t));)t=n[a--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t})(),(()=>{s.b=document.baseURI||self.location.href;var t={685:0};s.O.j=e=>0===t[e];var e=(e,n)=>{var a,i,[o,r,d]=n,c=0;if(o.some((e=>0!==t[e]))){for(a in r)s.o(r,a)&&(s.m[a]=r[a]);if(d)var h=d(s)}for(e&&e(n);c<o.length;c++)i=o[c],s.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return s.O(h)},n=this.webpackChunkTaipyGuiBase=this.webpackChunkTaipyGuiBase||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var a=s.O(void 0,[804],(()=>s(8007)));return s.O(a)})()));