"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6950],{61787:function(n,e,i){var a=i(85034),t=i(70169),s=i(31373),l=i(24246),r=i(83265),o=i(12934);e.Z=function(n){var e=n.title,i=n.tooltip,c=n.children,u=(0,s.Z)(n,["title","tooltip","children"]);return(0,l.jsxs)(r.xuv,(0,t.Z)((0,a.Z)({borderRadius:"md",border:"1px solid",borderColor:"gray.200"},u),{children:[(0,l.jsxs)(r.X6q,{as:"h3",fontSize:"sm",fontWeight:"semibold",color:"gray.700",py:4,px:6,backgroundColor:"gray.50",borderRadius:"md",textAlign:"left",children:[e,i?(0,l.jsx)(r.xvT,{as:"span",mx:1,children:(0,l.jsx)(o.Z,{label:i})}):void 0]}),(0,l.jsx)(r.Kqy,{p:6,spacing:6,children:c})]}))}},36950:function(n,e,i){i.d(e,{Z:function(){return Y}});var a,t,s,l,r,o=i(23842),c=i(85034),u=i(70169),d=i(52050),v=i(85556),g=i(24246),m=i(69883),h=i(83265),x=i(34090),p=i(86677),f=i(27378),j=i(10503),_=i(61787),b=i(56071),y=i(32556),k=i(93677),Z=i(46212),C=i(12934),w=i(61186),N=i(21788),P=i(3204),T=i(60834),z=i(50818),S=i(77802),E=function(n){var e=n.index;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(b.j0,{autoFocus:0!==e,name:"translations.".concat(e,".title"),label:"Title of privacy notice as displayed to user",variant:"stacked"}),(0,g.jsx)(b.Ks,{name:"translations.".concat(e,".description"),label:"Privacy notice displayed to the user",variant:"stacked"})]})},O=function(n){var e=n.index,i=n.name,a=n.isOOB;return(0,g.jsxs)(h.kCb,{direction:"column",gap:6,children:[(0,g.jsxs)(h.X6q,{size:"sm",children:["Edit ",i," translation"]}),a?(0,g.jsx)(z.f,{languageName:i}):null,(0,g.jsx)(E,{index:e})]})},R=function(n){var e=n.translation,i=n.name,a=n.onLanguageDeleted;return(0,g.jsxs)(h.kCb,{gap:2,direction:"row",w:"100%",children:[(0,g.jsx)(h.OK9,{as:h.zxk,variant:"outline",size:"sm",fontWeight:"normal",w:"100%",_selected:{color:"white",bg:"gray.500"},children:i},e.language),a?(0,g.jsx)(h.hU,{"aria-label":"Delete translation",variant:"outline",size:"sm",onClick:function(){return a(e.language)},children:(0,g.jsx)(h.pJl,{boxSize:4})}):null]})},q=function(n){var e,i=n.availableTranslations,a=(0,x.u6)(),t=a.values,s=a.setFieldValue,l=(0,f.useState)(!1),r=l[0],o=l[1],c=(0,f.useState)(!1),u=c[0],d=c[1],v=(0,f.useState)(0),p=v[0],y=v[1],k=(0,S.tB)({api_set:!1}).data,Z=null===k||void 0===k||null===(e=k.plus_consent_settings)||void 0===e?void 0:e.enable_translations,C=(0,j.C)(T.Zp),w=(0,j.C)(T.G1);(0,T.Ah)({page:C,size:w});var N,z=(0,j.C)(T.fJ).slice().sort((function(n,e){return n.name.localeCompare(e.name)})),q=z.filter((function(n){var e;return null===(e=t.translations)||void 0===e?void 0:e.every((function(e){return e.language!==n.id}))})).map((function(n){return{label:n.name,value:n.id}})),F=function(n){var e=t.translations?t.translations.slice().filter((function(e){return e.language!==n})):[],i=p===e.length?e.length-1:p;s("translations",e),y(i)},D=function(n){var e;return null!==(N=null===(e=z.find((function(e){return e.id===n})))||void 0===e?void 0:e.name)&&void 0!==N?N:n};return Z?(0,g.jsx)(_.Z,{title:"Localizations",children:(0,g.jsxs)(h.mQc,{index:p,onChange:function(n){y(n),d(!1)},as:h.Ugi,spacing:8,align:"start",w:"100%",orientation:"vertical",variant:"unstyled",children:[(0,g.jsxs)(h.gCW,{spacing:4,minW:"30%",p:2,children:[(0,g.jsx)(h.tdY,{w:"100%",children:(0,g.jsx)(h.gCW,{spacing:2,w:"100%",p:4,maxH:60,overflow:"scroll",outline:"1px solid",outlineColor:"gray.200",borderRadius:"md",children:t.translations.map((function(n){return(0,g.jsx)(R,{translation:n,name:D(n.language),onLanguageDeleted:F},n.language)}))})}),r?(0,g.jsx)(h.xuv,{w:"full","data-testid":"select-language",children:(0,g.jsx)(m.Z,{chakraStyles:b.hP,size:"sm",options:q,onChange:function(n){return function(n){var e=null===i||void 0===i?void 0:i.find((function(e){return e.language===n}));d(!!e);var a=null!==e&&void 0!==e?e:{language:n,title:"",description:""};y(t.translations.length),s("translations",(0,P.Z)(t.translations).concat([a])),o(!1)}(n.value)},autoFocus:!0,classNamePrefix:"select-language",menuPlacement:"auto"})}):null,!r&&q.length?(0,g.jsx)(h.zxk,{leftIcon:(0,g.jsx)(h.jBn,{boxSize:6}),w:"full",variant:"outline",size:"sm",onClick:function(){return o(!0)},"data-testid":"add-language-btn",children:"Add a language"}):null]}),(0,g.jsx)(h.xuv,{w:"100%",children:(0,g.jsx)(x.F2,{name:"translations",render:function(){return(0,g.jsx)(h.nPR,{w:"100%",children:t.translations.map((function(n,e){return(0,g.jsx)(h.x45,{children:(0,g.jsx)(O,{index:e,name:D(n.language),isOOB:u})},n.language)}))})}})})]})}):(0,g.jsx)(_.Z,{title:"Notice text",children:(0,g.jsx)(E,{index:0})})},F=i(31373),D=i(16310),J=i(98878),L=i(72945),A=i(10439),I=(0,J.Jt)(L.ye),B=(0,J.Jt)(L.B8),M=[{language:A.eU.EN,title:"",description:""}],W={name:"",consent_mechanism:A.J7.OPT_IN,data_uses:[],enforcement_level:A.QT.FRONTEND,disabled:!0,translations:M},K=D.Ry().shape({name:D.Z_().required().label("Title"),consent_mechanism:D.Z_().required().label("Consent mechanism")}),U=i(14441),V=i.n(U),Q=function(n){var e=n.isEditing,i=(0,x.u6)(),a=i.values,t=i.setFieldValue;return(0,f.useEffect)((function(){if(!e){var n=V()(a.name);t("notice_key",n)}}),[a.name,e,t]),(0,g.jsx)(b.j0,{name:"notice_key",label:"Key used in Fides cookie",variant:"stacked"})},G=i(53658),X=function(n){var e=n.regions,i=n.label,a=n.tooltip;return(0,g.jsxs)(h.gCW,{align:"start",children:[(0,g.jsxs)(h.kCb,{align:"start",children:[i?(0,g.jsx)(h.lXp,{htmlFor:"regions",fontSize:"xs",my:0,mr:1,children:i}):null,a?(0,g.jsx)(C.Z,{label:a}):null]}),(0,g.jsx)(h.xuv,{w:"100%","data-testid":"notice-locations",children:(0,g.jsx)(m.Z,{chakraStyles:(0,u.Z)((0,c.Z)({},b.hP),{dropdownIndicator:function(n){return(0,u.Z)((0,c.Z)({},n),{display:"none"})},multiValueRemove:function(n){return(0,u.Z)((0,c.Z)({},n),{display:"none"})}}),classNamePrefix:"notice-locations",size:"sm",isMulti:!0,isDisabled:!0,placeholder:"No locations assigned",value:null!==(r=null===e||void 0===e?void 0:e.map((function(n){return{label:Z.Z8[n],value:n}})))&&void 0!==r?r:[]})})]})},Y=function(n){var e,i=n.privacyNotice,r=n.availableTranslations,m=(0,p.useRouter)(),Z=(0,h.pmc)(),C=i?{name:null!==(a=(e=i).name)&&void 0!==a?a:W.name,consent_mechanism:null!==(t=e.consent_mechanism)&&void 0!==t?t:W.consent_mechanism,data_uses:null!==(s=e.data_uses)&&void 0!==s?s:W.data_uses,enforcement_level:null!==(l=e.enforcement_level)&&void 0!==l?l:W.enforcement_level,notice_key:e.notice_key,disabled:e.disabled,has_gpc_flag:e.has_gpc_flag,id:e.id,internal_description:e.internal_description,translations:e.translations?e.translations.map((function(n){n.privacy_notice_history_id;var e,i=(0,F.Z)(n,["privacy_notice_history_id"]);return(0,u.Z)((0,c.Z)({},i),{title:null!==(e=n.title)&&void 0!==e?e:""})})):M}:W;(0,N.fd)();var P=(0,j.C)(N.qv),T=(0,d.Z)((0,G.vL)(),1)[0],z=(0,d.Z)((0,G.p4)(),1)[0],S=(0,f.useMemo)((function(){return!!i}),[i]),E=function(){var n=(0,o.Z)((function(n){var e,a,t;return(0,v.__generator)(this,(function(s){switch(s.label){case 0:return S?(t=(0,u.Z)((0,c.Z)({},n),{id:i.id,translations:null!==(a=n.translations)&&void 0!==a?a:[]}),[4,T(t)]):[3,2];case 1:return e=s.sent(),[3,4];case 2:return[4,z(n)];case 3:e=s.sent(),s.label=4;case 4:return(0,y.D4)(e)?Z((0,w.Vo)((0,y.e$)(e.error))):(Z((0,w.t5)("Privacy notice ".concat(S?"updated":"created"))),S||m.push(k.IT)),[2]}}))}));return function(e){return n.apply(this,arguments)}}();return(0,g.jsx)(x.J9,{initialValues:C,enableReinitialize:!0,onSubmit:E,validationSchema:K,children:function(n){var e=n.dirty,a=n.isValid,t=n.isSubmitting;return(0,g.jsx)(x.l0,{children:(0,g.jsxs)(h.Kqy,{spacing:10,children:[(0,g.jsxs)(h.Kqy,{spacing:6,children:[(0,g.jsxs)(_.Z,{title:"Privacy notice details",children:[(0,g.jsx)(b.j0,{label:"Notice title",name:"name",isRequired:!0,variant:"stacked"}),(0,g.jsx)(b.AP,{name:"consent_mechanism",label:"Consent mechanism",options:I,isRequired:!0,variant:"stacked"}),(0,g.jsx)(Q,{isEditing:S}),(0,g.jsx)(X,{regions:null===i||void 0===i?void 0:i.configured_regions,label:"Locations where privacy notice is shown to visitors",tooltip:"To configure locations, change the privacy experiences where this notice is shown"}),(0,g.jsx)(b.w8,{name:"has_gpc_flag",label:"Configure whether this notice conforms to the Global Privacy Control",variant:"stacked"}),(0,g.jsx)(b.AP,{name:"data_uses",label:"Data use",options:P,isMulti:!0,variant:"stacked"}),(0,g.jsx)(b.AP,{name:"enforcement_level",label:"Enforcement level",options:B,isRequired:!0,variant:"stacked"})]}),(0,g.jsx)(q,{availableTranslations:r})]}),(0,g.jsxs)(h.hE2,{size:"sm",spacing:2,children:[(0,g.jsx)(h.zxk,{variant:"outline",onClick:function(){m.back()},children:"Cancel"}),(0,g.jsx)(h.zxk,{type:"submit",variant:"primary",size:"sm",isDisabled:t||!e||!a,isLoading:t,"data-testid":"save-btn",children:"Save"})]})]})})}})}},72945:function(n,e,i){i.d(e,{B8:function(){return s},Ep:function(){return l},ye:function(){return t}});var a=i(10439),t=new Map([[a.J7.OPT_IN,"Opt in"],[a.J7.NOTICE_ONLY,"Notice only"],[a.J7.OPT_OUT,"Opt out"]]),s=new Map([[a.QT.SYSTEM_WIDE,"System wide"],[a.QT.FRONTEND,"Front end"],[a.QT.NOT_APPLICABLE,"Not applicable"]]),l=new Map([["gpp_us_national","GPP US National"],["gpp_us_state","GPP US State"]])}}]);