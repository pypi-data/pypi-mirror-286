(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2462],{40135:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/locations",function(){return t(71231)}])},71231:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return M}});var i=t(24246),o=t(83265),r=t(10503),s=t(1496),l=t(23842),a=t(52050),c=t(85556),u=t(98784),d=t.n(u),h=t(86677),f=t(27378),g=t(32556),m=t(49730),p=t(47346),x=t(61186),j=t(34038),v=t(93677),C=t(50267),y=t(85034),S=t(70169),k=t(3204),w=t(8595),Z=t(12934),b=function(e){var n=e.id,t=e.isChecked,r=e.onChange;return(0,i.jsxs)(o.kCb,{alignItems:"center",gap:"8px",children:[(0,i.jsx)(o.rsf,{isChecked:t,size:"sm",onChange:r,colorScheme:"complimentary",id:n,"data-testid":"regulated-toggle"}),(0,i.jsx)(o.lXp,{fontSize:"sm",m:0,htmlFor:n,children:"Regulated"}),(0,i.jsx)(Z.Z,{label:"Toggle on to see only locations in this region with privacy regulations supported by Fides"})]})},_=t(52300),O=t(22938),E=t(77278),z=function(e){var n=e.groups,t=e.locations,r=e.isOpen,s=e.onClose,l=e.selected,c=e.onChange,u=(0,f.useState)(l),d=u[0],h=u[1],g=(0,f.useState)(!1),m=g[0],p=g[1],x=(0,f.useMemo)((function(){var e=m?t.filter((function(e){var n;return null===(n=e.regulation)||void 0===n?void 0:n.length})):t;return{locationsByGroup:(0,E.VT)(e),filteredLocations:e}}),[t,m]),j=x.filteredLocations,v=x.locationsByGroup,C=(0,_.QZ)({items:j,selected:d,onChange:h}),y=C.allSelected,S=C.handleToggleAll,k=C.handleToggleSelection,w=d.filter((function(e){return!Object.keys(v).includes(e)})).length,Z=t[0].continent,z=Object.keys(v),L=!(1===z.length&&"Other"===z[0]);return(0,i.jsxs)(o.u_l,{size:"2xl",isOpen:r,onClose:s,isCentered:!0,children:[(0,i.jsx)(o.ZAr,{}),(0,i.jsxs)(o.hzk,{"data-testid":"subgroup-modal",children:[(0,i.jsx)(O.h4,{title:"Select locations"}),(0,i.jsxs)(o.fef,{p:6,maxHeight:"70vh",overflowY:"auto",children:[(0,i.jsx)(O.x$,{title:Z,allSelected:y,onToggleAll:S,numSelected:w,children:(0,i.jsx)(b,{id:"".concat(Z,"-modal-regulated"),isChecked:m,onChange:function(){return p(!m)}})}),L?(0,i.jsx)(o.UQy,{allowToggle:!0,allowMultiple:!0,children:Object.entries(v).map((function(e){var t=(0,a.Z)(e,2),r=t[0],s=t[1],l=n.find((function(e){return r===e.id})),c=l?l.name:r;return(0,i.jsxs)(o.Qdk,{"data-testid":"".concat(c,"-accordion"),children:[(0,i.jsx)("h2",{children:(0,i.jsxs)(o.KFZ,{children:[(0,i.jsx)(o.xuv,{as:"span",flex:"1",textAlign:"left",fontWeight:"semibold",fontSize:"sm",children:c}),(0,i.jsx)(o.XEm,{})]})}),(0,i.jsx)(o.Hk3,{pb:4,children:(0,i.jsx)(o.MIq,{columns:3,spacing:6,children:s.map((function(e){return(0,i.jsx)(o.XZJ,{size:"sm",colorScheme:"complimentary",isChecked:d.includes(e.id),onChange:function(){return k(e.id)},"data-testid":"".concat(e.name,"-checkbox"),children:e.name},e.id)}))})})]},r)}))}):(0,i.jsx)(o.MIq,{columns:3,spacing:6,paddingInline:4,children:j.map((function(e){return(0,i.jsx)(o.XZJ,{size:"sm",colorScheme:"complimentary",isChecked:d.includes(e.id),onChange:function(){return k(e.id)},"data-testid":"".concat(e.name,"-checkbox"),children:e.name},e.id)}))})]}),(0,i.jsx)(O.$_,{onApply:function(){var e=new Set(d);Object.entries(v).forEach((function(n){var t=(0,a.Z)(n,2),i=t[0];t[1].every((function(e){return d.includes(e.id)}))?e.add(i):e.delete(i)})),c(Array.from(e)),s()},onClose:s})]})]})},L=function(e){var n=e.title,t=e.groups,r=e.locations,s=e.selected,l=e.onChange,a=e.search,c=(0,o.qY0)(),u=(0,f.useState)(!1),d=u[0],h=u[1],g=!!(null===a||void 0===a?void 0:a.length),m=t.length>0,p=r;t.length&&(p=t),g&&(p=(0,k.Z)(r).concat((0,k.Z)(t)).sort((function(e,n){return e.name.localeCompare(n.name)})));var x=d?p.filter((function(e){return(0,E.$q)(e,r)})):p,j=a?x.filter((function(e){return function(e,n){var t;return null===(t=e.name)||void 0===t?void 0:t.toLocaleLowerCase().includes(n.toLocaleLowerCase())}(e,a)})):x,v=t.filter((function(e){return"checked"===(0,E.ji)({group:e,selected:s,locations:r})})).map((function(e){return e.id})),C=t.filter((function(e){return"indeterminate"===(0,E.ji)({group:e,selected:s,locations:r})})).map((function(e){return e.id})),Z=m?(0,k.Z)(v).concat((0,k.Z)(s)):s,_=s.length,O=function(e){var n=r.map((function(n){return e.includes(n.id)?(0,S.Z)((0,y.Z)({},n),{selected:!0}):(0,S.Z)((0,y.Z)({},n),{selected:!1})}));l(n)};return 0===j.length&&a?null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(w.ZP,{title:n,items:j,selected:Z,indeterminate:m?C:[],onChange:function(e){var n=new Set(e),i=new Set(Z);e.forEach((function(e){i.has(e)||t.find((function(n){return n.id===e}))&&r.filter((function(n){var t;return null===(t=n.belongs_to)||void 0===t?void 0:t.includes(e)})).forEach((function(e){n.add(e.id)}))})),i.forEach((function(e){n.has(e)||t.find((function(n){return n.id===e}))&&r.filter((function(n){var t;return null===(t=n.belongs_to)||void 0===t?void 0:t.includes(e)})).forEach((function(e){n.delete(e.id)}))})),O(Array.from(n))},onViewMore:function(){c.onOpen()},numSelected:_,toggle:(0,i.jsx)(b,{id:"".concat(n,"-regulated"),isChecked:d,onChange:function(){return h(!d)}})}),(0,i.jsx)(z,{groups:t,locations:r,isOpen:c.isOpen,onClose:c.onClose,selected:s,onChange:O},"subgroup-modal-selected-".concat(Z.length))]})},T=t(96951),A=function(e){var n,t=e.data,r=(0,o.pmc)(),s=(0,o.qY0)(),u=(0,f.useState)(null!==(n=t.locations)&&void 0!==n?n:[]),y=u[0],S=u[1],k=(0,f.useState)(""),w=k[0],Z=k[1],b=(0,a.Z)((0,T.WA)(),2),_=b[0],O=b[1].isLoading,z=(0,f.useMemo)((function(){return(0,E.Il)(t.locations||[],t.location_groups||[])}),[t]),A=!d().isEqual(y,t.locations),M=(0,h.useRouter)(),q=function(){M.push(v.vY).then((function(){r.closeAll()}))},F=function(){var e=(0,l.Z)((function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return[4,_({locations:y.map((function(e){return{id:e.id,selected:e.selected}})),regulations:[]})];case 1:return e=n.sent(),(0,j.D4)(e)?r((0,x.Vo)((0,g.e$)(e.error))):r((0,x.t5)((0,i.jsxs)(o.xvT,{display:"inline",children:["Fides has automatically associated the relevant regulations with your location choices."," ",(0,i.jsx)(C.Z,{onClick:q,children:"View regulations here."})]}))),[2]}}))}));return function(){return e.apply(this,arguments)}}(),I=function(e){var n=y.map((function(n){var t=e.find((function(e){return e.id===n.id}));return null!==t&&void 0!==t?t:n}));S(n)};return(0,i.jsxs)(o.gCW,{alignItems:"start",spacing:4,children:[(0,i.jsx)(o.xuv,{maxWidth:"510px",width:"100%",children:(0,i.jsx)(p.Z,{onChange:Z,placeholder:"Search",search:w,onClear:function(){return Z("")},"data-testid":"search-bar"})}),(0,i.jsx)(o.MIq,{columns:{base:1,md:2,xl:3},spacing:6,width:"100%",children:Object.entries(z).map((function(e){var n=(0,a.Z)(e,2),t=n[0],o=n[1];return(0,i.jsx)(L,{title:t,groups:o.locationGroups,locations:o.locations,selected:y.filter((function(e){return o.locations.find((function(n){return n.id===e.id}))&&e.selected})).map((function(e){return e.id})),onChange:I,search:w},t)}))}),(0,i.jsx)(m.Z,{isOpen:s.isOpen,onClose:s.onClose,onConfirm:function(){F(),s.onClose()},title:"Regulation updates",message:"Modifications in your location settings may also affect your regulation settings to simplify management. You can override any Fides-initiated changes directly in the regulation settings.",isCentered:!0,icon:(0,i.jsx)(o.aNP,{color:"orange"})}),A?(0,i.jsx)(o.zxk,{colorScheme:"primary",size:"sm",onClick:s.onOpen,isLoading:O,"data-testid":"save-btn",children:"Save"}):null]})},M=function(){var e=(0,T.QM)().isLoading,n=(0,r.C)(T.P8);return(0,i.jsx)(s.Z,{title:"Locations",children:(0,i.jsxs)(o.xuv,{"data-testid":"location-management",children:[(0,i.jsx)(o.X6q,{marginBottom:2,fontSize:"2xl",children:"Locations"}),(0,i.jsxs)(o.xuv,{children:[(0,i.jsx)(o.xvT,{marginBottom:4,fontSize:"sm",maxWidth:"720px",children:"Select the locations that you operate in and Fides will make sure that you are automatically presented with the relevant regulatory guidelines and global frameworks for your locations."}),(0,i.jsx)(o.xuv,{children:e?(0,i.jsx)(o.$jN,{}):(0,i.jsx)(A,{data:n})})]})]})})}}},function(e){e.O(0,[8033,4880,9774,2888,179],(function(){return n=40135,e(e.s=n);var n}));var n=e.O();_N_E=n}]);