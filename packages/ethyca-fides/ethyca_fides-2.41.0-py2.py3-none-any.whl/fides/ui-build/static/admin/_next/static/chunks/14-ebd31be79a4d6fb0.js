"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[14],{83403:function(e,n,i){var a=i(24246),t=i(83265);n.Z=function(e){var n=e.title,i=e.children,s=e.isOpen,r=e.onClose;return(0,a.jsxs)(t.u_l,{isOpen:s,onClose:r,isCentered:!0,scrollBehavior:"inside",size:"xl",children:[(0,a.jsx)(t.ZAr,{}),(0,a.jsxs)(t.hzk,{textAlign:"left",p:0,"data-testid":"add-modal-content",children:[(0,a.jsx)(t.xBx,{p:0,children:(0,a.jsx)(t.xuv,{backgroundColor:"gray.50",px:6,py:4,border:"1px",borderColor:"gray.200",borderTopRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center",children:(0,a.jsx)(t.X6q,{as:"h3",size:"sm",children:n})})}),(0,a.jsx)(t.fef,{pb:4,overflow:"scroll",children:i})]})]})}},70014:function(e,n,i){i.d(n,{Z:function(){return R}});var a=i(23842),t=i(85034),s=i(70169),r=i(31373),o=i(52050),c=i(85556),d=i(24246),l=i(83265),u=i(34090),p=i(27378),v=i(16310),m=i(10503),f=i(67447),g=i(56071),_=i(52929),h=i(94353),y=i(12062),x=i(56241),b=i(28495),k=i(29389),C=i(32556),j=i(61186),Z=i(83403),V={name:"",consent_use:"",data_use:"",data_categories:["user"],cookieNames:[],cookies:[]},z=[{label:"Analytics",value:"analytics",description:"Provides analytics for activities such as system and advertising performance reporting, insights and fraud detection."},{label:"Essential",value:"essential",description:"Operates the service or product, including legal obligations, support and basic system operations."},{label:"Functional",value:"functional",description:"Used for specific, necessary, and legitimate purposes."},{label:"Marketing",value:"marketing",description:"Enables marketing, promotion, advertising and sales activities for the product, service, application or system."}],S=i(21788),w=i(62718),N=function(e){var n=e.index,i=e.isSuggestion,a=e.disabled;(0,S.fd)();var t=(0,m.C)(S.oW),s=i?"complimentary.500":"gray.800",r=(0,u.u6)().values,o=t.filter((function(e){return e.value.split(".")[0]===r.privacy_declarations[n].consent_use}));return(0,d.jsxs)(l.gCW,{width:"100%",borderRadius:"4px",border:"1px solid",borderColor:"gray.200",spacing:4,p:4,children:[(0,d.jsx)(g.AP,{label:"Consent category",tooltip:"What is the system using the data for. For example, is it for third party advertising or perhaps simply providing system operations.",name:"privacy_declarations.".concat(n,".consent_use"),options:z,variant:"stacked",isRequired:!0,isCustomOption:!0,singleValueBlock:!0,textColor:s,isDisabled:a}),(0,d.jsx)(g.AP,{label:"Detailed consent category (optional)",tooltip:"Select a more specific consent category",name:"privacy_declarations.".concat(n,".data_use"),options:o,variant:"stacked",isCustomOption:!0,singleValueBlock:!0,textColor:s,isDisabled:!r.privacy_declarations[n].consent_use||a}),(0,d.jsx)(g.VT,{label:"Cookie names",name:"privacy_declarations.".concat(n,".cookieNames"),options:[],variant:"stacked",isMulti:!0,textColor:s,isDisabled:a})]})},E=function(e){var n,i,a=e.showSuggestions,t=e.isCreate,s=e.disabled,r=(0,u.u6)(),o=r.values,c=r.setFieldValue,v=o.vendor_id,f=(0,h.Wp)({vendor_id:v},{skip:!a||null==v}).isLoading,g=(0,m.C)((0,h.cL)(v||""));(0,p.useEffect)((function(){if(a&&o.vendor_id&&(null===g||void 0===g?void 0:g.length)){var e,n,i=g.filter((function(e){return n=e.data_use,z.some((function(e){return e.value===n.split(".")[0]}));var n})).map((function(e){return(0,w.U)(e)})).map((function(i){var a;return{name:null!==(e=i.name)&&void 0!==e?e:"",consent_use:i.data_use.split(".")[0],data_use:i.data_use,data_categories:i.data_categories,cookieNames:(null===(a=i.cookies)||void 0===a?void 0:a.map((function(e){return e.name})))||[],cookies:null!==(n=i.cookies)&&void 0!==n?n:[]}}));c("privacy_declarations",i)}else t&&c("privacy_declarations",[V])}),[a,t,o.vendor_id,g,c]);var _=(null===(n=o.privacy_declarations[o.privacy_declarations.length-1])||void 0===n?void 0:n.data_use)===V.data_use&&(null===(i=o.privacy_declarations[o.privacy_declarations.length-1])||void 0===i?void 0:i.consent_use)===V.consent_use;return f?(0,d.jsx)(l.$jN,{size:"sm",alignSelf:"center"}):(0,d.jsx)(u.F2,{name:"privacy_declarations",render:function(e){return(0,d.jsxs)(d.Fragment,{children:[o.privacy_declarations.map((function(e,n){return(0,d.jsx)(N,{index:n,disabled:s,isSuggestion:a},e.data_use||n)})),(0,d.jsx)(l.zxk,{size:"xs",variant:"ghost",colorScheme:"complimentary",onClick:function(){e.push(V)},isDisabled:_||s,"data-testid":"add-data-use-btn",children:"Add data use +"})]})}})},F={name:"",vendor_id:void 0,privacy_declarations:[V]},R=function(e){var n=e.buttonLabel,i=e.buttonVariant,z=void 0===i?"primary":i,S=e.onButtonClick,w=(0,l.pmc)(),N=(0,l.qY0)(),R=N.isOpen,q=N.onOpen,D=N.onClose,O=(0,m.T)(),A=(0,m.C)(y.cS),L=(0,p.useMemo)((function(){return v.Ry().shape({name:v.Z_().required().label("Vendor name").test("is-unique","",(function(e,n){return!A.map((function(e){return e.name})).some((function(n){return n===e}))||n.createError({message:'You already have a vendor called "'.concat(e,'". Please specify a unique name for this vendor.')})}))})}),[A]),W=(0,f.hz)(),B=W.tcf,M=W.dictionaryService,P=(0,h.Rd)(void 0,{skip:!M}).isLoading,Q=(0,m.C)(h.o),G=(0,m.C)(x.gU),T=(0,o.Z)((0,y.f7)(),1)[0],U=(0,m.C)(x.bN),$=function(){D(),O((0,x.b3)("initial")),O((0,x.gQ)(!1))},I=(0,p.useRef)(null),Y=I.current?I.current.values.vendor_id:void 0,J=(0,m.C)((0,h.$e)(Y||"")),X=function(){var e=(0,a.Z)((function(e,n){var i,a,o;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return i=e.privacy_declarations.filter((function(e){return e.consent_use!==V.consent_use})).flatMap((function(e){var n=e.cookieNames.map((function(n){var i=e.cookies.find((function(e){return e.name===n}));return null!==i&&void 0!==i?i:{name:n,path:"/"}})),i=(e.cookieNames,e.consent_use,(0,r.Z)(e,["cookieNames","consent_use"]));return"marketing"!==e.consent_use||e.data_use?(0,s.Z)((0,t.Z)({},i),{data_use:e.data_use?e.data_use:e.consent_use,cookies:n}):["marketing.advertising.first_party.targeted","marketing.advertising.third_party.targeted"].map((function(e){return(0,s.Z)((0,t.Z)({},i),{data_use:e,cookies:n})}))})),a=(0,s.Z)((0,t.Z)({},J,e),{fides_key:(0,_.E)(e.name),system_type:"",privacy_declarations:i}),[4,T(a)];case 1:return o=c.sent(),(0,C.D4)(o)?(w((0,j.Vo)((0,C.e$)(o.error))),[2]):(w((0,j.t5)("Vendor successfully created!")),n.resetForm(),$(),[2])}}))}));return function(n,i){return e.apply(this,arguments)}}(),H=function(e){if(M){if(!e)return O((0,x.b3)("hiding")),void O((0,x.gQ)(!1));O((0,x.b3)("showing")),B&&(0,C.cj)(e)===C.c6.GVL?O((0,x.gQ)(!0)):O((0,x.gQ)(!1))}},K="primary"===z?{size:"sm",colorScheme:"primary"}:{size:"xs",variant:"outline"};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(l.zxk,(0,s.Z)((0,t.Z)({onClick:function(){S?S():q()},"data-testid":"add-vendor-btn"},K),{children:n})),(0,d.jsx)(u.J9,{initialValues:F,enableReinitialize:!0,onSubmit:X,validationSchema:L,innerRef:I,children:function(e){var n=e.dirty,i=e.isValid,a=e.resetForm;return(0,d.jsx)(Z.Z,{isOpen:R,onClose:$,title:"Add a vendor",children:(0,d.jsxs)(l.xuv,{"data-testid":"add-vendor-modal-content",my:4,children:[G?(0,d.jsx)(b.Z,{}):null,(0,d.jsx)(u.l0,{children:(0,d.jsxs)(l.gCW,{alignItems:"start",spacing:6,children:[M?(0,d.jsx)(k.Z,{label:"Vendor name",options:Q,onVendorSelected:H,isCreate:!0,lockedForGVL:G}):(0,d.jsx)(g.j0,{id:"name",name:"name",isRequired:!0,label:"Vendor name",tooltip:"Give the system a unique, and relevant name for reporting purposes. e.g. \u201cEmail Data Warehouse\u201d",variant:"stacked"}),(0,d.jsx)(E,{showSuggestions:"showing"===U,isCreate:!0,disabled:G}),(0,d.jsxs)(l.hE2,{size:"sm",width:"100%",justifyContent:"space-between",children:[(0,d.jsx)(l.zxk,{variant:"outline",onClick:function(){$(),a()},children:"Cancel"}),(0,d.jsx)(l.zxk,{type:"submit",variant:"primary",isDisabled:P||!n||!i,isLoading:P,"data-testid":"save-btn",children:"Save vendor"})]})]})})]})})}})]})}}}]);