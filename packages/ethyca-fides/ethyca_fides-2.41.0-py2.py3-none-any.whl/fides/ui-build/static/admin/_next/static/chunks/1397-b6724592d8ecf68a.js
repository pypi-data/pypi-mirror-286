"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1397],{1496:function(e,n,i){i.d(n,{Z:function(){return p}});var t=i(85034),r=i(70169),s=i(24246),a=i(83265),o=i(88038),c=i.n(o),l=i(86677),d=(i(27378),i(67447)),u=i(63076),h=i(93677),f=function(){var e=(0,l.useRouter)();return(0,s.jsx)(a.xuv,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,s.jsxs)(a.xuv,{children:[(0,s.jsxs)(a.Kqy,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,s.jsx)(a.xvT,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,s.jsx)(a.zxk,{size:"sm",variant:"outline",onClick:function(){e.push(h.fz)},children:"Configure"})]}),(0,s.jsxs)(a.xvT,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},p=function(e){var n=e.children,i=e.title,o=e.padded,h=void 0===o||o,p=e.mainProps,x=(0,d.hz)(),m=(0,l.useRouter)(),v="/privacy-requests"===m.pathname||"/datastore-connection"===m.pathname,g=!(x.flags.privacyRequestsConfiguration&&v),j=(0,u.JE)(void 0,{skip:g}).data,y=(0,u.PW)(void 0,{skip:g}).data,b=x.flags.privacyRequestsConfiguration&&(!j||!y)&&v;return(0,s.jsxs)(a.kCb,{"data-testid":i,direction:"column",h:"100vh",children:[(0,s.jsxs)(c(),{children:[(0,s.jsxs)("title",{children:["Fides Admin UI - ",i]}),(0,s.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)(a.kCb,(0,r.Z)((0,t.Z)({as:"main",direction:"column",py:h?6:0,px:h?10:0,h:h?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto"},p),{children:[b?(0,s.jsx)(f,{}):null,n]}))]})}},23027:function(e,n,i){i.d(n,{HK:function(){return s},VY:function(){return t.V},O3:function(){return o}});var t=i(95389),r=i(32556),s=function(){var e=(0,t.V)().errorAlert;return{handleError:function(n){var i="An unexpected error occurred. Please try again.";(0,r.Ot)(n)?i=n.data.detail:(0,r.tB)(n)&&(i=n.data.detail[0].msg),e(i)}}},a=i(27378),o=function(e){var n=(0,a.useRef)(void 0);return(0,a.useEffect)((function(){var i=function(i){var t;(null===(t=n.current)||void 0===t?void 0:t.contains(i.target))||e()};return document.addEventListener("mousedown",i),function(){document.removeEventListener("mousedown",i)}}),[n,e]),{ref:n}}},95389:function(e,n,i){i.d(n,{V:function(){return o}});var t=i(85034),r=i(70169),s=i(24246),a=i(83265),o=function(){var e=(0,a.pmc)();return{errorAlert:function(n,i,o){var c=(0,r.Z)((0,t.Z)({},o),{position:(null===o||void 0===o?void 0:o.position)||"top",render:function(e){var t=e.onClose;return(0,s.jsxs)(a.bZj,{alignItems:"normal",status:"error",children:[(0,s.jsx)(a.zMQ,{}),(0,s.jsxs)(a.xuv,{children:[i&&(0,s.jsx)(a.CdC,{children:i}),(0,s.jsx)(a.XaZ,{children:n})]}),(0,s.jsx)(a.PZ7,{onClick:t,position:"relative",right:0,size:"sm",top:-1})]})}});(null===o||void 0===o?void 0:o.id)&&e.isActive(o.id)?e.update(o.id,c):e(c)},successAlert:function(n,i,o){var c=(0,r.Z)((0,t.Z)({},o),{position:(null===o||void 0===o?void 0:o.position)||"top",render:function(e){var t=e.onClose;return(0,s.jsxs)(a.bZj,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,s.jsx)(a.zMQ,{}),(0,s.jsxs)(a.xuv,{children:[i&&(0,s.jsx)(a.CdC,{children:i}),(0,s.jsx)(a.XaZ,{children:n})]}),(0,s.jsx)(a.PZ7,{onClick:t,position:"relative",right:0,size:"sm",top:-1})]})}});(null===o||void 0===o?void 0:o.id)&&e.isActive(o.id)?e.update(o.id,c):e(c)}}}},22850:function(e,n,i){i.d(n,{R:function(){return d}});var t=i(85034),r=i(70169),s=i(31373),a=i(24246),o=i(83265),c=i(79894),l=i.n(c),d=function(e){var n=e.onClick,i=(0,s.Z)(e,["onClick"]);return(0,a.jsxs)(o.kCb,(0,r.Z)((0,t.Z)({alignItems:"center",mt:-4,mb:3,onClick:n,cursor:"pointer"},i),{children:[(0,a.jsx)(o.hU,{"aria-label":"Back",icon:(0,a.jsx)(o.Rpv,{}),mr:2,size:"xs",variant:"outline"}),(0,a.jsx)(o.xvT,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})]}))};n.Z=function(e){var n=e.backPath,i=(0,s.Z)(e,["backPath"]);return(0,a.jsxs)(o.kCb,(0,r.Z)((0,t.Z)({alignItems:"center",mb:6},i),{children:[(0,a.jsx)(l(),{href:n,passHref:!0,children:(0,a.jsx)(o.hU,{"aria-label":"Back",icon:(0,a.jsx)(o.Rpv,{}),mr:2,size:"xs",variant:"outline"})}),(0,a.jsx)(l(),{href:n,passHref:!0,children:(0,a.jsx)(o.xvT,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})})]}))}},1268:function(e,n,i){var t=i(24246),r=(i(27378),i(1496));n.Z=function(e){var n=e.children;return(0,t.jsx)(r.Z,{title:"Connections",children:n})}},61456:function(e,n,i){i.d(n,{s:function(){return L}});var t=i(24246),r=i(53178),s=i(83265),a=i(86677),o=i(27378),c=i(10503),l=i(93677),d=i(10439),u=i(23842),h=i(52050),f=i(85556),p=i(23027),x=i(95389),m=i(1977),v=i(45007),g=i(85034),j=i(70169),y=i(34090),b="#/definitions/FidesDatasetReference",C=function(e){var n=e.data,i=e.defaultValues,a=e.isSubmitting,l=void 0!==a&&a,x=e.onSaveClick,v=e.onTestConnectionClick,C=e.testButtonLabel,k=void 0===C?"Test connection":C,_=(0,o.useRef)(!1),S=(0,p.HK)().handleError,Z=(0,c.C)(r.ZZ),w=Z.connection,z=Z.connectionOption,I=(0,h.Z)((0,m.h2)(),2),R=I[0],T=I[1],E=function(e){var n;return"undefined"!==typeof e&&""!==e||(n="Connection Identifier is required"),e&&(0,s.kEn)(e)&&(n="Connection Identifier must be an alphanumeric value"),n},A=function(e,n,i){var t;("undefined"!==typeof n&&""!==n||(t="".concat(e," is required")),i===b)&&(n.includes(".")?n.split(".").length<3&&(t="Dataset reference must include at least three parts"):t="Dataset reference must be dot delimited");return t},O=function(e,n){return(0,t.jsx)(s.lXp,{color:"gray.900",fontSize:"14px",fontWeight:"semibold",htmlFor:e,minWidth:"150px",children:n})},F=function(e){var n;if((null===(n=e.allOf)||void 0===n?void 0:n[0].$ref)===b)return"Enter dataset.collection.field"},L=function(){var e=(0,u.Z)((function(){var e;return(0,f.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,R(w.key).unwrap()];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),S(e),[3,3];case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){return _.current=!0,T.isSuccess&&v(T),function(){_.current=!1}}),[v,T]),(0,t.jsx)(y.J9,{enableReinitialize:!0,initialValues:function(){var e,t,r=(0,g.Z)({},i);(null===w||void 0===w?void 0:w.key)&&(r.name=null!==(t=w.name)&&void 0!==t?t:"",r.description=w.description,r.instance_key=w.connection_type===d.Rj.SAAS?null===(e=w.saas_config)||void 0===e?void 0:e.fides_key:w.key);return function(e,n){var i=(0,g.Z)({},e);return Object.entries(n.properties).forEach((function(n){var t=(0,h.Z)(n,2),r=t[0],s=t[1];if("integer"===s.type){var a=s.default?Number(s.default):e[r];i[r]=a||0}else{var o,c=null!==(o=s.default)&&void 0!==o?o:e[r];i[r]=null!==c&&void 0!==c?c:null}})),i}(r,n)}(),onSubmit:function(e,i){var t=(0,g.Z)({},e);Object.keys(n.properties).forEach((function(i){var r;if((null===(r=n.properties[i].allOf)||void 0===r?void 0:r[0].$ref)===b){var s=e[i].split(".");t[i]={dataset:s.shift(),field:s.join("."),direction:"from"}}})),x(t,i)},validateOnBlur:!1,validateOnChange:!1,children:function(e){return(0,t.jsx)(y.l0,{noValidate:!0,children:(0,t.jsxs)(s.gCW,{align:"stretch",gap:"16px",children:[(0,t.jsx)(y.gN,{id:"name",name:"name",validate:function(e){return A("Name",e)},children:function(n){var i=n.field;return(0,t.jsxs)(s.NIc,{display:"flex",isRequired:!0,isInvalid:e.errors.name&&e.touched.name,children:[O("name","Name"),(0,t.jsxs)(s.gCW,{align:"flex-start",w:"inherit",children:[(0,t.jsx)(s.IIB,(0,j.Z)((0,g.Z)({},i),{autoComplete:"off",autoFocus:!0,color:"gray.700",placeholder:"Enter a friendly name for your new ".concat(z.human_readable," connection"),size:"sm","data-testid":"input-name"})),(0,t.jsx)(s.J1D,{children:e.errors.name})]}),(0,t.jsx)(s.kCb,{alignItems:"center",h:"32px",visibility:"hidden",children:(0,t.jsx)(s.ITP,{marginLeft:"8px"})})]})}}),(0,t.jsx)(y.gN,{id:"description",name:"description",children:function(e){var n=e.field;return(0,t.jsxs)(s.NIc,{display:"flex",children:[O("description","Description"),(0,t.jsx)(s.gxH,(0,j.Z)((0,g.Z)({},n),{color:"gray.700",placeholder:"Enter a description for your new ".concat(z.human_readable," connection"),resize:"none",size:"sm",value:n.value||""})),(0,t.jsx)(s.kCb,{alignItems:"center",h:"32px",visibility:"hidden",children:(0,t.jsx)(s.ITP,{marginLeft:"8px"})})]})}}),(0,t.jsx)(y.gN,{id:"instance_key",name:"instance_key",validate:E,children:function(n){var i=n.field;return(0,t.jsxs)(s.NIc,{display:"flex",isRequired:!0,isInvalid:e.errors.instance_key&&e.touched.instance_key,children:[O("instance_key","Connection Identifier"),(0,t.jsxs)(s.gCW,{align:"flex-start",w:"inherit",children:[(0,t.jsx)(s.IIB,(0,j.Z)((0,g.Z)({},i),{autoComplete:"off",color:"gray.700",isDisabled:!!(null===w||void 0===w?void 0:w.key),placeholder:"A unique identifier for your new ".concat(z.human_readable," connection"),size:"sm"})),(0,t.jsx)(s.J1D,{children:e.errors.instance_key})]}),(0,t.jsx)(s.ua7,{"aria-label":"The fides_key will allow fidesops to associate dataset field references appropriately. Must be a unique alphanumeric value with no spaces (underscores allowed) to represent this connection.",hasArrow:!0,label:"The fides_key will allow fidesops to associate dataset field references appropriately. Must be a unique alphanumeric value with no spaces (underscores allowed) to represent this connection.",placement:"right-start",openDelay:500,children:(0,t.jsx)(s.kCb,{alignItems:"center",h:"32px",children:(0,t.jsx)(s.ITP,{marginLeft:"8px",_hover:{cursor:"pointer"}})})})]})}}),Object.entries(n.properties).map((function(e){var i=(0,h.Z)(e,2),r=i[0],a=i[1];return"advanced_settings"===r?null:function(e,i){var r;return(0,t.jsx)(y.gN,{id:e,name:e,validate:!(!(null===(r=n.required)||void 0===r?void 0:r.includes(e))&&"integer"!==i.type)&&function(e){var n;return A(i.title,e,null===(n=i.allOf)||void 0===n?void 0:n[0].$ref)},children:function(r){var a,o=r.field,c=r.form;return(0,t.jsxs)(s.NIc,{display:"flex",isRequired:null===(a=n.required)||void 0===a?void 0:a.includes(e),isInvalid:c.errors[e]&&c.touched[e],children:[O(e,i.title),(0,t.jsxs)(s.gCW,{align:"flex-start",w:"inherit",children:["integer"!==i.type&&(0,t.jsx)(s.IIB,(0,j.Z)((0,g.Z)({},o),{value:o.value||"",placeholder:F(i),autoComplete:"off",color:"gray.700",size:"sm"})),"integer"===i.type&&(0,t.jsxs)(s.Y2U,{allowMouseWheel:!0,color:"gray.700",defaultValue:0,min:0,size:"sm",children:[(0,t.jsx)(s.zuI,(0,j.Z)((0,g.Z)({},o),{autoComplete:"off"})),(0,t.jsxs)(s.FiK,{children:[(0,t.jsx)(s.WQu,{}),(0,t.jsx)(s.Y_d,{})]})]}),(0,t.jsx)(s.J1D,{children:c.errors[e]})]}),(0,t.jsx)(s.ua7,{"aria-label":i.description,hasArrow:!0,label:i.description,placement:"right-start",openDelay:500,children:(0,t.jsx)(s.kCb,{alignItems:"center",h:"32px",visibility:i.description?"visible":"hidden",children:(0,t.jsx)(s.ITP,{marginLeft:"8px",_hover:{cursor:"pointer"}})})})]})}},e)}(r,a)})),(0,t.jsxs)(s.hE2,{size:"sm",spacing:"8px",variant:"outline",children:[(0,t.jsx)(s.zxk,{colorScheme:"gray.700",isDisabled:!(null===w||void 0===w?void 0:w.key),isLoading:T.isLoading||T.isFetching,loadingText:"Testing",onClick:L,variant:"outline",children:k}),(0,t.jsx)(s.zxk,{bg:"primary.800",color:"white",isDisabled:l,isLoading:l,loadingText:"Submitting",size:"sm",variant:"solid",type:"submit",_active:{bg:"primary.500"},_disabled:{opacity:"inherit"},_hover:{bg:"primary.400"},children:"Save"})]})]})})}})},k=i(81881),_=function(e){var n=e.onConnectionCreated,i=e.data,s=(0,v.I0)(),a=(0,x.V)(),l=a.errorAlert,g=a.successAlert,j=(0,p.HK)().handleError,y=(0,o.useState)(!1),b=y[0],C=y[1],_=(0,c.C)(r.ZZ),S=_.connection,Z=_.connectionOption,w=(0,h.Z)((0,m.pH)(),1)[0],z=(0,h.Z)((0,m.Du)(),1)[0],I=function(){var e=(0,u.Z)((function(e){var a,o,c,u,h,p;return(0,f.__generator)(this,(function(f){switch(f.label){case 0:return f.trys.push([0,5,6,7]),C(!0),o={access:d.uv.WRITE,connection_type:null===Z||void 0===Z?void 0:Z.identifier,description:e.description,disabled:!1,key:(0,k.E)(e.instance_key),name:e.name},[4,w(o).unwrap()];case 1:return c=f.sent(),(null===(a=c.failed)||void 0===a?void 0:a.length)>0?(l(c.failed[0].message),[3,4]):[3,2];case 2:return u={connection_key:c.succeeded[0].key,secrets:{}},Object.entries(i.properties).forEach((function(n){u.secrets[n[0]]=e[n[0]]})),[4,z(u).unwrap()];case 3:"failed"===(h=f.sent()).test_status?l((0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("b",{children:"Message:"})," ",h.msg,(0,t.jsx)("br",{}),(0,t.jsx)("b",{children:"Failure Reason:"})," ",h.failure_reason]})):(s((0,r.lm)(c.succeeded[0])),g("Connector successfully ".concat((null===S||void 0===S?void 0:S.key)?"updated":"added","!")),!(null===S||void 0===S?void 0:S.key)&&n&&n()),f.label=4;case 4:return[3,7];case 5:return p=f.sent(),j(p),[3,7];case 6:return C(!1),[7];case 7:return[2]}}))}));return function(n){return e.apply(this,arguments)}}();return{isSubmitting:b,handleSubmit:I,connectionOption:Z}},S=function(e){var n=e.data,i=e.onConnectionCreated,r=e.onTestConnectionClick,a=_({onConnectionCreated:i,data:n}),o=a.isSubmitting,c=a.handleSubmit,l=a.connectionOption;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.xuv,{color:"gray.700",fontSize:"14px",h:"80px",children:["Connect to your ",l.human_readable," environment by providing the information below. Once you have saved the form, you may test the integration to confirm that it's working correctly."]}),(0,t.jsx)(C,{data:n,defaultValues:{description:"",instance_key:"",name:""},isSubmitting:o,onSaveClick:c,onTestConnectionClick:r})]})},Z={description:"",instance_key:"",name:""},w=function(e){var n=e.data,i=e.onConnectionCreated,r=e.onTestEmail,a=_({onConnectionCreated:i,data:n}),o=a.connectionOption,c=a.isSubmitting,l=a.handleSubmit;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.xuv,{color:"gray.700",fontSize:"14px",h:"80px",children:["Configure your ",o.human_readable," connector by providing the connector name, description and a test email address. Once you have saved the details, you can click test email to check the format of the email."]}),(0,t.jsx)(C,{data:n,defaultValues:Z,isSubmitting:c,onSaveClick:function(e){l(e)},onTestConnectionClick:r,testButtonLabel:"Test email"})]})},z=i(16310),I=i(79317),R=i(6005),T=function(e){var n=e.defaultValues,i=e.isSubmitting,o=void 0!==i&&i,d=e.onSaveClick,u=(0,a.useRouter)(),h=(0,c.C)(r.ZZ),f=h.connection,p=h.connectionOption;return(0,t.jsx)(y.J9,{initialValues:function(){var e;(null===f||void 0===f?void 0:f.key)&&(n.name=null!==(e=f.name)&&void 0!==e?e:"",n.description=f.description);return n}(),onSubmit:function(e,n){d(e,n)},validateOnBlur:!1,validateOnChange:!1,validationSchema:z.Ry().shape({name:z.Z_().required("Name is required")}),children:(0,t.jsx)(y.l0,{noValidate:!0,children:(0,t.jsxs)(s.gCW,{align:"stretch",gap:"16px",children:[(0,t.jsx)(I.Z,{autoFocus:!0,disabled:!!(null===f||void 0===f?void 0:f.key),isRequired:!0,label:"Name",name:"name",placeholder:"Enter a friendly name for your new ".concat(p.human_readable," connection")}),(0,t.jsx)(I.Z,{label:"Description",name:"description",placeholder:"Enter a description for your new ".concat(p.human_readable," connection"),type:"textarea"}),(0,t.jsx)(R.h,{isSubmitting:o,onCancelClick:function(){u.push(l.JR)}})]})})})},E=function(e){var n=e.onConnectionCreated,i=(0,v.I0)(),a=(0,x.V)(),l=a.errorAlert,g=a.successAlert,j=(0,p.HK)().handleError,y=(0,o.useState)(!1),b=y[0],C=y[1],k=(0,c.C)(r.ZZ),_=k.connection,S=k.connectionOption,Z=(0,h.Z)((0,m.pH)(),1)[0],w=function(){var e=(0,u.Z)((function(e,t){var s,a,o,c;return(0,f.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),C(!0),a={access:d.uv.WRITE,connection_type:null===S||void 0===S?void 0:S.identifier,description:e.description,disabled:!1,name:e.name,key:null===_||void 0===_?void 0:_.key},[4,Z(a).unwrap()];case 1:return o=t.sent(),(null===(s=o.failed)||void 0===s?void 0:s.length)>0?l(o.failed[0].message):(i((0,r.lm)(o.succeeded[0])),g("Connector successfully ".concat((null===_||void 0===_?void 0:_.key)?"updated":"added","!")),!(null===_||void 0===_?void 0:_.key)&&n&&n()),[3,4];case 2:return c=t.sent(),j(c),[3,4];case 3:return C(!1),[7];case 4:return[2]}}))}));return function(n,i){return e.apply(this,arguments)}}();return(0,t.jsxs)(s.gCW,{align:"stretch",gap:"16px",children:[(0,t.jsxs)(s.xuv,{color:"gray.700",fontSize:"14px",children:["To begin setting up your new ",S.human_readable," ","connector you must first assign a name to the connector and a description.",(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),"Once you have completed this section you can then progress onto"," ",(0,t.jsx)(s.xvT,{display:"inline-block",fontWeight:"700",children:"DSR customization"})," ","using the menu on the left hand side."]}),(0,t.jsx)(T,{defaultValues:{description:"",name:""},isSubmitting:b,onSaveClick:w})]})},A=function(e){var n=e.data,i=e.onConnectionCreated,a=e.onTestConnectionClick,l=(0,v.I0)(),g=(0,x.V)(),j=g.errorAlert,y=g.successAlert,b=(0,p.HK)().handleError,_=(0,o.useState)(!1),S=_[0],Z=_[1],w=(0,c.C)(r.ZZ),z=w.connection,I=w.connectionOption,R=(0,h.Z)((0,m.pL)(),1)[0],T=(0,h.Z)((0,m.pH)(),1)[0],E=(0,h.Z)((0,m.Du)(),1)[0],A=function(){var e=(0,u.Z)((function(e,s){var a,o,c,u,h,p,x,m;return(0,f.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,8,9,10]),Z(!0),z?(o={access:d.uv.WRITE,connection_type:z.connection_type,description:e.description,disabled:!1,key:z.key,name:e.name},[4,T(o).unwrap()]):[3,5];case 1:return c=s.sent(),(null===(a=c.failed)||void 0===a?void 0:a.length)>0?(j(c.failed[0].message),[3,4]):[3,2];case 2:return l((0,r.lm)(c.succeeded[0])),u={connection_key:z.key,secrets:{}},Object.entries(n.properties).forEach((function(n){u.secrets[n[0]]=e[n[0]]})),[4,E(u).unwrap()];case 3:"failed"===(h=s.sent()).test_status?j((0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("b",{children:"Message:"})," ",h.msg,(0,t.jsx)("br",{}),(0,t.jsx)("b",{children:"Failure Reason:"})," ",h.failure_reason]})):y("Connector successfully updated!"),s.label=4;case 4:return[3,7];case 5:return p={description:e.description,name:e.name,instance_key:(0,k.E)(e.instance_key),saas_connector_type:I.identifier,secrets:{}},Object.entries(n.properties).forEach((function(n){p.secrets[n[0]]=e[n[0]]})),[4,R(p).unwrap()];case 6:x=s.sent(),l((0,r.lm)(x.connection)),y("Connector successfully added!"),null===i||void 0===i||i(),s.label=7;case 7:return[3,10];case 8:return m=s.sent(),b(m),[3,10];case 9:return Z(!1),[7];case 10:return[2]}}))}));return function(n,i){return e.apply(this,arguments)}}();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.xuv,{color:"gray.700",fontSize:"14px",h:"80px",children:["Connect to your ",I.human_readable," environment by providing the information below. Once you have saved the form, you may test the integration to confirm that it's working correctly."]}),(0,t.jsx)(C,{data:n,defaultValues:{description:"",instance_key:"",name:""},isSubmitting:S,onSaveClick:A,onTestConnectionClick:a})]})},O=i(98878),F=function(e){var n,i,a=e.response,o=(0,c.C)(r.ZZ).connectionOption;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.izJ,{color:"gray.100"}),(0,t.jsxs)(s.gCW,{align:"flex-start",mt:"16px",children:["succeeded"===(null===(n=a.data)||void 0===n?void 0:n.test_status)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.Ugi,{children:[(0,t.jsxs)(s.X6q,{as:"h5",color:"gray.700",size:"xs",children:["Successfully connected to ",o.human_readable]}),(0,t.jsx)(s.Vp9,{colorScheme:"green",size:"sm",variant:"solid",children:"Success"})]}),(0,t.jsx)(s.xvT,{color:"gray.500",fontSize:"sm",mt:"12px !important",children:(0,O.p6)(a.fulfilledTimeStamp)}),(0,t.jsx)(s.xuv,{bg:"green.100",border:"1px solid",borderColor:"green.300",color:"green.700",mt:"16px",borderRadius:"6px",children:(0,t.jsxs)(s.Ugi,{alignItems:"flex-start",margin:["14px","17px","14px","17px"],children:[(0,t.jsx)(s.StI,{}),(0,t.jsxs)(s.xuv,{children:[(0,t.jsx)(s.X6q,{as:"h5",color:"green.500",fontWeight:"semibold",size:"xs",children:"Success message:"}),(0,t.jsx)(s.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:a.data.msg})]})]})})]}),"failed"===(null===(i=a.data)||void 0===i?void 0:i.test_status)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.Ugi,{children:[(0,t.jsxs)(s.X6q,{as:"h5",color:"gray.700",size:"xs",children:["Output error to ",o.human_readable]}),(0,t.jsx)(s.Vp9,{colorScheme:"red",size:"sm",variant:"solid",children:"Error"})]}),(0,t.jsx)(s.xvT,{color:"gray.500",fontSize:"sm",mt:"12px !important",children:(0,O.p6)(a.fulfilledTimeStamp)}),(0,t.jsx)(s.xuv,{bg:"red.50",border:"1px solid",borderColor:"red.300",color:"red.300",mt:"16px",borderRadius:"6px",children:(0,t.jsxs)(s.Ugi,{alignItems:"flex-start",margin:["14px","17px","14px","17px"],children:[(0,t.jsx)(s.f9v,{}),(0,t.jsxs)(s.xuv,{children:[(0,t.jsx)(s.X6q,{as:"h5",color:"red.500",fontWeight:"semibold",size:"xs",children:"Error message:"}),(0,t.jsx)(s.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:a.data.failure_reason}),(0,t.jsx)(s.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:a.data.msg})]})]})})]})]})]})},L=function(e){var n=e.onConnectionCreated,i=(0,a.useRouter)(),u=(0,c.C)(r.ZZ).connectionOption,h=u&&u.type===d.Zi.MANUAL,f=(0,r.n3)(u.identifier,{skip:h}),p=f.data,x=f.isFetching,m=f.isLoading,v=f.isSuccess,g=(0,o.useState)(),j=g[0],y=g[1],b=function(e){y(e)},C=(0,o.useCallback)((function(){i.push(l.JR)}),[i]),k=(0,o.useCallback)((function(){switch(null===u||void 0===u?void 0:u.type){case d.Zi.DATABASE:if(v&&p)return(0,t.jsx)(S,{data:p,onConnectionCreated:n,onTestConnectionClick:b});break;case d.Zi.MANUAL:return(0,t.jsx)(E,{onConnectionCreated:n});case d.Zi.SAAS:if(v&&p)return(0,t.jsx)(A,{data:p,onConnectionCreated:n,onTestConnectionClick:b});break;case d.Zi.EMAIL:if(v&&p)return(0,t.jsx)(w,{data:p,onConnectionCreated:C,onTestEmail:b})}}),[null===u||void 0===u?void 0:u.type,p,v,n,C]);return(0,t.jsxs)(s.kCb,{gap:"97px",children:[(0,t.jsxs)(s.gCW,{w:"579px",gap:"16px",align:"stretch",children:[(x||m)&&(0,t.jsx)(s.M5Y,{children:(0,t.jsx)(s.$jN,{})}),k()]}),j&&(0,t.jsxs)(s.Rg9,{in:!0,children:[" ",(0,t.jsx)(s.xuv,{mt:"16px",maxW:"528px",w:"fit-content",children:(0,t.jsx)(F,{response:j})})]})]})}},3550:function(e,n,i){i.d(n,{Z:function(){return Z}});var t=i(23842),r=i(85034),s=i(70169),a=i(31373),o=i(52050),c=i(85556),l=i(24246),d=i(23027),u=i(53178),h=i(1977),f=i(83265),p=i(86677),x=i(27378),m=i(10503),v=i(32556),g=i(93677),j=i(41799),y=i(95389),b=i(66527),C=i(87798),k=i(11384),_=function(e){var n=e.data,i=void 0===n?[]:n,t=e.isSubmitting,r=void 0!==t&&t,s=e.onSubmit,a=e.onCancel,o=e.disabled,c=(0,x.useRef)(null),d=(0,y.V)().errorAlert,u=i.length>0?b.ZP.dump(i):void 0,h=(0,x.useState)(void 0),p=h[0],m=h[1],v=(0,x.useState)(!1),g=v[0],_=v[1],S=(0,x.useState)(!u),Z=S[0],w=S[1],z=(0,f.qY0)(),I=(0,j.NR)().data,R=(0,x.useState)([]),T=R[0],E=R[1],A=function(){var e=c.current.getValue(),n=b.ZP.load(e,{json:!0});s(n),E([])};return(0,l.jsxs)(f.kCb,{gap:"97px",children:[(0,l.jsxs)(f.gCW,{align:"stretch",w:"800px",children:[(0,l.jsx)(C.M,{defaultLanguage:"yaml",defaultValue:u,height:"calc(100vh - 526px)",onChange:function(e){try{_(!0),function(e){b.ZP.load(e,{json:!0}),m(void 0)}(e),w(!(e&&""!==e.trim()))}catch(n){(0,C.F)(n)?m(n):d("Could not parse the supplied YAML")}},onMount:function(e,n){c.current=e,c.current.focus()},options:{fontFamily:"Menlo",fontSize:13,minimap:{enabled:!0},readOnly:o},theme:"light"}),(0,l.jsxs)(f.hE2,{size:"sm",children:[a?(0,l.jsx)(f.zxk,{onClick:a,children:"Cancel"}):null,(0,l.jsx)(f.zxk,{colorScheme:"primary",isDisabled:o||Z||!!p||r,isLoading:r,loadingText:"Saving",onClick:function(){if(I&&I.length){var e=c.current.getValue(),n=I.filter((function(n){return e.includes("fides_key: ".concat(n.fides_key,"\n"))})).map((function(e){return e.fides_key}));if(E(n),n.length)return void z.onOpen()}A()},type:"submit","data-testid":"save-yaml-btn",width:"fit-content",children:"Save"})]})]}),g&&(Z||p)&&(0,l.jsx)(k.Z,{isEmptyState:Z,yamlError:p}),(0,l.jsx)(f.cVQ,{isOpen:z.isOpen,onClose:z.onClose,onConfirm:function(){A(),z.onClose()},title:"Overwrite dataset",message:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(f.xvT,{children:["You are about to overwrite the dataset",T.length>1?"s":""," ",T.map((function(e,n){var i=n===T.length-1;return(0,l.jsxs)(x.Fragment,{children:[(0,l.jsx)(f.xvT,{color:"complimentary.500",as:"span",fontWeight:"bold",children:e}),i?".":", "]},e)}))]}),(0,l.jsx)(f.xvT,{children:"Are you sure you would like to continue?"})]})})]})},S=function(e){var n=e.children,i=(0,a.Z)(e,["children"]);return(0,l.jsx)(f.xvT,(0,s.Z)((0,r.Z)({color:"gray.700",fontSize:"14px"},i),{children:n}))},Z=function(){var e=(0,p.useRouter)(),n=(0,d.VY)(),i=n.errorAlert,r=n.successAlert,s=(0,d.HK)().handleError,a=(0,x.useState)(!1),y=a[0],b=a[1],C=(0,m.C)(u.ZZ).connection,k=(0,h.Eg)(C.key),Z=k.data,w=k.isFetching,z=k.isLoading,I=k.isSuccess,R=(0,o.Z)((0,h.Lz)(),1)[0],T=(0,o.Z)((0,j.EG)(),1)[0],E=(0,j.NR)(),A=E.data,O=E.isLoading,F=E.error,L=(0,x.useState)(void 0),W=L[0],q=L[1];(0,x.useEffect)((function(){Z&&Z.items.length&&q(Z.items[0].ctl_dataset.fides_key)}),[Z]);var P=function(){e.push(g.JR)},V=function(){var n=(0,t.Z)((function(n){var t,s,a;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return s={connection_key:null===C||void 0===C?void 0:C.key,dataset_pairs:n},[4,R(s).unwrap()];case 1:return a=o.sent(),(null===(t=a.failed)||void 0===t?void 0:t.length)>0?i(a.failed[0].message):r("Dataset successfully updated!"),e.push(g.JR),[2]}}))}));return function(e){return n.apply(this,arguments)}}(),D=function(){var e=(0,t.Z)((function(){var e;return(0,c.__generator)(this,(function(n){if(W)try{e=W,Z&&Z.items.length&&(e=Z.items[0].fides_key),V([{fides_key:e,ctl_dataset_fides_key:W}])}catch(i){s(i)}return[2]}))}));return function(){return e.apply(this,arguments)}}(),N=function(){var e=(0,t.Z)((function(e){var n,t,r,a,o,l,d;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,3,4]),b(!0),n=Array.isArray(e)?e:[e],[4,T(n)];case 1:return"error"in(t=c.sent())?(r=(0,v.e$)(t.error),i(r),[2]):(o=(a=n).map((function(e){return{fides_key:e.fides_key,ctl_dataset_fides_key:e.fides_key}})),Z&&Z.items.length&&(l=Z.items,o=l.map((function(e,n){return{fides_key:e.fides_key,ctl_dataset_fides_key:a[n].fides_key}}))),V(o),[3,4]);case 2:return d=c.sent(),s(d),[3,4];case 3:return b(!1),[7];case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),M=""!==W&&void 0!==W;if(w||z||O&&!F)return(0,l.jsx)(f.M5Y,{children:(0,l.jsx)(f.$jN,{})});var H=A&&A.length;return(0,l.jsxs)(f.gCW,{alignItems:"left",children:[F?(0,l.jsx)(S,{mb:4,color:"red",children:"There was a problem loading existing datasets, please try again."}):null,(0,l.jsxs)(f.Ugi,{spacing:8,mb:4,children:[H?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(f.gCW,{alignSelf:"start",mr:4,children:[(0,l.jsxs)(f.xuv,{"data-testid":"dataset-selector-section",mb:4,children:[(0,l.jsx)(S,{mb:4,children:"Choose a dataset to associate with this connector."}),(0,l.jsx)(f.PhF,{size:"sm",width:"fit-content",placeholder:"Select",onChange:function(e){q(e.target.value)},value:W,"data-testid":"dataset-selector",children:A.map((function(e){return(0,l.jsx)("option",{value:e.fides_key,children:e.fides_key},e.fides_key)}))})]}),(0,l.jsx)(f.zxk,{size:"sm",colorScheme:"primary",alignSelf:"start",isDisabled:!M,onClick:D,"data-testid":"save-dataset-link-btn",children:"Save"})]}),(0,l.jsx)(S,{children:"or"})]}):null,(0,l.jsxs)(f.xuv,{"data-testid":"yaml-editor-section",children:[(0,l.jsx)(S,{mb:4,children:"View your dataset YAML below!"}),I&&(null===Z||void 0===Z?void 0:Z.items)?(0,l.jsx)(_,{data:Z.items.map((function(e){return e.ctl_dataset})),isSubmitting:y,onSubmit:N,disabled:M,onCancel:H?void 0:P}):null]})]}),H?(0,l.jsx)(f.zxk,{width:"fit-content",size:"sm",variant:"outline",onClick:P,children:"Cancel"}):null]})}},81881:function(e,n,i){i.d(n,{E:function(){return t},S:function(){return r}});var t=function(e){return e.toLowerCase().replace(/ /g,"_")},r=function(e,n){var i="".concat(window.location.origin+n,"&key=").concat(e);window.location.href.toLowerCase()!==i.toLowerCase()&&window.history.replaceState(null,"",i)}},6005:function(e,n,i){i.d(n,{h:function(){return s}});var t=i(24246),r=i(83265),s=(i(27378),function(e){var n=e.isSubmitting,i=void 0!==n&&n,s=e.onCancelClick;return(0,t.jsxs)(r.hE2,{size:"sm",spacing:"8px",variant:"outline",children:[(0,t.jsx)(r.zxk,{onClick:s,variant:"outline",children:"Cancel"}),(0,t.jsx)(r.zxk,{bg:"primary.800",color:"white",isDisabled:i,isLoading:i,loadingText:"Submitting",size:"sm",variant:"solid",type:"submit",_active:{bg:"primary.500"},_disabled:{opacity:"inherit"},_hover:{bg:"primary.400"},children:"Save"})]})})},50367:function(e,n,i){i.d(n,{Z:function(){return _}});var t=i(23842),r=i(85034),s=i(52050),a=i(85556),o=i(24246),c=i(23027),l=i(53178),d=i(1977),u=i(83265),h=i(86677),f=i(27378),p=i(10503),x=i(93677),m=i(34090),v=i(16310),g=i(56071),j=i(57812),y=i(22735),b=i(79317),C=i(6005),k=function(e){var n=e.data,i=void 0===n?[]:n,t=e.isSubmitting,r=void 0!==t&&t,s=e.onSaveClick,a=(0,j.MO)().isLoading,l=(0,p.C)(y.qb),d=(0,h.useRouter)(),f=(0,c.VY)().errorAlert,k=function(){d.push(x.JR)};return a?null:(0,o.jsx)(m.J9,{enableReinitialize:!0,initialValues:{fields:i.length>0?i:[{pii_field:"",dsr_package_label:"",data_categories:[]}]},onSubmit:function(e,n){new Set(e.fields.map((function(e){return e.pii_field}))).size<e.fields.length?f("PII Field must be unique"):s(e,n)},validateOnBlur:!1,validateOnChange:!1,validationSchema:v.Ry({fields:v.IX().of(v.Ry().shape({pii_field:v.Z_().required("PII Field is required").min(1,"PII Field must have at least one character").max(200,"PII Field has a maximum of 200 characters").label("PII Field"),dsr_package_label:v.Z_().required("DSR Package Label is required").min(1,"DSR Package Label must have at least one character").max(200,"DSR Package Label has a maximum of 200 characters").label("DSR Package Label"),data_categories:v.IX(v.Z_()).label("Data Categories")}))}),children:function(e){return(0,o.jsx)(m.l0,{style:{marginTop:0},noValidate:!0,children:(0,o.jsx)(u.gCW,{align:"stretch",children:(0,o.jsx)(m.F2,{name:"fields",render:function(n){var i=e.values.fields;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(u.Ugi,{color:"gray.900",flex:"1",fontSize:"14px",fontWeight:"semibold",lineHeight:"20px",mb:"6px",spacing:"24px",children:[(0,o.jsx)(u.xuv,{w:"416px",children:"PII Field"}),(0,o.jsx)(u.xuv,{w:"416px",children:"DSR Package Label"}),(0,o.jsx)(u.xuv,{w:"416px",children:"Data Categories"}),(0,o.jsx)(u.xuv,{visibility:"hidden",children:(0,o.jsx)(u.lr0,{})})]}),(0,o.jsx)(u.xuv,{children:i&&i.length>0?i.map((function(e,i){return(0,o.jsxs)(u.Ugi,{mt:i>0?"12px":void 0,spacing:"24px",align:"flex-start",children:[(0,o.jsx)(u.xuv,{minH:"57px",w:"416px",children:(0,o.jsx)(b.Z,{autoFocus:0===i,displayHelpIcon:!1,isRequired:!0,name:"fields.".concat(i,".pii_field")})}),(0,o.jsx)(u.xuv,{minH:"57px",w:"416px",children:(0,o.jsx)(b.Z,{displayHelpIcon:!1,isRequired:!0,name:"fields.".concat(i,".dsr_package_label")})}),(0,o.jsx)(u.xuv,{minH:"57px",w:"416px",children:(0,o.jsx)(g.AP,{name:"fields.".concat(i,".data_categories"),options:l.map((function(e){return{value:e.fides_key,label:e.fides_key}})),isRequired:!0,isMulti:!0})}),(0,o.jsx)(u.xuv,{h:"57px",visibility:i>0?"visible":"hidden",children:(0,o.jsx)(u.lr0,{onClick:function(){return n.remove(i)},_hover:{cursor:"pointer"}})})]},i)})):null}),(0,o.jsx)(u.xvT,{color:"complimentary.500",fontWeight:"medium",fontSize:"sm",mb:"24px !important",mt:"24px !important",onClick:function(){n.push({pii_field:"",dsr_package_label:"",data_categories:[]})},_hover:{cursor:"pointer"},children:"Add new PII field"}),(0,o.jsx)(C.h,{isSubmitting:r,onCancelClick:k})]})}})})})}})},_=function(){var e=(0,f.useRef)(!1),n=(0,h.useRouter)(),i=(0,c.VY)().successAlert,m=(0,c.HK)().handleError,v=(0,f.useState)(!1),g=v[0],j=v[1],y=(0,f.useState)([]),b=y[0],C=y[1],_=(0,p.C)(l.ZZ).connection,S=(0,d.QV)(_.key),Z=S.data,w=S.isFetching,z=S.isLoading,I=S.isSuccess,R=(0,s.Z)((0,d.jF)(),1)[0],T=(0,s.Z)((0,d._d)(),1)[0],E=function(){var e=(0,t.Z)((function(e,t){var s,o;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,5,6,7]),j(!0),s={connection_key:null===_||void 0===_?void 0:_.key,body:(0,r.Z)({},e)},b.length>0?[4,T(s).unwrap()]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,R(s).unwrap()];case 3:t.sent(),t.label=4;case 4:return i("DSR customization ".concat(b.length>0?"updated":"added","!")),n.push(x.JR),[3,7];case 5:return o=t.sent(),m(o),[3,7];case 6:return j(!1),[7];case 7:return[2]}}))}));return function(n,i){return e.apply(this,arguments)}}();return(0,f.useEffect)((function(){return e.current=!0,I&&Z&&C(Z.fields),function(){e.current=!1}}),[Z,I]),(0,o.jsxs)(u.gCW,{align:"stretch",gap:"16px",children:[(0,o.jsx)(u.xuv,{color:"gray.700",fontSize:"14px",w:"572px",children:"Customize your PII fields to create a friendly label name for your privacy request packages. This \u201cPackage Label\u201d is the label your user will see in their downloaded package."}),(w||z)&&(0,o.jsx)(u.M5Y,{children:(0,o.jsx)(u.$jN,{})}),e.current&&!z?(0,o.jsx)(k,{data:b,isSubmitting:g,onSaveClick:E}):null]})}}}]);