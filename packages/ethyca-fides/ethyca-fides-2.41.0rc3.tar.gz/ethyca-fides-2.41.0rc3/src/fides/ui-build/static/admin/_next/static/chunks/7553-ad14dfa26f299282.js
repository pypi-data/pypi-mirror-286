"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7553],{76738:function(e,t,n){n.d(t,{Gt:function(){return f},eB:function(){return m},oI:function(){return u}});var s=n(24246),i=n(34090),r=n(27378),a=n(10503),o=n(18345),l=n(49730),c=(0,r.createRef)(),d=(0,r.createRef)(),u=function(){var e=(0,a.T)(),t=(0,a.C)(o.DB),n=(0,r.useCallback)((function(){d.current=void 0,c.current=void 0}),[]),s=(0,r.useCallback)((function(){e((0,o.Mr)()),d.current&&(d.current(!0),n())}),[e,n]),i=(0,r.useCallback)((function(){e((0,o.Mr)()),d.current&&(d.current(!1),n())}),[e,n]);return{attemptAction:(0,r.useCallback)((function(){return t?(e((0,o.h7)()),c.current||(c.current=new Promise((function(e){d.current=e}))),c.current):Promise.resolve(!0)}),[t,e]),onConfirm:s,onClose:i}},f=function(e){var t=e.id,n=e.name,s=(0,i.u6)().dirty,l=(0,a.T)();return(0,r.useEffect)((function(){return l((0,o.Zu)({id:t,name:n})),function(){l((0,o.dz)({id:t}))}}),[l,t,n]),(0,r.useEffect)((function(){l((0,o.$p)({id:t,isDirty:s}))}),[s,l,t]),null},m=function(){var e=u(),t=e.onConfirm,n=e.onClose,i=(0,a.C)(o.uv);return(0,s.jsx)(l.Z,{isOpen:i,onClose:n,onConfirm:t,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},86702:function(e,t,n){n.d(t,{q:function(){return T}});var s=n(24246),i=n(83265),r=n(27378),a=n(23842),o=n(85034),l=n(70169),c=n(52050),d=n(85556),u=n(32556),f=n(76738),m=n(83334),h=n(31716),y=n(34090),x=function(e){var t=e.systems,n=e.dataFlows,r=e.onDataFlowSystemChange,a=(0,y.u6)().setFieldValue,o=n.map((function(e){return e.fides_key}));return(0,s.jsxs)(i.iA_,{size:"sm","data-testid":"assign-systems-delete-table",children:[(0,s.jsx)(i.hrZ,{children:(0,s.jsxs)(i.Tr,{children:[(0,s.jsx)(i.Th,{children:"System"}),(0,s.jsx)(i.Th,{})]})}),(0,s.jsx)(i.p3B,{children:t.filter((function(e){return o.includes(e.fides_key)})).map((function(e){return(0,s.jsxs)(i.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,s.jsx)(i.Td,{children:(0,s.jsx)(i.xvT,{fontSize:"xs",lineHeight:4,fontWeight:"medium",children:e.name})}),(0,s.jsx)(i.Td,{textAlign:"end",children:(0,s.jsx)(i.hU,{background:"gray.50","aria-label":"Unassign data flow from system",icon:(0,s.jsx)(h.l,{}),variant:"outline",size:"sm",onClick:function(){return function(e){var t=n.filter((function(t){return t.fides_key!==e.fides_key}));a("dataFlowSystems",t),r(t)}(e)},"data-testid":"unassign-btn"})})]},e.fides_key)}))})]})},g=n(47346),j=n(3204),C=function(e){var t=e.allSystems,n=e.dataFlowSystems,r=e.onChange,a=e.flowType,o=(0,y.u6)().setFieldValue;return(0,s.jsx)(i.xuv,{overflowY:"auto",maxHeight:"300px",children:(0,s.jsxs)(i.iA_,{size:"sm","data-testid":"assign-systems-table",maxHeight:"50vh",overflowY:"scroll",children:[(0,s.jsx)(i.hrZ,{position:"sticky",top:0,background:"white",zIndex:1,children:(0,s.jsxs)(i.Tr,{children:[(0,s.jsx)(i.Th,{children:"System"}),(0,s.jsxs)(i.Th,{textAlign:"right",children:["Set as ",a]})]})}),(0,s.jsx)(i.p3B,{children:t.map((function(e){var t=!!n.find((function(t){return t.fides_key===e.fides_key}));return(0,s.jsxs)(i.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,s.jsx)(i.Td,{children:(0,s.jsx)(i.xvT,{fontSize:"xs",lineHeight:4,fontWeight:"medium",children:e.name})}),(0,s.jsx)(i.Td,{textAlign:"right",children:(0,s.jsx)(i.rsf,{isChecked:t,onChange:function(){return function(e){if(n.find((function(t){return t.fides_key===e.fides_key}))){var t=n.filter((function(t){return t.fides_key!==e.fides_key}));o("dataFlowSystems",t),r(t)}else{var s=(0,j.Z)(n).concat([{fides_key:e.fides_key,type:"system"}]);o("dataFlowSystems",s),r(s)}}(e)},"data-testid":"assign-switch"})})]},e.fides_key)}))})]})})},p=function(e){var t=e.currentSystem,n=e.systems,o=e.isOpen,l=e.onClose,c=e.dataFlowSystems,u=e.onDataFlowSystemChange,f=e.flowType,m=(0,y.u6)().setFieldValue,h=(0,r.useState)(""),x=h[0],j=h[1],p=(0,r.useState)(c),v=p[0],k=p[1],w=function(){var e=(0,a.Z)((function(){return(0,d.__generator)(this,(function(e){return u(v),l(),[2]}))}));return function(){return e.apply(this,arguments)}}(),S=0===n.length,b=(0,r.useMemo)((function(){return n?n.filter((function(e){return e.fides_key!==t.fides_key})).filter((function(e){return function(e,t){var n,s;return(null===(n=e.name)||void 0===n?void 0:n.toLocaleLowerCase().includes(t.toLocaleLowerCase()))||(null===(s=e.description)||void 0===s?void 0:s.toLocaleLowerCase().includes(t.toLocaleLowerCase()))}(e,x)})):[]}),[n,t.fides_key,x]),_=(0,r.useMemo)((function(){var e=new Set(v.map((function(e){return e.fides_key})));return b.every((function(t){return e.has(t.fides_key)}))}),[b,v]);return(0,s.jsxs)(i.u_l,{isOpen:o,onClose:l,size:"2xl",isCentered:!0,children:[(0,s.jsx)(i.ZAr,{}),(0,s.jsxs)(i.hzk,{p:8,"data-testid":"confirmation-modal",children:[(0,s.jsxs)(i.xBx,{fontWeight:"medium",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,s.jsxs)(i.xvT,{fontSize:"2xl",lineHeight:8,fontWeight:"semibold",children:["Configure ",f.toLocaleLowerCase()," systems"]}),(0,s.jsxs)(i.Cts,{bg:"green.500",color:"white",px:1,children:["Assigned to ",v.length," systems"]})]}),(0,s.jsx)(i.fef,{"data-testid":"assign-systems-modal-body",children:S?(0,s.jsx)(i.xvT,{children:"No systems found"}):(0,s.jsxs)(i.Kqy,{spacing:4,children:[(0,s.jsxs)(i.kCb,{justifyContent:"space-between",children:[(0,s.jsx)(i.xvT,{fontSize:"sm",flexGrow:1,fontWeight:"medium",children:"Add or remove destination systems from your data map"}),(0,s.jsx)(i.xuv,{children:(0,s.jsxs)(i.NIc,{display:"flex",alignItems:"center",children:[(0,s.jsx)(i.lXp,{fontSize:"sm",htmlFor:"assign-all-systems",mb:"0",children:"Assign all systems"}),(0,s.jsx)(i.rsf,{size:"sm",id:"assign-all-systems",isChecked:_,onChange:function(e){if(e.target.checked&&n){var t=b.map((function(e){return{fides_key:e.fides_key,type:"system"}}));m("dataFlowSystems",t),k(t)}else k([])},"data-testid":"assign-all-systems-toggle"})]})})]}),(0,s.jsx)(g.Z,{search:x,onChange:j,placeholder:"Search for systems","data-testid":"system-search",withIcon:!0}),(0,s.jsx)(C,{flowType:f,allSystems:b,dataFlowSystems:v,onChange:k})]})}),(0,s.jsx)(i.mzw,{justifyContent:"flex-start",children:(0,s.jsxs)(i.hE2,{size:"sm",children:[(0,s.jsx)(i.zxk,{variant:"outline",mr:2,onClick:l,"data-testid":"cancel-btn",children:"Cancel"}),S?null:(0,s.jsx)(i.zxk,{colorScheme:"primary",onClick:w,"data-testid":"confirm-btn",children:"Confirm"})]})})]})]})},v=n(61186),k=n(10503),w=n(12062),S=n(44982),b={dataFlowSystems:[]},_=function(e){var t=e.system,n=e.isIngress,h=e.isSystemTab,g=(0,i.pmc)(),j=n?"Source":"Destination",C="".concat(j,"s"),_=(0,i.qY0)(),T=(0,c.Z)((0,w.qQ)(),1)[0];(0,w.K3)();var F=(0,k.C)(S.cS),z=(0,r.useMemo)((function(){var e=n?t.ingress:t.egress;e||(e=[]);var s=F?F.map((function(e){return e.fides_key})):[];return e.filter((function(e){return s.includes(e.fides_key)}))}),[n,t,F]),L=(0,r.useState)(z),D=L[0],Z=L[1];(0,r.useEffect)((function(){Z(z)}),[z]);var A=function(){var e=(0,a.Z)((function(e,s){var i,r,a,c;return(0,d.__generator)(this,(function(d){switch(d.label){case 0:return i=e.dataFlowSystems,r=s.resetForm,a=(0,l.Z)((0,o.Z)({},t),{ingress:n?i:t.ingress,egress:n?t.egress:i}),[4,T(a)];case 1:return c=d.sent(),(0,u.D4)(c)?g((0,v.Vo)("Failed to update data flows")):g((0,v.t5)("".concat(C," updated"))),r({values:{dataFlowSystems:i}}),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}();return(0,s.jsxs)(i.Qdk,{children:[(0,s.jsx)(i.KFZ,{height:"68px",paddingLeft:h?6:2,"data-testid":"data-flow-button-".concat(j),children:(0,s.jsxs)(i.kCb,{alignItems:"center",justifyContent:"start",flex:1,textAlign:"left",children:[(0,s.jsx)(i.xvT,{fontSize:"sm",lineHeight:5,fontWeight:"semibold",mr:2,children:C}),(0,s.jsx)(i.Vp9,{ml:2,backgroundColor:"primary.400",borderRadius:"6px",color:"white",children:D.length}),(0,s.jsx)(i.LZC,{}),(0,s.jsx)(i.XEm,{})]})}),(0,s.jsx)(i.Hk3,{backgroundColor:"gray.50",padding:6,"data-testid":"data-flow-panel-".concat(j),children:(0,s.jsx)(i.Kqy,{borderRadius:"md",backgroundColor:"gray.50","aria-selected":"true",spacing:4,"data-testid":"selected",children:(0,s.jsx)(y.J9,{initialValues:b,onSubmit:A,children:function(e){var n=e.isSubmitting,r=e.dirty,a=e.resetForm;return(0,s.jsxs)(y.l0,{children:[(0,s.jsx)(f.Gt,{id:"".concat(t.fides_key,":").concat(j),name:"".concat(j," Data Flow")}),(0,s.jsx)(i.zxk,{colorScheme:"primary",size:"xs",width:"fit-content",onClick:_.onOpen,"data-testid":"assign-systems-btn",rightIcon:(0,s.jsx)(m.A5,{}),marginBottom:4,children:"Configure ".concat(C.toLocaleLowerCase())}),(0,s.jsx)(x,{systems:F,dataFlows:D,onDataFlowSystemChange:Z}),(0,s.jsxs)(i.hE2,{marginTop:6,children:[(0,s.jsx)(i.zxk,{size:"sm",variant:"outline",isDisabled:!r&&D===z,onClick:function(){Z(z),a({values:{dataFlowSystems:z}})},children:"Cancel"}),(0,s.jsx)(i.zxk,{size:"sm",colorScheme:"primary",type:"submit",isLoading:n,isDisabled:!r&&D===z,"data-testid":"save-btn",children:"Save"})]}),_.isOpen?(0,s.jsx)(p,{currentSystem:t,systems:F,isOpen:_.isOpen,onClose:_.onClose,dataFlowSystems:D,onDataFlowSystemChange:Z,flowType:j}):null]})}})})})]})},T=function(e){var t=e.system,n=e.isSystemTab;return(0,s.jsxs)(i.UQy,{allowToggle:!0,"data-testid":"data-flow-accordion",children:[(0,s.jsx)(_,{system:t,isIngress:!0,isSystemTab:n}),(0,s.jsx)(_,{system:t,isSystemTab:n})]})}},95241:function(e,t,n){n.d(t,{f:function(){return l}});var s=n(10503),i=n(32918),r=n(21788),a=n(41799),o=n(57812),l=function(e){var t=e.includeDatasets,n=e.includeDisabled,l=(0,o.MO)().isLoading,c=(0,i.te)().isLoading,d=(0,r.fd)().isLoading,u=(0,a.LH)({onlyUnlinkedDatasets:!1},{skip:!t}).isLoading,f=(0,s.C)(o.qb),m=(0,s.C)(o.Bd),h=(0,s.C)(i.ZL),y=(0,s.C)(i.H7),x=(0,s.C)(r.U3),g=(0,s.C)(r.jp),j=(0,s.C)(a.Q4);return{allDataCategories:n?f:m,allDataSubjects:n?h:y,allDataUses:n?x:g,allDatasets:t?j:void 0,isLoading:l||c||d||u}}},34038:function(e,t,n){n.d(t,{Bw:function(){return s.Bw},D4:function(){return s.D4}});var s=n(32764)}}]);