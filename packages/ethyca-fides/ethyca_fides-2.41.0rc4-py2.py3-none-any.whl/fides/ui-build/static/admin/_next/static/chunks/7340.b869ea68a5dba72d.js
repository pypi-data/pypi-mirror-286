"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7340],{97340:function(e,n,r){r.r(n),r.d(n,{default:function(){return S}});var i=r(24246),t=r(83265),s=r(10503),o=r(38140),a=r(23842),l=r(85034),u=r(70169),c=r(52050),f=r(85556),d=r(34090),h=r(27378),m=r(16310),x=r(32556),p=r(23027),g=r(31373),v=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,y=(0,t.Gpc)((function(e,n){var r=e.isRequired,s=void 0!==r&&r,o=(0,g.Z)(e,["isRequired"]),a=o.form.values.emails,l=(0,h.useState)(""),u=l[0],c=l[1],f=function(e){e.map((function(e){return e.trim()})).filter((function(e){return function(e){return v.test(e)}(e)&&!function(e){return a.includes(e)}(e)})).forEach((function(e){return o.push(e)})),c("")};return(0,i.jsxs)(t.NIc,{alignItems:"baseline",display:"inline-flex",isInvalid:!!o.form.errors[o.name],isRequired:s,children:[(0,i.jsx)(t.lXp,{fontSize:"md",htmlFor:"email",children:"Email"}),(0,i.jsxs)(t.gCW,{align:"flex-start",w:"inherit",children:[(0,i.jsx)(t.IIB,{autoComplete:"off",placeholder:"Type or paste email addresses separated by commas and press `Enter` or `Tab`...",onChange:function(e){c(e.target.value)},onKeyDown:function(e){["Enter","Tab",","].includes(e.key)&&(e.preventDefault(),f([u]))},onPaste:function(e){e.preventDefault();var n=e.clipboardData.getData("text").split(",");f(n)},ref:n,size:"sm",type:"email",value:u}),(0,i.jsx)(t.J1D,{children:o.form.errors[o.name]}),a.length>0&&(0,i.jsx)(t.Eq9,{spacing:1,mb:3,pt:"8px",children:a.map((function(e,n){return(0,i.jsxs)(t.Vp9,{borderRadius:"full",backgroundColor:"primary.400",color:"white",size:"sm",variant:"solid",children:[(0,i.jsx)(t.Sn0,{children:e}),(0,i.jsx)(t.SD9,{onClick:function(){o.remove(n)}})]},e)}))})]})]})})),j=r(63076),b=m.Ry().shape({emails:m.IX(m.Z_()).when(["notify"],{is:!0,then:function(){return m.IX(m.Z_()).min(1,"Must enter at least one valid email").label("Email")}}),notify:m.O7(),minErrorCount:m.Rx().required()}),C=function(){var e=(0,t.qY0)(),n=e.isOpen,r=e.onOpen,s=e.onClose,o=(0,h.useState)({emails:[],notify:!1,minErrorCount:1}),m=o[0],g=o[1],v=(0,h.useRef)(null),C=(0,p.VY)(),S=C.errorAlert,_=C.successAlert,w=(0,h.useState)(!0),R=w[0],E=w[1],Z=(0,j.tE)(void 0,{skip:R}).data,z=(0,c.Z)((0,j.SC)(),1)[0],k=function(){var e=(0,a.Z)((function(e,n){var r;return(0,f.__generator)(this,(function(i){switch(i.label){case 0:return n.setSubmitting(!0),[4,z({email_addresses:e.emails,notify_after_failures:e.notify?e.minErrorCount:0})];case 1:return"error"in(r=i.sent())?S((0,x.e$)(r.error),"Configure alerts and notifications has failed to save due to the following:"):_("Configure alerts and notifications saved successfully."),n.setSubmitting(!1),s(),[2]}}))}));return function(n,r){return e.apply(this,arguments)}}();return(0,h.useEffect)((function(){n&&E(!1),Z&&g({emails:Z.email_addresses,notify:0!==Z.notify_after_failures,minErrorCount:Z.notify_after_failures})}),[Z,n]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.hU,{onClick:r,variant:"outline",size:"xs",title:"Configure alerts","aria-label":"Configure alerts",icon:(0,i.jsx)(t.Dkj,{})}),(0,i.jsx)(d.J9,{enableReinitialize:!0,initialValues:m,onSubmit:k,validationSchema:b,children:function(e){return(0,i.jsxs)(t.dys,{isOpen:n,placement:"right",initialFocusRef:v,onClose:function(){e.resetForm(),s()},size:"lg",children:[(0,i.jsx)(t.P1B,{}),(0,i.jsxs)(t.scA,{color:"gray.900",children:[(0,i.jsx)(t.cCv,{}),(0,i.jsxs)(t.OXI,{color:"gray.900",children:[(0,i.jsx)(t.xvT,{fontSize:"2xl",fontWeight:"normal",mb:4,children:"Configure alerts and notifications"}),(0,i.jsx)(t.xuv,{mt:"26px",children:(0,i.jsx)(t.xvT,{fontSize:"md",fontWeight:"normal",children:"Setup your alerts to send you a notification when there are any processing failures. You can also setup a threshold for connector failures for Fides to notify you after X amount of failures have occurred."})})]}),(0,i.jsx)(t.Ng0,{mt:"20px",children:(0,i.jsxs)(d.l0,{id:"configure-alerts-form",noValidate:!0,children:[(0,i.jsx)(t.xvT,{fontSize:"md",children:"Contact details"}),(0,i.jsxs)(t.gCW,{align:"stretch",gap:"29px",mt:"14px",children:[(0,i.jsx)(t.Ugi,{children:(0,i.jsx)(d.F2,{name:"emails",render:function(n){return(0,i.jsx)(y,(0,u.Z)((0,l.Z)({},n),{isRequired:e.values.notify,ref:v}))}})}),(0,i.jsx)(t.Ugi,{children:(0,i.jsx)(d.gN,{id:"notify",name:"notify",children:function(n){var r=n.field;return(0,i.jsxs)(t.NIc,{alignItems:"center",display:"flex",mt:"45px",children:[(0,i.jsx)(t.lXp,{fontSize:"md",mb:"0",children:"Notify me immediately if there are any DSR processing errors"}),(0,i.jsx)(t.rsf,(0,u.Z)((0,l.Z)({},r),{colorScheme:"secondary",isChecked:e.values.notify,onChange:function(n){r.onChange(n),e.setFieldValue("minErrorCount",1),n.target.checked||setTimeout((function(){e.setFieldTouched("emails",!1)}),0)}}))]})}})})]}),(0,i.jsx)(t.xvT,{color:"#757575",fontSize:"sm",mt:"11px",children:"If selected, then Fides will notify you by your chosen method of communication every time the system encounters a data subject request processing error. You can turn this off anytime and setup a more suitable notification method below if you wish."}),e.values.notify&&(0,i.jsx)(t.Ugi,{mt:"34px",children:(0,i.jsx)(d.gN,{id:"minErrorCount",name:"minErrorCount",children:function(n){var r=n.field,s=n.meta;return(0,i.jsxs)(t.NIc,{alignItems:"center",display:"flex",isInvalid:!(!s.error||!s.touched),isRequired:!0,children:[(0,i.jsx)(t.xvT,{children:"Notify me after"}),(0,i.jsxs)(t.Y2U,{allowMouseWheel:!0,color:"gray.700",defaultValue:e.values.minErrorCount||1,min:1,ml:"8px",mr:"8px",onChange:function(n,r){e.setFieldValue("minErrorCount",r)},size:"sm",w:"80px",children:[(0,i.jsx)(t.zuI,(0,l.Z)({},r)),(0,i.jsxs)(t.FiK,{children:[(0,i.jsx)(t.WQu,{}),(0,i.jsx)(t.Y_d,{})]})]}),(0,i.jsx)(t.xvT,{children:"DSR processing errors "})]})}})})]})}),(0,i.jsx)(t.zeN,{justifyContent:"flex-start",children:(0,i.jsxs)(t.hE2,{size:"sm",spacing:"8px",variant:"outline",children:[(0,i.jsx)(t.zxk,{onClick:function(){e.resetForm(),s()},variant:"outline",children:"Cancel"}),(0,i.jsx)(t.zxk,{bg:"primary.800",color:"white",form:"configure-alerts-form",isDisabled:e.isSubmitting,isLoading:e.isSubmitting,loadingText:"Submitting",size:"sm",variant:"solid",type:"submit",_active:{bg:"primary.500"},_hover:{bg:"primary.400"},children:"Save"})]})})]})]})}})]})},S=function(){var e=(0,s.C)(j.fe).errorRequests;return(0,i.jsxs)(t.kCb,{gap:4,children:[(null===e||void 0===e?void 0:e.length)>0&&(0,i.jsx)(o.Z,{buttonProps:{size:"xs"}}),(0,i.jsx)(C,{})]})}},38140:function(e,n,r){var i=r(23842),t=r(85034),s=r(70169),o=r(52050),a=r(85556),l=r(24246),u=r(83265),c=r(27378),f=r(10503),d=r(32556),h=r(23027),m=r(63076),x=(0,u.Gpc)((function(e,n){var r=e.buttonProps,x=e.handleBlur,p=e.subjectRequest,g=(0,f.T)(),v=(0,c.useState)(!1),y=v[0],j=v[1],b=(0,h.VY)(),C=b.errorAlert,S=b.successAlert,_=(0,f.C)(m.fe).errorRequests,w=(0,o.Z)((0,m.JD)(),1)[0],R=(0,o.Z)((0,m.Fq)(),1)[0],E=function(){var e=(0,i.Z)((function(){var e;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return j(!0),[4,w(_)];case 1:return"error"in(e=n.sent())?(g((0,m.uT)({checkAll:!1,errorRequests:[]})),C((0,d.e$)(e.error),"DSR batch automation has failed due to the following:",{duration:null})):(e.data.failed.length>0&&C((0,l.jsxs)(u.xuv,{children:["DSR automation has failed for"," ",(0,l.jsx)(u.xvT,{as:"span",fontWeight:"semibold",children:e.data.failed.length})," ","privacy request(s). Please review the event log for further details."]}),void 0,{containerStyle:{maxWidth:"max-content"},duration:null}),e.data.succeeded.length>0&&S("Privacy request(s) are now being reprocessed.")),j(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=(0,i.Z)((function(){var e;return(0,a.__generator)(this,(function(r){switch(r.label){case 0:return p?(j(!0),[4,R(p)]):[2];case 1:return"error"in(e=r.sent())?C((0,d.e$)(e.error),"DSR automation has failed for this privacy request due to the following:",{duration:null}):S("Privacy request is now being reprocessed."),j(!1),x&&x(n),[2]}}))}));return function(){return e.apply(this,arguments)}}();return(0,l.jsx)(u.zxk,(0,s.Z)((0,t.Z)({},r),{isDisabled:y,isLoading:y,loadingText:"Reprocessing",onClick:p?Z:E,ref:n,spinnerPlacement:"end",leftIcon:(0,l.jsx)(u.AyE,{}),variant:"outline",_loading:{opacity:1,div:{opacity:.4}},children:"Reprocess"}))}));n.Z=x}}]);