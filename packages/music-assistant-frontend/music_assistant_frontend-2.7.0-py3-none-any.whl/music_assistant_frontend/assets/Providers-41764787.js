import{d as D,aj as j,r as z,z as F,b as i,a7 as O,a as X,N as G,c as s,g as y,h as C,u as a,F as P,f as d,w as o,Y as _,t as u,$ as l,e as c,G as q,j as b,aB as f,i as v,p as H,k as J}from"./index-8f5a1103.js";import{_ as A,e as K}from"./eventbus-4414c78d.js";import{B as h}from"./Button-ba388d7c.js";import{L as Q}from"./ListItem-8545443d.js";import{C as T}from"./Container-d0f24e78.js";import{V as W}from"./VMenu-460aeee2.js";import{s as Z,V as ee,w as k}from"./VListItem-f276ce89.js";import{V as ne}from"./VCard-f870619c.js";import{V as te}from"./VToolbar-48fe5e59.js";import{V as B}from"./VAlert-5e7d05d1.js";import{_ as ie}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css              */import"./VCardText-b6df0880.js";const S=g=>(H("data-v-ee65d3f4"),g=g(),J(),g),ae=S(()=>v("br",null,null,-1)),oe=S(()=>v("br",null,null,-1)),se={class:"line-clamp-1"},re={class:"line-clamp-1"},de=D({__name:"Providers",setup(g){const M=j(),m=z([]),V=F(()=>Object.values(i.providerManifests).filter(n=>!n.hidden&&(n.multi_instance||!m.value.find(t=>t.domain==n.domain))).sort((n,t)=>(n.name||i.providerManifests[n.domain].name).toUpperCase()>(t.name||i.providerManifests[t.domain].name).toUpperCase()?1:-1)),$=i.subscribe(O.PROVIDERS_UPDATED,()=>{w()});X($);const w=async function(){m.value=await i.getProviderConfigs()},N=function(n){i.removeProviderConfig(n),m.value=m.value.filter(t=>t.instance_id!=n)},I=function(n){M.push(`/settings/editprovider/${n}`)},E=function(n){if(n.depends_on&&!i.getProvider(n.depends_on)){const t=i.getProviderName(n.depends_on);confirm(l("settings.provider_depends_on_confirm",[n.name,t]))&&M.push(`/settings/addprovider/${n.depends_on}`);return}M.push(`/settings/addprovider/${n.domain}`)},L=function(n){n.enabled=!n.enabled,i.saveProviderConfig(n.domain,{enabled:n.enabled},n.instance_id)},U=function(n){i.sendCommand("config/providers/reload",{instance_id:n}).catch(t=>alert(t))},x=function(n){window.open(n,"_blank")},R=function(n,t){var e;const r=[{label:"settings.configure",labelArgs:[],action:()=>{I(t.instance_id)},icon:"mdi-cog"},{label:t.enabled?"settings.disable":"settings.enable",labelArgs:[],action:()=>{L(t)},icon:"mdi-cancel",disabled:i.providerManifests[t.domain].builtin},{label:"settings.documentation",labelArgs:[],action:()=>{x(i.providerManifests[t.domain].documentation)},icon:"mdi-bookshelf",disabled:!i.providerManifests[t.domain].documentation},{label:"settings.sync",labelArgs:[],action:()=>{i.startSync(void 0,[t.instance_id])},icon:"mdi-sync",hide:!((e=i.providers[t.instance_id])!=null&&e.available)||t.type!=f.MUSIC},{label:"settings.delete",labelArgs:[],action:()=>{N(t.instance_id)},icon:"mdi-delete",hide:i.providerManifests[t.domain].builtin||i.providerManifests[t.domain].load_by_default&&t.domain==t.instance_id},{label:"settings.reload",labelArgs:[],action:()=>{U(t.instance_id)},icon:"mdi-refresh"}];K.emit("contextmenu",{items:r,posX:n.clientX,posY:n.clientY})};return G(()=>i.providers,n=>{n&&w()},{immediate:!0}),(n,t)=>(s(!0),y(P,null,C(a(f),r=>(s(),y("div",{key:r,style:{"margin-bottom":"10px"}},[d(te,{color:"transparent",density:"compact",class:"titlebar"},{title:o(()=>[_(u(a(l)(`settings.${r}providers`)),1)]),append:o(()=>[V.value.filter(e=>e.type==r).length?(s(),c(W,{key:0,scrim:""},{activator:o(({props:e})=>[d(Z,q({ref_for:!0},e,{color:"accent",variant:"outlined"}),{default:o(()=>[_(u(a(l)("settings.add_new_provider_button",[r])),1)]),_:2},1040)]),default:o(()=>[d(ne,{density:"compact"},{default:o(()=>[(s(!0),y(P,null,C(V.value.filter(e=>e.type==r),e=>(s(),c(ee,{key:e.domain,style:{"padding-top":"0","padding-bottom":"0","margin-bottom":"0"},title:e.name,onClick:p=>E(e)},{prepend:o(()=>[d(A,{domain:e.domain,size:26,class:"media-thumb",style:{"margin-left":"10px"}},null,8,["domain"])]),_:2},1032,["title","onClick"]))),128))]),_:2},1024)]),_:2},1024)):b("",!0)]),_:2},1024),r==a(f).MUSIC&&m.value.filter(e=>e.type==a(f).MUSIC&&e.domain in a(i).providerManifests&&!a(i).providerManifests[e.domain].hidden&&e.domain!=="builtin").length==0?(s(),c(B,{key:0,border:"top","border-color":"warning",style:{margin:"20px"},icon:"mdi-alert-box-outline"},{default:o(()=>[v("b",null,u(a(l)("settings.no_music_providers_detail")),1),ae,_(" "+u(a(l)("settings.no_music_providers_detail")),1)]),_:1})):b("",!0),r==a(f).PLAYER&&m.value.filter(e=>e.type==a(f).PLAYER&&e.domain in a(i).providerManifests&&!a(i).providerManifests[e.domain].hidden).length==0?(s(),c(B,{key:1,border:"top","border-color":"warning",style:{margin:"20px"},icon:"mdi-alert-box-outline"},{default:o(()=>[v("b",null,u(a(l)("settings.no_player_providers_detail")),1),oe,_(" "+u(a(l)("settings.no_player_providers_detail")),1)]),_:1})):b("",!0),d(T,null,{default:o(()=>[(s(!0),y(P,null,C(m.value.filter(e=>e.type==r),e=>(s(),c(Q,{key:e.instance_id,"show-menu-btn":"",link:"",onMenu:p=>R(p,e),onClick:p=>I(e.instance_id)},{prepend:o(()=>[d(A,{domain:e.domain,size:40,class:"listitem-media-thumb"},null,8,["domain"])]),title:o(()=>[v("div",se,u(e.name||a(i).providerManifests[e.domain].name),1)]),subtitle:o(()=>[v("div",re,u(a(i).providerManifests[e.domain].description),1)]),append:o(()=>{var p;return[a(i).syncTasks.value.filter(Y=>Y.provider_instance==e.instance_id).length>0?(s(),c(h,{key:0,icon:"",title:a(l)("settings.sync_running")},{default:o(()=>[d(k,{color:"grey"},{default:o(()=>[_(" mdi-sync ")]),_:1})]),_:1},8,["title"])):b("",!0),e.enabled?e.last_error?(s(),c(h,{key:2,icon:"",title:e.last_error},{default:o(()=>[d(k,{color:"red"},{default:o(()=>[_(" mdi-alert-circle ")]),_:1})]),_:2},1032,["title"])):(p=a(i).providers[e.instance_id])!=null&&p.available?b("",!0):(s(),c(h,{key:3,icon:"",title:a(l)("settings.not_loaded")},{default:o(()=>[d(k,{icon:"mdi-timer-sand"})]),_:1},8,["title"])):(s(),c(h,{key:1,icon:"",title:a(l)("settings.provider_disabled")},{default:o(()=>[d(k,{color:"grey"},{default:o(()=>[_(" mdi-cancel ")]),_:1})]),_:1},8,["title"]))]}),_:2},1032,["onMenu","onClick"]))),128))]),_:2},1024)]))),128))}});const Me=ie(de,[["__scopeId","data-v-ee65d3f4"]]);export{Me as default};
